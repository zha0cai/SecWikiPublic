"use strict";(self.webpackChunkone_piece=self.webpackChunkone_piece||[]).push([[180],{7708:(n,s)=>{s.A=(n,s)=>{const a=n.__vccOpts||n;for(const[n,e]of s)a[n]=e;return a}},7016:(n,s,a)=>{a.r(s),a.d(s,{comp:()=>wn,data:()=>xn});var e=a(4754);const p=a.p+"assets/img/image-20240402102915-scn3nff.a7613ab8.png",o=a.p+"assets/img/image-20240402103051-i21rkvw.90abb361.png",t=a.p+"assets/img/image-20240402155801-ufj5dng.ba6d1340.png",r=a.p+"assets/img/image-20240402160410-mrzzidq.ae49d129.png",l=a.p+"assets/img/image-20240402104232-8knd7k7.9717b234.png",c=a.p+"assets/img/image-20240402162813-6otupm0.e26b518f.png",i=a.p+"assets/img/image-20240402161944-84h4nqv.e222a6c6.png",k=a.p+"assets/img/image-20240402140635-kzg2857.886f2db6.png",u=(0,e.Lk)("h1",{id:"nodejs",tabindex:"-1"},[(0,e.Lk)("a",{class:"header-anchor",href:"#nodejs"},[(0,e.Lk)("span",null,"Nodejs")])],-1),d=(0,e.Lk)("p",null,[(0,e.Lk)("strong",null,"Run JavaScript Everywhere")],-1),m={href:"https://nodejs.org/en",target:"_blank",rel:"noopener noreferrer"},b={href:"https://github.com/ry",target:"_blank",rel:"noopener noreferrer"},v=(0,e.Lk)("p",null,"以前 JS 只能运行在浏览器中，Node.js 出现之后，不管是服务器上，还是我们自己的的笔记本上，只要安装了 Node.js 就可以运行 JS 代码了。",-1),g={href:"https://nodejs.org/docs/latest/api/synopsis.html",target:"_blank",rel:"noopener noreferrer"},h=(0,e.Fv)('<p>​<code>node [options] [V8 options] [script.js | -e &quot;script&quot; | - ] [arguments]</code>​</p><p>常用命令：</p><ul><li>​<code>node &lt;filename&gt;</code>​：运行指定的 JavaScript 文件。</li><li>node：启动 Node.js REPL（交互式解释器）。</li><li>​<code>node --inspect &lt;filename&gt;</code>​：以调试模式运行指定的 JavaScript 文件。</li><li>​<code>node --version</code>​：查看已安装的 Node.js 版本。</li><li>​<code>node --help</code>​：获取 Node.js 命令行帮助信息。</li></ul><h1 id="nvm" tabindex="-1"><a class="header-anchor" href="#nvm"><span>nvm</span></a></h1><p>nvm，全称是 <strong><mark>Node Version Manager</mark></strong>，是用来管理 node.js 的版本的。</p><p>因为 Node.js 在不断的被完善，分版本迭代更新。</p>',6),f={href:"https://nodejs.org/en/download/",target:"_blank",rel:"noopener noreferrer"},j={href:"https://nodejs.org/en/about/previous-releases",target:"_blank",rel:"noopener noreferrer"},y=(0,e.Lk)("p",null,"不同的 node 项目所依赖的 node 版本可能不相同，本机也支持安装多个 node 版本，所以可以通过 nvm 来管理 node 的版本。",-1),L={href:"https://github.com/nvm-sh/nvm",target:"_blank",rel:"noopener noreferrer"},W={href:"https://github.com/coreybutler/nvm-windows",target:"_blank",rel:"noopener noreferrer"},w={href:"https://github.com/coreybutler/nvm-windows#:~:text=Upgrading%20nvm%2Dwindows",target:"_blank",rel:"noopener noreferrer"},x=(0,e.Fv)('<p>常用命令：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token operator">&gt;</span> nvm <span class="token operator">--</span>help <span class="token comment">// 帮助指令</span>\n\n<span class="token operator">&gt;</span> nvm list <span class="token punctuation">[</span>available<span class="token punctuation">]</span>   <span class="token comment">// List the node.js installations. Type &quot;available&quot; at the end to see what can be installe</span>\n\n<span class="token operator">&gt;</span> nvm install <span class="token operator">&lt;</span>version<span class="token operator">&gt;</span> <span class="token punctuation">[</span>arch<span class="token punctuation">]</span> <span class="token comment">// The version can be a specific version, &quot;latest&quot; for the latest current version, or &quot;lts&quot; for the</span>\n\n<span class="token operator">&gt;</span> nvm current    <span class="token comment">// Display active node.js version.</span>\n\n<span class="token operator">&gt;</span> nvm use <span class="token punctuation">[</span>version<span class="token punctuation">]</span> <span class="token punctuation">[</span>arch<span class="token punctuation">]</span>    <span class="token comment">// Switch to use the specified version. Optionally use &quot;latest&quot;, &quot;lts&quot;, or &quot;newest&quot;.</span>\n                              <span class="token comment">// &quot;newest&quot; is the latest installed version. Optionally specify 32/64bit architecture.</span>\n                              <span class="token comment">// nvm use &lt;arch&gt; will continue using the selected version, but switch to 32/64 bit mode.</span>\n\n<span class="token operator">&gt;</span> nvm <span class="token punctuation">[</span><span class="token operator">--</span><span class="token punctuation">]</span>version    <span class="token comment">// Displays the current running version of nvm for Windows. Aliased as v.</span>\n\n<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">==</span> e<span class="token punctuation">.</span>g<span class="token punctuation">.</span>\n<span class="token operator">&gt;</span> nvm list available\n\n<span class="token operator">|</span>   <span class="token constant">CURRENT</span>    <span class="token operator">|</span>     <span class="token constant">LTS</span>      <span class="token operator">|</span>  <span class="token constant">OLD</span> <span class="token constant">STABLE</span>  <span class="token operator">|</span> <span class="token constant">OLD</span> <span class="token constant">UNSTABLE</span> <span class="token operator">|</span>\n<span class="token operator">|</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">|</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">|</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">|</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">|</span>\n<span class="token operator">|</span>    <span class="token number">21.7</span><span class="token number">.1</span>    <span class="token operator">|</span>   <span class="token number">20.12</span><span class="token number">.0</span>    <span class="token operator">|</span>   <span class="token number">0.12</span><span class="token number">.18</span>    <span class="token operator">|</span>   <span class="token number">0.11</span><span class="token number">.16</span>    <span class="token operator">|</span>\n<span class="token operator">|</span>    <span class="token number">21.7</span><span class="token number">.0</span>    <span class="token operator">|</span>   <span class="token number">20.11</span><span class="token number">.1</span>    <span class="token operator">|</span>   <span class="token number">0.12</span><span class="token number">.17</span>    <span class="token operator">|</span>   <span class="token number">0.11</span><span class="token number">.15</span>    <span class="token operator">|</span>\n<span class="token operator">|</span>    <span class="token number">21.6</span><span class="token number">.2</span>    <span class="token operator">|</span>   <span class="token number">20.11</span><span class="token number">.0</span>    <span class="token operator">|</span>   <span class="token number">0.12</span><span class="token number">.16</span>    <span class="token operator">|</span>   <span class="token number">0.11</span><span class="token number">.14</span>    <span class="token operator">|</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装的 nodejs 会在你选择的目录下，我安装的如下图。</p><p>​<img src="'+p+'" alt="image" loading="lazy">​</p><h1 id="package-manager" tabindex="-1"><a class="header-anchor" href="#package-manager"><span>Package Manager</span></a></h1><h2 id="npm" tabindex="-1"><a class="header-anchor" href="#npm"><span>npm</span></a></h2><h3 id="概述" tabindex="-1"><a class="header-anchor" href="#概述"><span>概述</span></a></h3><p>在没有 npm 之前，一个前端项目想要使用其他项目的代码，即把别人写的 javascript 代码引入到项目中直接用，避免重复造轮子，提高开发效率，需要跑到其他项目对应的官网上去下载对应的代码放到自己的项目里，导致如果该项目需要依赖其他很多的项目，然后就要访问不同的网址去下载对应的代码</p><ul><li>去 jQuery 官网下载 jQuery</li><li>去 BootStrap 官网下载 BootStrap</li><li>去 Underscore 官网下载 Underscore</li><li>……</li></ul>',9),F={href:"https://github.com/isaacs",target:"_blank",rel:"noopener noreferrer"},E=(0,e.Lk)("mark",null,[(0,e.Lk)("strong",null,"Node Package Manager")],-1),_={href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"},N={href:"https://docs.npmjs.com/",target:"_blank",rel:"noopener noreferrer"},S=(0,e.Fv)('<h3 id="安装及使用" tabindex="-1"><a class="header-anchor" href="#安装及使用"><span>安装及使用</span></a></h3><p>Node.js 内置了 npm，直接用就行。</p><p>​<img src="'+o+'" alt="image" loading="lazy">​</p><p>‍</p><p><strong>常用指令</strong></p><ul><li><p>​<code>npm init -y</code>​​：初始化一个新的 Node.js 项目，根据 guide 生成一个 packagejson 的文件，项目的配置信息。（<code>-y</code>​​ 或者 <code>--yes</code>​​: 这个选项表示在初始化项目时，自动使用默认选项，而不需要用户交互确认。）</p></li><li><p>查看当前 npm 版本： <code>npm -v</code>​​​</p></li><li><p>安装需要的包</p><p>​<code>npm install 包名 --save</code>​​</p><p>​<code>npm install 包名 -g</code>​​​​ : 全局安装，安装后在命令行任意目录下可直接使用包命令</p><p>​<code>--save</code>​ 会在 <code>package.json</code>​ 中保存到 <code>dependencies</code>​ 这个依赖项中，在 npm 5 以后的版本不用加上这个参数也会自动加入到 <code>dependencies</code>​ 这个依赖项中。</p></li><li><p>更新包： <code>npm install 包名 @latest</code>​​​</p></li><li><p>卸载包： <code>npm uninstall 包名</code>​​​</p></li><li><p>换源：<code>npm --registry 源地址</code>​​​</p></li></ul><h2 id="pnpm" tabindex="-1"><a class="header-anchor" href="#pnpm"><span>pnpm</span></a></h2><h3 id="概述-1" tabindex="-1"><a class="header-anchor" href="#概述-1"><span>概述</span></a></h3>',8),q={href:"https://pnpm.io/zh/motivation",target:"_blank",rel:"noopener noreferrer"},z=(0,e.Lk)("ul",null,[(0,e.Lk)("li",null,"快速：pnpm is up to 2x faster than npm"),(0,e.Lk)("li",null,"高效：node_modules 中的文件为复制或链接自特定的内容寻址存储库"),(0,e.Lk)("li",null,"支持：monorepos：pnpm 内置支持单仓多包"),(0,e.Lk)("li",null,"严格：pnpm 默认创建了一个非平铺的 node_modules，因此代码无法访问任意包")],-1),B=(0,e.Lk)("h3",{id:"安装及使用-1",tabindex:"-1"},[(0,e.Lk)("a",{class:"header-anchor",href:"#安装及使用-1"},[(0,e.Lk)("span",null,"安装及使用")])],-1),A=(0,e.Lk)("p",null,[(0,e.Lk)("strong",null,"官方地址")],-1),D={href:"https://pnpm.io/",target:"_blank",rel:"noopener noreferrer"},C={href:"https://github.com/pnpm/pnpm",target:"_blank",rel:"noopener noreferrer"},Y=(0,e.Fv)('<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token number">1.</span> pnpm 是 pnpm 的普通版本，需要 Node<span class="token punctuation">.</span>js 来运行。\nnpm install <span class="token operator">-</span>g pnpm\n\n<span class="token number">2.</span> @pnpm<span class="token operator">/</span>exe 与 Node<span class="token punctuation">.</span>js 一起打包成可执行文件，因此可以在未安装 Node<span class="token punctuation">.</span>js 的系统上使用。\nnpm install <span class="token operator">-</span>g @pnpm<span class="token operator">/</span>exe\n\n<span class="token number">3.</span> 升级版本\npnpm add <span class="token operator">-</span>g pnpm\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​​</p><p><strong>常用命令</strong></p>',3),P={href:"https://pnpm.io/zh/cli/add",target:"_blank",rel:"noopener noreferrer"},J=(0,e.Fv)('<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token number">1.</span> 与 npm 不同，pnpm 验证所有选项。例如， pnpm install <span class="token operator">--</span>target_arch x64 将失败，因为 <span class="token operator">--</span>target_arch 不是 pnpm install 的有效选项。\n\nnpm install      <span class="token operator">==</span> pnpm install\nnpm i <span class="token operator">&lt;</span>pkg<span class="token operator">&gt;</span>      <span class="token operator">==</span> pnpm add <span class="token operator">&lt;</span>pkg<span class="token operator">&gt;</span>\nnpm run <span class="token operator">&lt;</span>cmd<span class="token operator">&gt;</span> <span class="token operator">==</span> pnpm <span class="token operator">&lt;</span>cmd<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到只下载了一次，但是项目上确实也存在 <code>node_modules\\gitbook-plugin-search-pro</code>​</p><p>​<img src="'+t+'" alt="image" loading="lazy">​</p><p>可能就是因为这个目录链接起来的，具体看官网介绍：</p><blockquote><p>使用 npm 时，依赖每次被不同的项目使用，都会重复安装一次。 而在使用 pnpm 时，依赖会被存储在内容可寻址的存储中，所以：</p><ol><li>如果你用到了某依赖项的不同版本，只会将不同版本间有差异的文件添加到仓库。 例如，如果某个包有 100 个文件，而它的新版本只改变了其中 1 个文件。那么 <code>pnpm update</code>​ 时只会向存储中心额外添加 1 个新文件，而不会因为仅仅一个文件的改变复制整新版本包的内容。</li><li>所有文件都会存储在硬盘上的某一位置。 当软件包被被安装时，包里的文件会硬链接到这一位置，而不会占用额外的磁盘空间。 这允许你跨项目地共享同一版本的依赖。</li></ol><p>因此，您在磁盘上节省了大量空间，这与项目和依赖项的数量成正比，并且安装速度要快得多！</p></blockquote><p>​<img src="'+r+'" alt="image" loading="lazy">​</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token constant">PS</span> <span class="token constant">D</span><span class="token operator">:</span>\\<span class="token punctuation">.</span>pnpm<span class="token operator">-</span>store<span class="token operator">&gt;</span> tree <span class="token operator">/</span>f\n卷 新加卷 的文件夹 <span class="token constant">PATH</span> 列表\n卷序列号为 5CC2<span class="token operator">-</span>54DE\n<span class="token constant">D</span><span class="token operator">:</span><span class="token punctuation">.</span>\n└─v3\n    └─files\n        ├─<span class="token number">04</span>\n        │      3e4a27e1d3903298fc32769e0f28b7283ce02a68afb89f9663e7e0625ad3c3c3b613e18eb256b1fdd078a345325f287ecbf0f5d1f979661984d2ae0ac5652b<span class="token operator">-</span>exec\n        │      5b086f61936e1bf0d918b81d321c1b2399f46d9bf3b50fef077214194f5de39b0dd188059b3ce45908febf9f068459626be2fd29ce55c83278e224b8af897d\n        │\n        ├─<span class="token number">05</span>\n        │      97a1fc9027497bec956281428ee644ea9a1e0b6b851ed7a276dc1daa685a1cd35661e64e820049a25308c5adaf2c66474151f891b5b6caf27dd8636781750c\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="yarn" tabindex="-1"><a class="header-anchor" href="#yarn"><span>yarn</span></a></h2><h3 id="概述-2" tabindex="-1"><a class="header-anchor" href="#概述-2"><span>概述</span></a></h3>',9),M={href:"https://engineering.fb.com/2016/10/11/web/yarn-a-new-package-manager-for-javascript/",target:"_blank",rel:"noopener noreferrer"},R=(0,e.Lk)("ul",null,[(0,e.Lk)("li",null,[(0,e.eW)("​"),(0,e.Lk)("code",null,"npm install"),(0,e.eW)("​ ​的时候"),(0,e.Lk)("strong",null,"巨慢"),(0,e.eW)("。特别是新的项目拉下来要等半天，删除 node_modules，重新 install 的时候依旧如此。")]),(0,e.Lk)("li",null,[(0,e.eW)("同一个项目，安装的时候"),(0,e.Lk)("strong",null,"无法保持一致性"),(0,e.eW)("。由于 package.json 文件中版本号的特点，下面三个版本号在安装的时候代表不同的含义。")])],-1),T=(0,e.Lk)("p",null,"Yarn 是一个成熟的开源包管理器，用于管理 JavaScript 项目中的依赖项。它有助于安装、更新、配置和删除软件包依赖项的过程，最终帮助您更快地实现目标，同时减少干扰。",-1),I={href:"https://yarnpkg.com/migration/overview#:~:text=Benefits-,Benefits,-%E5%A5%BD%E5%A4%84",target:"_blank",rel:"noopener noreferrer"},H=(0,e.Fv)('<ul><li>Stability</li><li>New features</li><li>Flexibility</li><li>Extensibility</li><li>Future proof</li></ul><p>您可能听说过 Yarn Plug&#39;n&#39;Play，并担心您的项目尚不兼容。不用担心！ 此迁移将允许您保留 <code>node_modules</code>​ 文件夹。只有当我们完成后，您才需要决定是否要花时间迁移到 Yarn PnP。无论您是这样做还是留在 <code>node_modules</code>​ 上，迁移到 Yarn Modern 都会有很多好处。</p><h3 id="安装及使用-2" tabindex="-1"><a class="header-anchor" href="#安装及使用-2"><span>安装及使用</span></a></h3><p><strong>就我个人而言，需求不是很大，用 yarn 应该就足够了。</strong></p><p>官方文档：</p>',5),O={href:"https://yarnpkg.com/getting-started",target:"_blank",rel:"noopener noreferrer"},G={href:"https://www.yarnpkg.cn/getting-started/install",target:"_blank",rel:"noopener noreferrer"},X=(0,e.Fv)('<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token number">1.</span> 首先启用 Corepack（如果尚未启用）；这会将 yarn 二进制文件添加到您的 <span class="token constant">PATH</span> 中：\ncorepack enable\n\n<span class="token number">2.</span> 然后初始化一个新项目：\nyarn init <span class="token operator">-</span><span class="token number">2</span>\n\n<span class="token number">3.</span> 任何时候你想将 Yarn 更新到最新版本，只需运行：\nyarn <span class="token keyword">set</span> version stable\nyarn install\n\n<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">==</span>\n<span class="token number">4.</span> 您可能想要测试 Yarn 的最新版本，该版本尚未在候选版本中发布，甚至尚未合并。以下命令将直接从我们的存储库克隆、构建并在您的项目中安装 Yarn：\nyarn <span class="token keyword">set</span> version from sources\n\n<span class="token number">5.</span> 它接受一个 <span class="token operator">--</span>branch 标志，您可以使用它来测试特定的 <span class="token constant">PR</span>：\nyarn <span class="token keyword">set</span> version from sources <span class="token operator">--</span>branch <span class="token number">1211</span>\n\n<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span> 使用 npm 安装\n# 全局安装\nnpm install <span class="token operator">-</span>g  yarn\n\n# 全局安装目录\nyarn config <span class="token keyword">set</span> global<span class="token operator">-</span>folder <span class="token constant">D</span><span class="token operator">:</span>\\Yarn\\yarn_global\n\n# 缓存目录\nyarn config <span class="token keyword">set</span> cache<span class="token operator">-</span>folder <span class="token constant">D</span><span class="token operator">:</span>\\Yarn\\yarn_cache\n\n# 查看当前源\nyarn config <span class="token keyword">get</span> registry\n\n# 修改为淘宝镜像源\nyarn config <span class="token keyword">set</span> registry https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>registry<span class="token punctuation">.</span>npm<span class="token punctuation">.</span>taobao<span class="token punctuation">.</span>org\n\n<span class="token comment">// 初始化一个项目</span>\nyarn init\n\n<span class="token comment">// 添加依赖包</span>\nyarn add <span class="token punctuation">[</span><span class="token keyword">package</span><span class="token punctuation">]</span>\n\n<span class="token comment">// 升级依赖包</span>\nyarn upgrade <span class="token punctuation">[</span><span class="token keyword">package</span><span class="token punctuation">]</span>\n\n<span class="token comment">// 移除依赖包</span>\nyarn remove <span class="token punctuation">[</span><span class="token keyword">package</span><span class="token punctuation">]</span>\n\n<span class="token comment">// 安装全部依赖</span>\nyarn install （或者 yarn）\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>常用指令</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>如果您来自 npm，主要变化是：\n<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>\n<span class="token number">1.</span> 运行 yarn 足以运行安装！它是 yarn install 的别名。\n<span class="token number">2.</span> 添加或更新对单个包的依赖项是通过 yarn add 完成的。\n<span class="token number">3.</span> 升级整个项目的依赖项是通过 yarn up 完成的。\n<span class="token number">4.</span> 您的脚本有别名。调用 yarn build 与 yarn run build 相同！\n<span class="token number">5.</span> 大多数与注册表相关的命令都移到 yarn npm 后面（例如： yarn npm audit \n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',3),U={href:"https://yarnpkg.com/cli",target:"_blank",rel:"noopener noreferrer"},V=(0,e.Fv)('<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token operator">&gt;</span> corepack enable\n<span class="token operator">&gt;</span> yarn init <span class="token operator">-</span><span class="token number">2</span>\nCorepack is about to download https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>registry<span class="token punctuation">.</span>yarnpkg<span class="token punctuation">.</span>com<span class="token operator">/</span>yarn<span class="token operator">/</span><span class="token operator">-</span><span class="token operator">/</span>yarn<span class="token operator">-</span><span class="token number">1.22</span><span class="token number">.22</span><span class="token punctuation">.</span>tgz<span class="token punctuation">.</span>\n\nDo you want to <span class="token keyword">continue</span><span class="token operator">?</span> <span class="token punctuation">[</span><span class="token constant">Y</span><span class="token operator">/</span>n<span class="token punctuation">]</span> y\nCorepack is about to download https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>repo<span class="token punctuation">.</span>yarnpkg<span class="token punctuation">.</span>com<span class="token operator">/</span><span class="token number">4.1</span><span class="token number">.1</span><span class="token operator">/</span>packages<span class="token operator">/</span>yarnpkg<span class="token operator">-</span>cli<span class="token operator">/</span>bin<span class="token operator">/</span>yarn<span class="token punctuation">.</span>js<span class="token punctuation">.</span>\n\nDo you want to <span class="token keyword">continue</span><span class="token operator">?</span> <span class="token punctuation">[</span><span class="token constant">Y</span><span class="token operator">/</span>n<span class="token punctuation">]</span> y\n➤ <span class="token constant">YN0000</span><span class="token operator">:</span> · Yarn <span class="token number">4.1</span><span class="token number">.1</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="package-json-packagelock-json" tabindex="-1"><a class="header-anchor" href="#package-json-packagelock-json"><span>package.json &amp; packagelock.json</span></a></h2><h3 id="package-json" tabindex="-1"><a class="header-anchor" href="#package-json"><span>package.json</span></a></h3><p>顾名思义 package.json 文件是包的描述文件，每个项目的根目录下面，一般都有一个 <code>package.json</code>​ 文件，定义了这个项目所需要的各种模块，以及项目的配置信息（比如名称、版本、许可证等元数据），以便发布到 npm registry。</p><p>​<code>npm install</code>​ 命令根据这个配置文件，自动下载所需的模块，也就是配置项目所需的运行和开发环境。</p><p>详情介绍参考：</p>',6),Q={href:"https://docs.npmjs.com/cli/v10/configuring-npm/package-json",target:"_blank",rel:"noopener noreferrer"},$={href:"https://javascript.ruanyifeng.com/nodejs/packagejson.html",title:"https://javascript.ruanyifeng.com/nodejs/packagejson.html",target:"_blank",rel:"noopener noreferrer"},Z=(0,e.Fv)('<p>​<img src="'+l+'" alt="image" loading="lazy">​</p><ul><li>有一个统一的 package 代码仓库 (npm 官网)</li><li>编写自己的 package 和 package.json 文件(参考 npm 官方文档介绍)</li><li>通过 npm publish 把 package 放到这个仓库里</li><li>其他人的项目里想要使用某些 package 就写到 package.json 文件中，然后运行 npm install，就会自动将这些代码下载下来，统一放到 node_modules 目录中。</li></ul><h3 id="packagelock-json" tabindex="-1"><a class="header-anchor" href="#packagelock-json"><span>packagelock.json</span></a></h3><p>对于 npm 修改 <code>node_modules</code>​ 树或 <code>package.json</code>​ 的任何操作，都会自动生成 <code>package-lock.json</code>​ 。它描述了生成的确切树，以便后续安装能够生成相同的树，而不管中间依赖项更新如何。</p>',4),K={href:"https://docs.npmjs.com/cli/v10/configuring-npm/package-lock-json",target:"_blank",rel:"noopener noreferrer"},nn=(0,e.Fv)('<ol><li>npm 安装，没有 package-lock.json 文件，如果 npm 版本是 5+，会自动生成 package-lock.json。有**<mark>的话会默认依据该文件进行安装而不是 package.json。</mark>** cnpm 不支持（忽略）依据 package-lock.json 文件安装模块，默认依赖 package.json 进行安装。</li><li><strong><mark>需要更新版本，得去更新 package.json 里的模块版本，然后 npm install，才能同步更新到 package-lock.json</mark></strong></li><li>该功能基于 npm5+</li></ol><h3 id="版本范围符号-​-​-说明" tabindex="-1"><a class="header-anchor" href="#版本范围符号-​-​-说明"><span>版本范围符号 <code>^</code>​ <code>~</code>​ 说明</span></a></h3><p>​<code>^</code>​ 表示：允许进行不修改 <code>[major, minor, patch]</code>​ 元组中**<mark>最左边的非零元素</mark>**的更改。换句话说，这允许版本 <code>1.0.0</code>​ 及以上版本的补丁和次要更新，版本 <code>0.X &gt;=0.1.0</code>​ 的补丁更新，以及版本 <code>0.0.X</code>​ 的无更新。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token operator">^</span><span class="token number">1.2</span><span class="token number">.3</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">1.2</span><span class="token number">.3</span> <span class="token operator">&lt;</span><span class="token number">2.0</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span>\n<span class="token operator">^</span><span class="token number">0.2</span><span class="token number">.3</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.2</span><span class="token number">.3</span> <span class="token operator">&lt;</span><span class="token number">0.3</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span>\n<span class="token operator">^</span><span class="token number">0.0</span><span class="token number">.3</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.0</span><span class="token number">.3</span> <span class="token operator">&lt;</span><span class="token number">0.0</span><span class="token number">.4</span><span class="token operator">-</span><span class="token number">0</span>\n\n<span class="token operator">^</span><span class="token number">1.2</span><span class="token number">.3</span><span class="token operator">-</span>beta<span class="token punctuation">.</span><span class="token number">2</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">1.2</span><span class="token number">.3</span><span class="token operator">-</span>beta<span class="token punctuation">.</span><span class="token number">2</span> <span class="token operator">&lt;</span><span class="token number">2.0</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span> 请注意，如果 <span class="token number">1.2</span><span class="token number">.3</span> 版本大于或等于 beta<span class="token punctuation">.</span><span class="token number">2</span> ，则允许预发布。因此， <span class="token number">1.2</span><span class="token number">.3</span><span class="token operator">-</span>beta<span class="token punctuation">.</span><span class="token number">4</span> 将被允许，但 <span class="token number">1.2</span><span class="token number">.4</span><span class="token operator">-</span>beta<span class="token punctuation">.</span><span class="token number">2</span> 不会，因为它是不同 <span class="token punctuation">[</span>major<span class="token punctuation">,</span> minor<span class="token punctuation">,</span> patch<span class="token punctuation">]</span> 元组的预发布。\n\n<span class="token operator">^</span><span class="token number">0.0</span><span class="token number">.3</span><span class="token operator">-</span>beta <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.0</span><span class="token number">.3</span><span class="token operator">-</span>beta <span class="token operator">&lt;</span><span class="token number">0.0</span><span class="token number">.4</span><span class="token operator">-</span><span class="token number">0</span> 请注意，仅当 <span class="token number">0.0</span><span class="token number">.3</span> 版本大于或等于 beta 时才允许预发布。因此， <span class="token number">0.0</span><span class="token number">.3</span><span class="token operator">-</span>pr<span class="token punctuation">.</span><span class="token number">2</span> 是被允许的。\n\n<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">==</span>\n解析插入符范围时，缺少的 patch 值会脱糖为数字 <span class="token number">0</span> ，但将允许该值内的灵活性，即使主要版本和次要版本都是 <span class="token number">0</span> \n<span class="token operator">^</span><span class="token number">1.2</span><span class="token punctuation">.</span>x <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">1.2</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">2.0</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span>\n<span class="token operator">^</span><span class="token number">0.0</span><span class="token punctuation">.</span>x <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.0</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">0.1</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span>\n<span class="token operator">^</span><span class="token number">0.0</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.0</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">0.1</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span>\n\n缺少的 minor 和 patch 值将脱糖为零，但也允许这些值的灵活性，即使主要版本为零。\n<span class="token operator">^</span><span class="token number">1</span><span class="token punctuation">.</span>x <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">1.0</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">2.0</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span>\n<span class="token operator">^</span><span class="token number">0</span><span class="token punctuation">.</span>x <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.0</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">1.0</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>&quot;<code>5.0.3</code>​&quot; 表示安装指定的 5.0.3 版本</li><li>&quot;<code>~5.0.3</code>​&quot; 表示安装 5.0.X 中最新的版本</li><li>&quot;<code>^5.0.3</code>​&quot; 表示安装 5.X.X 中最新的版本。</li></ul><hr><p>​<code>~</code>​ 表示：如果在比较器上指定了次要版本，则允许补丁级别更改。如果不允许，则允许进行较小级别的更改。<strong>就是说以第二位的小版本号为主，没有的话才以第一位的版本号为主。</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token operator">~</span><span class="token number">1.2</span><span class="token number">.3</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">1.2</span><span class="token number">.3</span> <span class="token operator">&lt;</span><span class="token number">1.</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token number">.0</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">1.2</span><span class="token number">.3</span> <span class="token operator">&lt;</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span>\n<span class="token operator">~</span><span class="token number">1.2</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">1.2</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">1.</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token number">.0</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">1.2</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span> <span class="token punctuation">(</span>Same <span class="token keyword">as</span> <span class="token number">1.2</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>\n<span class="token operator">~</span><span class="token number">1</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">1.0</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token number">.0</span><span class="token number">.0</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">1.0</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">2.0</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span> <span class="token punctuation">(</span>Same <span class="token keyword">as</span> <span class="token number">1</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>\n<span class="token operator">~</span><span class="token number">0.2</span><span class="token number">.3</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.2</span><span class="token number">.3</span> <span class="token operator">&lt;</span><span class="token number">0.</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token number">.0</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.2</span><span class="token number">.3</span> <span class="token operator">&lt;</span><span class="token number">0.3</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span>\n<span class="token operator">~</span><span class="token number">0.2</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.2</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">0.</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token number">.0</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.2</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">0.3</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span> <span class="token punctuation">(</span>Same <span class="token keyword">as</span> <span class="token number">0.2</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>\n<span class="token operator">~</span><span class="token number">0</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.0</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token number">.0</span><span class="token number">.0</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">0.0</span><span class="token number">.0</span> <span class="token operator">&lt;</span><span class="token number">1.0</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span> <span class="token punctuation">(</span>Same <span class="token keyword">as</span> <span class="token number">0</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>\n\n<span class="token operator">~</span><span class="token number">1.2</span><span class="token number">.3</span><span class="token operator">-</span>beta<span class="token punctuation">.</span><span class="token number">2</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token operator">&gt;=</span><span class="token number">1.2</span><span class="token number">.3</span><span class="token operator">-</span>beta<span class="token punctuation">.</span><span class="token number">2</span> <span class="token operator">&lt;</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">0</span> 请注意，如果 <span class="token number">1.2</span><span class="token number">.3</span> 版本大于或等于 beta<span class="token punctuation">.</span><span class="token number">2</span> ，则允许预发布。因此， <span class="token number">1.2</span><span class="token number">.3</span><span class="token operator">-</span>beta<span class="token punctuation">.</span><span class="token number">4</span> 将被允许，但 <span class="token number">1.2</span><span class="token number">.4</span><span class="token operator">-</span>beta<span class="token punctuation">.</span><span class="token number">2</span> 不会，因为它是不同 <span class="token punctuation">[</span>major<span class="token punctuation">,</span> minor<span class="token punctuation">,</span> patch<span class="token punctuation">]</span> 元组的预发布。\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>‍</p><p>详见官方说明：</p>',10),sn={href:"https://docs.npmjs.com/cli/v10/configuring-npm/package-json#dependencies:~:text=%E7%9A%84%E2%80%9Cstart%E2%80%9D%E5%91%BD%E4%BB%A4%E3%80%82-,dependencies%C2%A0%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB,-Dependencies%20are%20specified",target:"_blank",rel:"noopener noreferrer"},an={href:"https://github.com/npm/node-semver#versions",target:"_blank",rel:"noopener noreferrer"},en={href:"https://semver.org/lang/zh-CN/",target:"_blank",rel:"noopener noreferrer"},pn=(0,e.Lk)("h2",{id:"现在-corepack",tabindex:"-1"},[(0,e.Lk)("a",{class:"header-anchor",href:"#现在-corepack"},[(0,e.Lk)("span",null,"现在 corepack")])],-1),on=(0,e.Lk)("h3",{id:"概述-3",tabindex:"-1"},[(0,e.Lk)("a",{class:"header-anchor",href:"#概述-3"},[(0,e.Lk)("span",null,"概述")])],-1),tn={href:"https://nodejs.cn/api/corepack.htm",target:"_blank",rel:"noopener noreferrer"},rn=(0,e.Fv)('<p><s>正如 IE 的唯一作用是安装 Chrome，npm 的作用也是用来安装 yarn/pnpm</s></p><p>Corepack 是 Node.js 推出的包管理器的管理器。类似于 nvm 可以一行命令安装、切换 Node.js 的版本，Corepack 可以一行命令安装、切换 npm / yarn / pnpm 的版本。</p><p><strong>除此之外，Corepack 还有一个特性，能够读取项目的</strong> **<code>packge.json</code>**​ <strong>中的</strong> **<code>pacakgeManager</code>**​ <strong>字段，从而自动切换到对应版本的包管理器</strong>。这在多人、多项目协作开发中非常有用，比如 <code>pnpm@7.0.0</code>​ 和 <code>pnpm@8</code>​ 不兼容彼此的 <code>pnpm-lock.yaml</code>​，如果 pnpm 版本不统一，很容易出问题。</p><h3 id="安装及使用-3" tabindex="-1"><a class="header-anchor" href="#安装及使用-3"><span>安装及使用</span></a></h3><p>开启即可，和 npm 一样 nodejs 默认自带。</p><p>corepack 目前内置支持的就上面这三个包管理器。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>// 开启，会创建所有支持的包管理器的软链<span class="token punctuation">(</span>这是一个代理命令<span class="token punctuation">)</span>。\n// 默认是不会创建 <span class="token function">npm</span> 的，是因为随 <span class="token function">node</span> 会自带一个全局的 <span class="token function">npm</span>\ncorepack <span class="token builtin class-name">enable</span>\ncorepack <span class="token builtin class-name">enable</span> <span class="token function">npm</span> <span class="token comment"># npm 需要单独开启，不建议开启</span>\n\n\n// 禁用，会移除所有由 corepack 管理的包管理器的代理命令软链\ncorepack disable\ncorepack disable <span class="token function">npm</span> <span class="token comment"># 如果开启了，关闭也无法还原初始状态，而是删除了corepack 里面的链接</span>\n\n// 下载和缓存 all 支持的包管理器最新版<span class="token punctuation">(</span>全局环境<span class="token punctuation">)</span>\ncorepack prepare <span class="token parameter variable">--all</span>\n\n<span class="token comment"># 这会将全局默认 pnpm 更新到最新版</span>\ncorepack prepare pnpm@latest <span class="token parameter variable">--activate</span> <span class="token comment"># 旧版 Node.js 不支持 pnpm@latest，需要具体到 pnpm@x.y.z</span>\n\n<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>\n<span class="token string">&quot;packageManager&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;pnpm@9.0.0-beta.2+sha256.013b34133be0fd7f97d8739bd1a64a2b2c4b15af936ef77a14f5db26efb6bef4&quot;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>建议不要开启 <code>corepack enable npm</code>​​。原因有下面<strong>问题 1</strong>，还有一个问题就是如果你使用 nvm 或者一些进入目录，可能你设置了一些默认执行 npm 命令的一些脚本，例如 nvm 自动切换等等，一旦你配置的包管理器是 <code>pnpm</code>​​ 或者 <code>yarn</code>​​，那么 npm 肯定会执行报错，可能还有其它各种各样的奇怪问题。</p><p><strong>项目中的使用</strong></p><p>如果当前 pwd 是一个项目的根目录，corepack 会根据 package.json 中的 <code>packageManager</code>​ 配置，当你使用相应包管理器时，它下载使用配置的版本，如果使用的包管理器不是配置的包管理器，会给出报错提醒，如下图。</p><p>​<img src="'+c+'" alt="image" loading="lazy">​</p><hr><p><strong>无网时的使用</strong></p><p>对于一些私有部署或者网络限制环境，可以将 cache 导出到 tgz 文件，在使用的环境中导入，如下。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>// 导出\n$ corepack prepare <span class="token parameter variable">--all</span> <span class="token parameter variable">-o</span> corepack.tgz\n\n// 导入\n$ corepack hydrate corepack.tgz\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装完成后，使用 <code>cat</code>​ 可以确认，<code>pnpm &lt;args&gt;</code>​ 现在运行的是 <code>corepack pnpm &lt;args&gt;</code>​。​​</p>',16),ln={href:"https://nodejs.cn/api/corepack.html",target:"_blank",rel:"noopener noreferrer"},cn={href:"https://github.com/nodejs/corepack",target:"_blank",rel:"noopener noreferrer"},kn=(0,e.Fv)('<p>corepack 现在是随 node 每个发布的版本一起安装的，就如同 npm 一样，现在安装完 node 之后，你会发现有两个已经全局默认安装的包。</p><p>​<img src="'+i+'" alt="image" loading="lazy">​</p><p>‍</p><p>​<img src="'+k+'" alt="image" loading="lazy">​</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 在对应目录下开启后可以直接使用</span>\n<span class="token operator">&gt;</span> corepack enable\n<span class="token operator">&gt;</span> pnpm <span class="token operator">-</span>v\n<span class="token number">8.15</span><span class="token number">.6</span>\n<span class="token operator">&gt;</span> yarn <span class="token operator">-</span>v\n<span class="token number">1.22</span><span class="token number">.22</span>\n\n<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>\n<span class="token operator">&gt;</span> corepack use pnpm\nInstalling pnpm@<span class="token number">9.0</span><span class="token number">.0</span><span class="token operator">-</span>beta<span class="token punctuation">.</span><span class="token number">2</span> <span class="token keyword">in</span> the project<span class="token operator">...</span>\nAlready up to date\n\n<span class="token operator">&gt;</span> corepack pnpm <span class="token operator">-</span>v\n<span class="token number">9.0</span><span class="token number">.0</span><span class="token operator">-</span>beta<span class="token punctuation">.</span><span class="token number">2</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="问题-1" tabindex="-1"><a class="header-anchor" href="#问题-1"><span>问题 1</span></a></h3><p><strong>问题：</strong> 开启 <code>corepack enable npm</code>​ 后，使用 npm 时，出现 Segmentation fault</p>',7),un=(0,e.Lk)("strong",null,"原因简述：",-1),dn=(0,e.Lk)("code",null,"corepack@<=0.18.0",-1),mn=(0,e.Lk)("code",null,"npm@>9.7.0",-1),bn=(0,e.Lk)("code",null,"Segmentation fault",-1),vn={href:"https://github.com/nodejs/corepack/pull/276",target:"_blank",rel:"noopener noreferrer"},gn=(0,e.Lk)("code",null,"v8-compile-cache",-1),hn=(0,e.Lk)("code",null,"npm@&gt;=9.7.0",-1),fn=(0,e.Lk)("p",null,[(0,e.Lk)("strong",null,"解决办法：")],-1),jn=(0,e.Lk)("p",null,[(0,e.eW)("执行 "),(0,e.Lk)("code",null,"npm install -g corepack"),(0,e.eW)(" ​升级 corepack 即可，截止 2024 年 2 月，最新版是 "),(0,e.Lk)("code",null,"corepack@0.25.2"),(0,e.eW)("​，支持 "),(0,e.Lk)("code",null,"Node v18.17.1 || >=20.10.0"),(0,e.eW)("​。")],-1),yn=(0,e.Lk)("h1",{id:"前人栽树",tabindex:"-1"},[(0,e.Lk)("a",{class:"header-anchor",href:"#前人栽树"},[(0,e.Lk)("span",null,"前人栽树")])],-1),Ln={href:"https://zhuanlan.zhihu.com/p/24357770",target:"_blank",rel:"noopener noreferrer"},Wn={},wn=(0,a(7708).A)(Wn,[["render",function(n,s){const a=(0,e.g2)("ExternalLinkIcon");return(0,e.uX)(),(0,e.CE)("div",null,[u,d,(0,e.Lk)("p",null,[(0,e.Lk)("a",m,[(0,e.eW)("Node.js"),(0,e.bF)(a)]),(0,e.eW)("® is a free, open-source, cross-platform JavaScript runtime environment that lets developers create servers, web apps, command line tools and scripts.")]),(0,e.Lk)("p",null,[(0,e.eW)("Node.js 是由 "),(0,e.Lk)("a",b,[(0,e.eW)("Ryan Dahl"),(0,e.bF)(a)]),(0,e.eW)(" 用 C++ 开发的，Node.js 不是库，是一个运行环境，或者说是一个 JS 语言解释器。")]),v,(0,e.Lk)("p",null,[(0,e.Lk)("a",g,[(0,e.eW)("用法"),(0,e.bF)(a)]),(0,e.eW)("：")]),h,(0,e.Lk)("ul",null,[(0,e.Lk)("li",null,[(0,e.eW)("当前版本："),(0,e.Lk)("a",f,[(0,e.eW)("Node.js — Download Node.js® (nodejs.org)"),(0,e.bF)(a)])]),(0,e.Lk)("li",null,[(0,e.eW)("历史版本："),(0,e.Lk)("a",j,[(0,e.eW)("Node.js — Previous Releases (nodejs.org)"),(0,e.bF)(a)])])]),y,(0,e.Lk)("ul",null,[(0,e.Lk)("li",null,[(0,e.Lk)("p",null,[(0,e.eW)("Linux："),(0,e.Lk)("a",L,[(0,e.eW)("GitHub - nvm-sh/nvm: Node Version Manager - POSIX-compliant bash script to manage multiple active node.js versions"),(0,e.bF)(a)])])]),(0,e.Lk)("li",null,[(0,e.Lk)("p",null,[(0,e.eW)("Windows："),(0,e.Lk)("a",W,[(0,e.eW)("GitHub - coreybutler/nvm-windows: A node.js version management utility for Windows. Ironically written in Go."),(0,e.bF)(a)])]),(0,e.Lk)("p",null,[(0,e.Lk)("a",w,[(0,e.eW)("要升级 nvm-windows"),(0,e.bF)(a)]),(0,e.eW)("，请运行新的安装程序。它将安全地覆盖需要更新的文件，而无需接触您的 node.js 安装。请确保使用相同的安装和符号链接文件夹。如果您最初安装到默认位置，则只需单击每个窗口上的“下一步”，直到完成。")])])]),x,(0,e.Lk)("p",null,[(0,e.eW)("于是由一个拥有三大美德的程序员 "),(0,e.Lk)("a",F,[(0,e.eW)("Isaac Z. Schlueter"),(0,e.bF)(a)]),(0,e.eW)(" （以下简称 Isaaz）给出一个解决方案：用一个工具把这些代码集中到一起来管理吧！那就是 npm，全称是 "),E,(0,e.eW)("，是以 JavaScript 编写的软件包管理工具，用来安装 node 项目所需要的一堆依赖包。")]),(0,e.Lk)("ul",null,[(0,e.Lk)("li",null,[(0,e.eW)("npm 官网地址："),(0,e.Lk)("a",_,[(0,e.eW)("npm | Home (npmjs.com)"),(0,e.bF)(a)])]),(0,e.Lk)("li",null,[(0,e.eW)("npm 官方文档："),(0,e.Lk)("a",N,[(0,e.eW)("npm Docs (npmjs.com)"),(0,e.bF)(a)])])]),S,(0,e.Lk)("p",null,[(0,e.eW)("快速的，"),(0,e.Lk)("a",q,[(0,e.eW)("节省磁盘空间"),(0,e.bF)(a)]),(0,e.eW)("的包管理工具。")]),z,B,A,(0,e.Lk)("ul",null,[(0,e.Lk)("li",null,[(0,e.Lk)("a",D,[(0,e.eW)("Fast, disk space efficient package manager | pnpm"),(0,e.bF)(a)])]),(0,e.Lk)("li",null,[(0,e.Lk)("a",C,[(0,e.eW)("GitHub - pnpm/pnpm: Fast, disk space efficient package manager"),(0,e.bF)(a)])])]),Y,(0,e.Lk)("p",null,[(0,e.Lk)("a",P,[(0,e.eW)("pnpm add <pkg> | pnpm"),(0,e.bF)(a)])]),J,(0,e.Lk)("p",null,[(0,e.eW)("“Yarn 是由 Facebook、Google、Exponent 和 Tilde 联合推出了一个新的 JS 包管理工具 ，正如"),(0,e.Lk)("a",M,[(0,e.eW)("早期官方文档"),(0,e.bF)(a)]),(0,e.eW)("中写的，Yarn 是为了弥补 npm 的一些缺陷而出现的。”这句话让我想起了使用 npm 时的坑了：")]),R,T,(0,e.Lk)("p",null,[(0,e.eW)("Migrating from 1.x / npm 有什么"),(0,e.Lk)("a",I,[(0,e.eW)("好处"),(0,e.bF)(a)]),(0,e.eW)("？Yarn Modern 有以下优点")]),H,(0,e.Lk)("ul",null,[(0,e.Lk)("li",null,[(0,e.Lk)("a",O,[(0,e.eW)("Introduction | Yarn (yarnpkg.com)"),(0,e.bF)(a)])]),(0,e.Lk)("li",null,[(0,e.Lk)("a",G,[(0,e.eW)("安装 | Yarn - JavaScript 软件包管理器 | Yarn 中文文档 - Yarn 中文网 (yarnpkg.cn)"),(0,e.bF)(a)])])]),X,(0,e.Lk)("p",null,[(0,e.eW)("所有指令请参考官网："),(0,e.Lk)("a",U,[(0,e.eW)("CLI Reference | Yarn (yarnpkg.com)"),(0,e.bF)(a)])]),V,(0,e.Lk)("ul",null,[(0,e.Lk)("li",null,[(0,e.Lk)("a",Q,[(0,e.eW)("package.json | npm Docs (npmjs.com)"),(0,e.bF)(a)])]),(0,e.Lk)("li",null,[(0,e.Lk)("a",$,[(0,e.eW)("https://javascript.ruanyifeng.com/nodejs/packagejson.html"),(0,e.bF)(a)])])]),Z,(0,e.Lk)("ul",null,[(0,e.Lk)("li",null,[(0,e.Lk)("a",K,[(0,e.eW)("package-lock.json | npm Docs (npmjs.com)"),(0,e.bF)(a)])])]),nn,(0,e.Lk)("ul",null,[(0,e.Lk)("li",null,[(0,e.Lk)("a",sn,[(0,e.eW)("https://docs.npmjs.com/cli/v10/configuring-npm/package-json#dependencies"),(0,e.bF)(a)])]),(0,e.Lk)("li",null,[(0,e.Lk)("a",an,[(0,e.eW)("GitHub - npm/node-semver: The semver parser for node (the one npm uses)"),(0,e.bF)(a)])]),(0,e.Lk)("li",null,[(0,e.Lk)("a",en,[(0,e.eW)("语义化版本 2.0.0 | Semantic Versioning (semver.org)"),(0,e.bF)(a)])])]),pn,on,(0,e.Lk)("p",null,[(0,e.Lk)("a",tn,[(0,e.eW)("Corepack"),(0,e.bF)(a)]),(0,e.eW)(" 从 Node.js 16.9 开始可用, 全新的包管理器的管理器，无需安装 npm、yarn、pnpm，只需要一个 Corepack 即可搞定所有。")]),rn,(0,e.Lk)("p",null,[(0,e.eW)("按照"),(0,e.Lk)("a",ln,[(0,e.eW)("官方文档"),(0,e.bF)(a)]),(0,e.eW)("的说法是不需要再自行安装的，可以参考项目的 "),(0,e.Lk)("a",cn,[(0,e.eW)("Readme"),(0,e.bF)(a)]),(0,e.eW)("。")]),kn,(0,e.Lk)("p",null,[un,(0,e.eW)(" 因为 corepack 版本是随着 node 版本发布的。一旦在 "),dn,(0,e.eW)("​，而 "),mn,(0,e.eW)("​ 时，如果开启 npm 管理，就会报 "),bn,(0,e.eW)("​，好像存在不兼容。"),(0,e.Lk)("a",vn,[(0,e.eW)("fix: disable "),gn,(0,e.eW)(" when using "),hn,(0,e.eW)(" by merceyz · Pull Request #276 · nodejs/corepack · GitHub"),(0,e.bF)(a)])]),fn,jn,yn,(0,e.Lk)("ul",null,[(0,e.Lk)("li",null,[(0,e.Lk)("a",Ln,[(0,e.eW)("npm 是干什么的？（非教程） - 知乎 (zhihu.com)"),(0,e.bF)(a)])])])])}]]),xn=JSON.parse('{"path":"/websec/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/nodejs%20%E4%B8%8E%20nvm%E3%80%81npm%E3%80%81pnmp%E3%80%81yarn%E3%80%81corepack%20%E7%9A%84%E5%85%B3%E7%B3%BB.html","title":"nodejs 与 nvm、npm、pnmp、yarn、corepack 的关系","lang":"zh-CN","frontmatter":{"title":"nodejs 与 nvm、npm、pnmp、yarn、corepack 的关系","description":"Nodejs Run JavaScript Everywhere Node.js® is a free, open-source, cross-platform JavaScript runtime environment that lets developers create servers, web apps, command line tools...","head":[["meta",{"property":"og:url","content":"https://github.com/zha0cai/SecWikiPublic/secwiki/websec/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/nodejs%20%E4%B8%8E%20nvm%E3%80%81npm%E3%80%81pnmp%E3%80%81yarn%E3%80%81corepack%20%E7%9A%84%E5%85%B3%E7%B3%BB.html"}],["meta",{"property":"og:site_name","content":"One-Piece"}],["meta",{"property":"og:title","content":"nodejs 与 nvm、npm、pnmp、yarn、corepack 的关系"}],["meta",{"property":"og:description","content":"Nodejs Run JavaScript Everywhere Node.js® is a free, open-source, cross-platform JavaScript runtime environment that lets developers create servers, web apps, command line tools..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"Mr.zha0cai"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"nodejs 与 nvm、npm、pnmp、yarn、corepack 的关系\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.zha0cai\\",\\"url\\":\\"https://github.com/zha0cai\\"}]}"]]},"headers":[{"level":2,"title":"npm","slug":"npm","link":"#npm","children":[{"level":3,"title":"概述","slug":"概述","link":"#概述","children":[]},{"level":3,"title":"安装及使用","slug":"安装及使用","link":"#安装及使用","children":[]}]},{"level":2,"title":"pnpm","slug":"pnpm","link":"#pnpm","children":[{"level":3,"title":"概述","slug":"概述-1","link":"#概述-1","children":[]},{"level":3,"title":"安装及使用","slug":"安装及使用-1","link":"#安装及使用-1","children":[]}]},{"level":2,"title":"yarn","slug":"yarn","link":"#yarn","children":[{"level":3,"title":"概述","slug":"概述-2","link":"#概述-2","children":[]},{"level":3,"title":"安装及使用","slug":"安装及使用-2","link":"#安装及使用-2","children":[]}]},{"level":2,"title":"package.json & packagelock.json","slug":"package-json-packagelock-json","link":"#package-json-packagelock-json","children":[{"level":3,"title":"package.json","slug":"package-json","link":"#package-json","children":[]},{"level":3,"title":"packagelock.json","slug":"packagelock-json","link":"#packagelock-json","children":[]},{"level":3,"title":"版本范围符号 ^​ ~​ 说明","slug":"版本范围符号-​-​-说明","link":"#版本范围符号-​-​-说明","children":[]}]},{"level":2,"title":"现在 corepack","slug":"现在-corepack","link":"#现在-corepack","children":[{"level":3,"title":"概述","slug":"概述-3","link":"#概述-3","children":[]},{"level":3,"title":"安装及使用","slug":"安装及使用-3","link":"#安装及使用-3","children":[]},{"level":3,"title":"问题 1","slug":"问题-1","link":"#问题-1","children":[]}]}],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"readingTime":{"minutes":14.87,"words":4461},"filePathRelative":"websec/基础知识/nodejs 与 nvm、npm、pnmp、yarn、corepack 的关系.md","autoDesc":true}')}}]);